const __vite__mapDeps = (i, m = __vite__mapDeps, d = (m.f || (m.f = ["assets/gah62ec9m9lupxpw.js", "assets/mna1wiucqak6lqzp.js", "assets/mvhqd4tvzpjcyc7r.js", "assets/bq4rrqi54riy5k2e.js", "assets/root-ey6kd8gf.css", "assets/mi93vnc3bxzyhv3q.js", "assets/lwme42j7zzyr3q7j.js", "assets/conversation-small-fu0y35oi.css", "assets/g77ymanjjcustcw3.js", "assets/cxz91putlw7pmfk2.js", "assets/m0wlwtibo8yb2c2h.js", "assets/ld626s1jynzsi9nc.js", "assets/niyc1j17i1iogjjg.js", "assets/hx3p6g5v1c632c0c.js", "assets/k2zciqacu7tc7hir.js", "assets/gitqh1f0vlrsxlc2.js", "assets/ova7df072amsyyll.js", "assets/mrrykfxpv83z9tmn.js", "assets/fj96fkvbq9l88uwl.js", "assets/dryl4ixhgg2bg6zd.js", "assets/ivmslo5piqpot98f.js", "assets/nc7lfqrltu2fqkst.js", "assets/gijyfy18h2lvcn0n.js", "assets/dvik6hl2h3xpsl43.js", "assets/l61rsa4astkd2zs8.js", "assets/uhoky0cwglarnjft.js", "assets/percfv3j35b57wm6.js", "assets/h3xng9crsp8lzsel.js", "assets/b9l0ct583oiwof9y.js", "assets/laes23nj33z0vwdj.js", "assets/abecm95t02z1dqg1.js", "assets/mvhvkychyhy1jnl2.js", "assets/iun2eu97yrdasp4e.js", "assets/oqh7hur52tf42g0a.js", "assets/mli829qx6uv82l3j.js", "assets/lxpq2f4j4u4zyc7l.js", "assets/b9s7mtd15ebayzjc.js", "assets/n4gvsdnw0wjo4fci.js", "assets/ihors7v1ehg5i95p.js", "assets/br9dq8jlta8ssu5o.js", "assets/e5xsqxswwdimah8k.js", "assets/m44xlxtgozicne9l.js", "assets/ff3dg9pqimxn5e3g.js", "assets/y5lresaa5sfjy805.js", "assets/m3b3wk7x0ejaq5a6.js", "assets/le5q4ddz602abhpv.js", "assets/nfk9kd0ic4ezhu1o.js", "assets/behlzkw3bidp9shs.js", "assets/FormattedText-dqwoo8t7.css", "assets/cot-message-g9y1y05k.css", "assets/f5ao0e2ci4o09nur.js", "assets/bv651m6o5w8299nr.js", "assets/ogh3qmylz7hb5p18.js", "assets/ogxdbwcg9nriprtc.js", "assets/br2bcbrev1rtjwjr.js"]))) => i.map(i => d[i]);
import {
    cq as Pe,
    a0 as z,
    B as X,
    dk as Fe,
    fd as Ve,
    a2 as He,
    T as _e,
    gA as Ue,
    z as Ee,
    a as te,
    l as ye,
    aH as Me,
    ci as Be,
    d as I,
    bL as W,
    Q as ze,
    fz as We,
    w as ve,
    $ as Je,
    b_ as Z,
    e8 as Ke,
    ab as $,
    P as qe,
    cv as Ye,
    bs as Te,
    gB as ae,
    eh as Qe,
    ei as Xe,
    bW as $e,
    e2 as Ge,
    ee as Ze,
    e1 as es,
    a6 as Ce,
    D as ss,
    gm as ts,
    bz as j,
    bA as N,
    e6 as as,
    bw as ns,
    aa as os
} from "./bq4rrqi54riy5k2e.js";
import {
    j as s,
    M as A,
    a as Se,
    c as G,
    r as p,
    ax as B,
    av as L
} from "./mna1wiucqak6lqzp.js";
import {
    l3 as is,
    ij as rs,
    l4 as ls,
    dz as be,
    l5 as cs,
    l6 as ds,
    i9 as ms,
    ia as us,
    i3 as gs,
    l7 as fs,
    ds as xs,
    l8 as ps,
    l9 as hs,
    la as _s,
    lb as Es,
    lc as ys,
    ld as Ms,
    im as vs,
    ic as E,
    i6 as oe,
    ib as U,
    le as re,
    lf as Q,
    h$ as le,
    lg as Ts,
    lh as Cs,
    li as Ss,
    lj as je,
    lk as bs,
    ll as P,
    lm as js,
    gy as Ae,
    ln as As,
    lo as Ns,
    M as Ne,
    dv as Is,
    dw as ks,
    bN as ee,
    lp as ws,
    lq as Rs,
    lr as ne,
    ls as Ds,
    lt as Ls,
    lu as Os,
    lv as ce,
    lw as Ps,
    lx as Fs,
    ly as Vs,
    hz as de,
    kv as Ie,
    hU as Hs,
    lz as Us,
    lA as Bs,
    lB as zs,
    lC as Ws,
    ap as Js,
    ao as Ks,
    al as qs,
    bC as Ys,
    eh as Qs,
    jp as Xs,
    lD as $s,
    lE as Gs,
    cn as u,
    hA as Zs,
    it as et,
    kM as st,
    lF as tt,
    lG as at,
    hw as nt,
    lH as ot,
    jB as it,
    hx as rt,
    jC as lt,
    lI as ct,
    lJ as dt,
    lK as mt,
    ft as ut
} from "./lwme42j7zzyr3q7j.js";
import {
    u as gt,
    a as ft
} from "./g77ymanjjcustcw3.js";
import {
    b as ke,
    a as xt
} from "./cxz91putlw7pmfk2.js";
import {
    u as pt
} from "./m0wlwtibo8yb2c2h.js";
import {
    N as ht
} from "./ld626s1jynzsi9nc.js";
import {
    f as _t
} from "./niyc1j17i1iogjjg.js";
const Et = e => {
        for (const a of e.concat().reverse()) {
            if ("messages" in a) return a.messages[a.messages.length - 1].nodeId;
            if ("message" in a) return a.message.nodeId
        }
    },
    yt = (e, a) => {
        const [t, o] = z(e, f => [X.getRequestId(f), X.getLastMessageSystemHints(f).includes(Fe.CANVAS)]), i = gt({
            clientThreadId: e
        }), r = is(e), l = Se(), d = Ve(), n = He(t), g = Et(a), c = a.some(f => "messages" in f && f.messages.some(_ => _.message.metadata ? .canvas ? .canvas_opt_in));
        return {
            isVisible: !o && !r && !c && !!g,
            onClick: async f => {
                if (!g) return;
                f.stopPropagation(), rs();
                const _ = [_e.CANMORE];
                n && await ls({
                    clientThreadId: e,
                    currentRequestId: t,
                    queryClient: l,
                    isHistoryAndTrainingDisabled: d
                }), requestAnimationFrame(() => i({
                    sourceEvent: f,
                    nodeId: g,
                    appendMessages: [Ue("The user has requested the canvas tool be disabled for this conversation. You should not call the tool again.", {
                        disable_tool_ids: _,
                        exclude_after_next_user_message: !0
                    })]
                }));
                const y = X.getTree(Ee(e)),
                    v = y.getConversationTurns(g, !1).length,
                    S = y.getParentPromptNode(g).message.id;
                be.logEventWithStatsig(te.canvasOptOutClicked, "chatgpt_canvas_opt_out_clicked", {
                    num_turns: String(v),
                    conversation_id: ye(e),
                    message_id: S
                }), Me(e, C => {
                    C.disabledToolIds = _
                })
            }
        }
    },
    Mt = ({
        clientThreadId: e,
        groupedMessages: a
    }) => {
        const {
            isVisible: t,
            onClick: o
        } = yt(e, a);
        return t ? s.jsx("button", {
            onClick: o,
            className: "mb-2 w-full text-token-text-secondary hover:text-token-text-primary",
            children: s.jsxs("div", {
                className: "flex items-center rounded-xl",
                children: [s.jsx(A, {
                    id: "aa5Dyk",
                    defaultMessage: "Answer in chat instead"
                }), s.jsx(Pe, {
                    className: "icon-md text-token-text-secondary"
                })]
            })
        }) : null
    },
    vt = (e, a) => e ? .textdocId ? e.textdocId : e ? .function === U.CreateTextdoc ? Cs(e.messageId) : a ? ? void 0,
    Tt = ({
        messages: e,
        isRequestActive: a,
        isFinalTurn: t,
        allGroupedMessages: o,
        clientThreadId: i
    }) => {
        const r = G(),
            l = cs(e),
            d = ds(e),
            n = p.useMemo(() => {
                if (ms(l ? .message)) return us(a, l.message, d ? .message ? ? null)
            }, [a, l, d]),
            g = gs(),
            c = vt(n, g),
            x = fs(c),
            f = xs(),
            _ = ps(c),
            y = hs(),
            v = _s(),
            S = Es(),
            C = ys(),
            b = Ms({
                textdocId: c,
                assistantMessage: l
            }),
            D = vs(() => {
                const h = Ee(i) ? .modelId;
                be.logError("Textdoc missing from conversation", null, {
                    clientThreadId: i,
                    modelId: h,
                    textdocId: c,
                    latestTextdocId: g,
                    toolCallTextdocId: n ? .textdocId,
                    toolCallStatus: n ? .status,
                    toolCallFunction: n ? .function
                })
            });
        p.useEffect(() => {
            !a && n ? .status === E.COMPLETE && !C && !x && D()
        }, [n, x, a, C, D]);
        const M = oe("canvas");
        if (!n) return null;
        const w = n.status === E.REDACTED || !C && !x && n.status !== E.STREAMING && n.status !== E.WAITING;
        let O, J;
        if (n.status !== E.REDACTED && n.status !== E.FAILED && !w && c) {
            const h = n.function === U.UpdateTextdoc && n.status === E.COMPLETE;
            O = () => {
                M(), h && n.versionInt ? Ss(c, n.versionInt, y) : le(c)
            }, J = () => {
                h && n.versionInt && S(c, n.versionInt)
            }
        }
        const H = Ct(n, x);
        if (n.function === U.CreateTextdoc) {
            if (n.status === E.STREAMING || n.status === E.WAITING || n.status === E.COMPLETE) {
                const k = C === !0 && (n.status === E.STREAMING || n.status === E.WAITING);
                return s.jsxs(s.Fragment, {
                    children: [s.jsx(re, {
                        textdocId: c,
                        name: H,
                        tag: n.type,
                        icon: Q(n.type, !1),
                        iconSelected: Q(n.type, !0),
                        isCanvasOpen: f,
                        isInlinePreview: b,
                        isFetching: k,
                        isFocused: _,
                        isStreaming: n.status === E.STREAMING,
                        onClick: O
                    }), t && s.jsx(Mt, {
                        clientThreadId: i,
                        groupedMessages: o
                    })]
                })
            }
            let h;
            switch (n.status) {
                case E.FAILED:
                    h = r.formatMessage({
                        id: "SNarKX",
                        defaultMessage: "Failed to generate"
                    });
                    break;
                case E.CANCELED:
                    h = r.formatMessage({
                        id: "1A6W36",
                        defaultMessage: "Stopped generating"
                    });
                    break;
                case E.REDACTED:
                    h = s.jsx(Be, {
                        align: "start",
                        label: r.formatMessage({
                            id: "F6q1k7",
                            defaultMessage: "Removed from shared conversation"
                        }),
                        children: r.formatMessage({
                            id: "BqyYDu",
                            defaultMessage: "Created document"
                        })
                    });
                    break
            }
            return s.jsx(me, {
                children: h
            })
        }
        const K = w || n.status === E.REDACTED,
            q = v && !K ? H : null,
            m = s.jsx(me, {
                onClick: O,
                onMouseOver: J,
                isStreaming: n.status === E.STREAMING,
                children: n.function === U.CommentTextdoc ? bt(r, n, q) : St(r, n, q)
            });
        return b && !f && !w && c ? s.jsxs("div", {
            className: "flex flex-col gap-2",
            children: [s.jsx(re, {
                textdocId: c,
                name: H,
                tag: x ? .type,
                icon: Q(x ? .type, !1),
                iconSelected: Q(x ? .type, !0),
                isCanvasOpen: f,
                isFetching: !1,
                isFocused: _,
                isInlinePreview: !0,
                isStreaming: n.status === E.STREAMING,
                onClick: c != null ? () => {
                    M(), le(c)
                } : void 0
            }), m]
        }) : m
    };

function Ct(e, a) {
    return a ? .title ? a.title : e.function === U.CreateTextdoc && e.title ? Ts(e.title) : null
}
const me = ({
        isStreaming: e = !1,
        onClick: a,
        onMouseOver: t,
        children: o
    }) => s.jsx("button", {
        disabled: !a,
        className: I(e && "loading-shimmer", "flex min-h-5 w-fit select-none pt-[3px] text-start text-token-text-secondary", a && "hover:text-token-text-primary"),
        onClick: a,
        onMouseOver: t,
        children: o
    }),
    we = 9;

function St(e, a, t) {
    if (a.status === E.STREAMING) return t ? e.formatMessage({
        id: "W2xN1Z",
        defaultMessage: "Editing {documentTitle}"
    }, {
        documentTitle: t
    }) : e.formatMessage({
        id: "8taq8v",
        defaultMessage: "Editing"
    });
    if (a.status === E.FAILED) return t ? e.formatMessage({
        id: "UjJKYZ",
        defaultMessage: "Failed to edit {documentTitle}"
    }, {
        documentTitle: t
    }) : e.formatMessage({
        id: "kWUVkg",
        defaultMessage: "Failed to edit"
    });
    if (a.status === E.CANCELED) return t ? e.formatMessage({
        id: "TmSrCd",
        defaultMessage: "Stopped editing {documentTitle}"
    }, {
        documentTitle: t
    }) : e.formatMessage({
        id: "bYV7xA",
        defaultMessage: "Stopped editing"
    });
    const o = a.updates ? .length;
    return a.status === E.REDACTED || !o || o > we ? t ? e.formatMessage({
        id: "n+G/ct",
        defaultMessage: "Edited {documentTitle}"
    }, {
        documentTitle: t
    }) : e.formatMessage({
        id: "aegqpL",
        defaultMessage: "Edited"
    }) : t ? e.formatMessage({
        id: "osYMSb",
        defaultMessage: "{numEdits, plural, one {Edited {documentTitle}} other {Made {numEdits} edits to {documentTitle}}}"
    }, {
        numEdits: o,
        documentTitle: t
    }) : e.formatMessage({
        id: "xJD3WR",
        defaultMessage: "{numEdits, plural, one {Edited} other {Made {numEdits} edits}}"
    }, {
        numEdits: o
    })
}

function bt(e, a, t) {
    if (a.status === E.STREAMING) return t ? e.formatMessage({
        id: "8xQH/P",
        defaultMessage: "Commenting on {documentTitle}"
    }, {
        documentTitle: t
    }) : e.formatMessage({
        id: "5yqLeN",
        defaultMessage: "Commenting"
    });
    if (a.status === E.FAILED) return t ? e.formatMessage({
        id: "Rl821S",
        defaultMessage: "Failed to comment on {documentTitle}"
    }, {
        documentTitle: t
    }) : e.formatMessage({
        id: "W007jt",
        defaultMessage: "Failed to comment"
    });
    if (a.status === E.CANCELED) return t ? e.formatMessage({
        id: "bozPdq",
        defaultMessage: "Stopped commenting on {documentTitle}"
    }, {
        documentTitle: t
    }) : e.formatMessage({
        id: "hyBGa7",
        defaultMessage: "Stopped commenting"
    });
    const o = a.comments ? .length;
    return a.status === E.REDACTED || !o || o > we ? t ? e.formatMessage({
        id: "LXEzK7",
        defaultMessage: "Commented on {documentTitle}"
    }, {
        documentTitle: t
    }) : e.formatMessage({
        id: "KeMYhy",
        defaultMessage: "Commented"
    }) : t ? e.formatMessage({
        id: "Ql5lPq",
        defaultMessage: "{numComments, plural, one {Commented on {documentTitle}} other {Added {numComments} comments on {documentTitle}}}"
    }, {
        numComments: o,
        documentTitle: t
    }) : e.formatMessage({
        id: "FHtyJQ",
        defaultMessage: "{numComments, plural, one {Commented} other {Added {numComments} comments}}"
    }, {
        numComments: o
    })
}

function jt(e, a, t) {
    const o = je(n => !!(e && n.tasks[e])),
        {
            openThreadSidebar: i
        } = W(),
        r = oe("caterpillar"),
        l = bs(t, e),
        {
            clearSystemHintModeTrigger: d
        } = ke();
    p.useEffect(() => {
        if (o || !e || !a) return;
        const {
            async_task_created_at: n,
            async_task_prompt: g,
            async_task_title: c
        } = a.metadata ? ? {};
        if (!n || !g || !c) return;
        const f = {
            originalConversationId: ye(t) ? ? t,
            taskId: e,
            title: c,
            prompt: g,
            createdAt: n,
            updatedAt: n,
            status: P.UNDETERMINED
        };
        js.setTask(e, f), d(Ae.Research)
    }, [o, e, a, t, i, r, d, l])
}
const se = {
        div: e => {
            const {
                node: a,
                children: t,
                ...o
            } = e;
            return s.jsx("div", { ...o,
                className: "text-red-500",
                children: t
            })
        },
        p: e => {
            const {
                node: a,
                children: t,
                ...o
            } = e;
            return s.jsx("p", { ...o,
                className: "text-start leading-6 text-token-text-primary",
                children: t
            })
        },
        a: e => {
            const {
                node: a,
                children: t,
                ...o
            } = e;
            return s.jsx("a", { ...o,
                className: "font-sm leading-6 !text-token-text-primary",
                children: t
            })
        }
    },
    At = 1e3 * 60 * 2,
    Nt = 30;

function Re({
    onClick: e,
    statusMessage: a,
    showSources: t,
    includeMargin: o,
    sources: i,
    progressBar: r
}) {
    const l = Ne();
    return s.jsx("button", {
        onClick: () => l && e(),
        className: I("mt-4 flex w-4/5 max-w-[416px] items-start justify-start gap-[18px] rounded-2xl border border-black/10 bg-token-main-surface-primary px-5 py-4 shadow dark:border-white/10", l ? "cursor-pointer hover:bg-token-main-surface-secondary" : "cursor-auto"),
        children: s.jsxs("div", {
            className: "flex w-full flex-col gap-3",
            children: [s.jsxs("div", {
                className: I("flex flex-col items-start justify-start self-stretch md:h-7 md:flex-row md:items-center md:justify-between", t ? "h-12" : "h-6"),
                children: [s.jsx("div", {
                    className: I("font-sm w-full flex-1 truncate text-start leading-7 text-token-text-primary md:w-0", o && "mr-[30px]"),
                    children: a
                }), t && i]
            }), s.jsx("div", {
                className: "flex w-full items-center justify-start gap-4 self-stretch pb-2",
                children: r
            })]
        })
    })
}

function ie({
    toggleSidebar: e,
    openSidebar: a,
    startTime: t
}) {
    const o = G(),
        [i, r] = p.useState(!1),
        l = As();
    return p.useEffect(() => {
        if (!t) return;
        const d = Date.now() - t,
            n = At - d;
        if (n > 0) {
            const g = setTimeout(() => {
                r(!0), a()
            }, n);
            return () => clearTimeout(g)
        } else r(!0), a()
    }, [t, a]), s.jsx(Re, {
        onClick: e,
        statusMessage: i ? o.formatMessage({
            id: "T2SbxC",
            defaultMessage: "Waiting…"
        }) : s.jsx("div", {
            className: "text-pretty text-sm font-medium text-token-text-primary",
            children: l.startingMessage
        }),
        progressBar: s.jsx(Ns, {
            className: "h-2 w-full"
        }),
        showSources: !1
    })
}

function It(e, a, t) {
    const o = e.formatMessage({
        id: "Bs+OcV",
        defaultMessage: "Thinking…"
    });
    if (a.length < 2) return t ? .initial ? ? o;
    const i = a[a.length - 2];
    return i.type === "summary" ? i.title : i.type === "search" ? i.query : i ? .type === "websiteOpen" ? s.jsx(ee, {
        componentOverrides: se,
        children: i.activeRowText
    }) : i.type === "fileOpen" ? s.jsx(ee, {
        componentOverrides: se,
        children: i.activeRowText
    }) : i.type === "pythonAnalysis" ? s.jsx(ee, {
        componentOverrides: se,
        children: i.analysisSummary
    }) : o
}

function kt({
    task: e,
    clientThreadId: a,
    caterpillarRows: t,
    messageWithTaskMetadata: o,
    totalSources: i,
    handleToggleCaterpillarSidebar: r
}) {
    const l = G(),
        d = Ne(),
        n = It(l, t, o.metadata ? .async_task_status_messages),
        g = (e ? .expectedDurationMinutes ? ? Nt) * 60 * 1e3,
        c = Is(t[1] ? .created_at ? t[1].created_at * 1e3 : Date.now(), g),
        x = t[1] && t[1].created_at ? c : 0;
    p.useEffect(() => {
        Me(a, y => {
            y.async_status = ze.STREAMING
        })
    }, [a]);
    const {
        openThreadSidebar: f
    } = W();
    p.useEffect(() => {
        t.length === 2 && d && f({
            type: "caterpillar",
            caterpillarId: e.taskId,
            initialTab: "activity",
            clientThreadId: a
        })
    }, [t.length, f, e.taskId, a, d]);
    const _ = p.useCallback(() => {
        f({
            type: "caterpillar",
            caterpillarId: e.taskId,
            initialTab: "activity",
            clientThreadId: a
        })
    }, [f, e.taskId, a]);
    return t.length <= 1 ? s.jsx(ie, {
        toggleSidebar: () => r("activity"),
        openSidebar: _,
        startTime: new Date(e.createdAt).getTime()
    }) : s.jsx(Re, {
        onClick: () => r("activity"),
        statusMessage: n,
        showSources: !0,
        includeMargin: i > 0,
        sources: i === 0 ? s.jsx("div", {
            className: "text-pretty text-sm text-token-text-tertiary",
            children: s.jsx(A, {
                id: "zfwUjs",
                defaultMessage: "Looking for sources…"
            })
        }) : s.jsxs("button", {
            onClick: y => {
                y.stopPropagation(), r("sources")
            },
            className: I("flex shrink-0 gap-1 text-[13px] leading-[18px] text-[#0285ff]", d ? "cursor-pointer hover:text-[#0285ff]/80" : "cursor-auto"),
            children: [s.jsx("div", {
                className: "relative",
                children: s.jsx(B, {
                    initial: !1,
                    children: s.jsx(L.span, {
                        initial: {
                            opacity: 0,
                            rotateX: -90,
                            translateY: 20
                        },
                        animate: {
                            opacity: 1,
                            rotateX: 0,
                            translateY: 0
                        },
                        exit: {
                            opacity: 0,
                            rotateX: 90,
                            translateY: -20
                        },
                        transition: {
                            duration: .35
                        },
                        className: "absolute left-0 md:right-0",
                        children: i
                    }, i)
                })
            }), s.jsx("div", {
                className: I("md:pr-0", i > 0 && "pl-2", i > 9 && "pl-[14px]", i > 99 && "pl-[22px]"),
                children: i > 1 ? s.jsx(A, {
                    id: "zN+MuO",
                    defaultMessage: " sources"
                }) : s.jsx(A, {
                    id: "dMowmJ",
                    defaultMessage: " source"
                })
            })]
        }),
        progressBar: s.jsx("div", {
            className: "flex h-2 shrink grow basis-0 items-start justify-start gap-2.5 overflow-hidden rounded-[10px] bg-token-main-surface-tertiary",
            children: s.jsx(ks, {
                percentage: x,
                barClassName: "bg-token-text-primary",
                backgroundClassName: "bg-token-main-surface-tertiary"
            })
        })
    })
}

function ue({
    task: e,
    clientThreadId: a,
    messageWithTaskMetadata: t,
    totalSources: o,
    handleToggleCaterpillarSidebar: i
}) {
    const r = ws(e),
        l = !1,
        d = z(a, g => Rs(g, e ? .taskId)),
        {
            clearSystemHintModeTrigger: n
        } = ke();
    return p.useEffect(() => {
        e ? .status === P.COMPLETED && !d && !l && (r(), n(Ae.Research))
    }, [e ? .status, l, d, r, n]), s.jsx(ne, {
        message: s.jsxs(s.Fragment, {
            children: [t.metadata ? .async_task_status_messages ? .completed_with_time ? ? t.metadata ? .async_task_status_messages ? .completed_no_time ? ? s.jsx(A, {
                id: "4d0xZc",
                defaultMessage: "Completed"
            }), o === 0 ? s.jsx(A, {
                id: "VggF2B",
                defaultMessage: " · 0 sources"
            }) : o === 1 ? s.jsx(A, {
                id: "zkkdKV",
                defaultMessage: " · 1 source"
            }) : s.jsx(A, {
                id: "qcKt3q",
                defaultMessage: " · {sourcesCount} sources",
                values: {
                    sourcesCount: o
                }
            })]
        }),
        handleToggleCaterpillarSidebar: () => i("activity")
    })
}

function wt({
    messages: e,
    clientThreadId: a
}) {
    const t = e.find(g => g.message.metadata ? .b1de6e2_s && g.message.metadata ? .async_task_id) ? .message,
        o = t ? .metadata ? .async_task_id,
        i = e.find(g => g.message.recipient === _e.START_RESEARCH_TASK),
        r = z(a, g => Ds(g, i ? .message.id)),
        l = We({
            clientThreadId: a
        }),
        [d, n] = p.useState(l);
    return p.useEffect(() => {
        const g = setTimeout(() => {
            n(r && l)
        }, 3e3);
        return () => clearTimeout(g)
    }, [l, r]), !t || !o ? d ? s.jsx(ie, {
        toggleSidebar: () => {},
        openSidebar: () => {},
        startTime: new Date().getTime()
    }) : null : s.jsx(Rt, {
        clientThreadId: a,
        payloadTaskId: o,
        messageWithTaskMetadata: t
    })
}

function Rt({
    payloadTaskId: e,
    messageWithTaskMetadata: a,
    clientThreadId: t
}) {
    jt(e, a, t);
    const o = je(x => e ? x.tasks[e] : null),
        i = G(),
        r = o ? .status,
        l = p.useMemo(() => o ? .rows ? o.rows : [], [o ? .rows]),
        {
            toggleThreadSidebar: d
        } = W(),
        {
            totalSources: n
        } = p.useMemo(() => {
            if (!l) return {
                uniqueSources: [],
                totalSources: 0
            };
            const x = Ls(l),
                f = x.reduce((_, y) => _ + y.count, 0);
            return {
                uniqueSources: x,
                totalSources: f
            }
        }, [l]),
        g = oe("caterpillar"),
        c = p.useCallback(x => {
            e && d({
                type: "caterpillar",
                caterpillarId: e,
                initialTab: x,
                clientThreadId: t
            }, g)
        }, [d, e, g, t]);
    return Os(e), a.metadata ? .async_task_status_messages ? .completed_with_time ? s.jsx(ue, {
        task: o,
        clientThreadId: t,
        messageWithTaskMetadata: a,
        totalSources: n,
        handleToggleCaterpillarSidebar: c
    }) : !o || !r || r === P.UNDETERMINED ? s.jsx(ie, {
        toggleSidebar: () => {},
        openSidebar: () => {},
        startTime: new Date().getTime()
    }) : o.status === P.COMPLETED ? s.jsx(ue, {
        task: o,
        clientThreadId: t,
        messageWithTaskMetadata: a,
        totalSources: n,
        handleToggleCaterpillarSidebar: c
    }) : o.status === P.FAILED ? s.jsx(ne, {
        message: a.metadata ? .async_task_status_messages ? .error ? ? i.formatMessage({
            id: "at6zk8",
            defaultMessage: "Failed to think"
        }),
        handleToggleCaterpillarSidebar: () => c("activity")
    }) : o.status === P.CANCELLED ? s.jsx(ne, {
        message: a.metadata ? .async_task_status_messages ? .cancelled ? ? i.formatMessage({
            id: "u1rIr5",
            defaultMessage: "Task Cancelled"
        }),
        handleToggleCaterpillarSidebar: () => c("activity")
    }) : s.jsx(kt, {
        task: o,
        clientThreadId: t,
        caterpillarRows: l,
        messageWithTaskMetadata: a,
        totalSources: n,
        handleToggleCaterpillarSidebar: c
    })
}

function Dt(e, a, t) {
    const o = a.elements.length;
    if (o === 0) return;
    const i = Object.entries(e).reduce((r, [l, d]) => Array.isArray(d) ? d.length > 0 ? r + 1 : r : d !== "" ? r + 1 : r, 0);
    qe.logEventWithStatsig("dynamic-form-submission", "chatgpt_dyanmic_form_submission", { ...Ye({
            clientThreadId: t
        }),
        totalItems: o.toString(),
        completedItems: i.toString(),
        ratio: (i / o).toString()
    })
}

function Lt(e, a) {
    let t = "";
    return a.elements.forEach(o => {
        const i = o.scope.split("/").pop(),
            r = i && e[i],
            l = r ? Array.isArray(r) ? r.join(", ") : r : "Any",
            d = o.label ? ? i;
        t += `${d}: ${l}
`
    }), t
}

function Ot({
    messages: e,
    clientThreadId: a,
    isLastMessage: t
}) {
    const o = e.find(M => M.message.author.role === ve.Assistant),
        i = e.find(M => M.message.metadata ? .json_form),
        r = i ? .message.metadata ? .json_form,
        [l, d] = p.useState({}),
        [n, g] = p.useState(),
        [c, x] = p.useState(),
        f = xt(),
        _ = pt(a);
    p.useEffect(() => {
        r && (g(r.json_form_ui), x(r.json_form_data))
    }, [r]);
    const y = p.useCallback(() => {
            if (d({}), n) {
                const M = { ...n,
                    elements: n.elements.filter(w => w.scope !== "#/properties/AdditionalInfo")
                };
                g(M)
            }
            c && (delete c.properties.AdditionalInfo, x(c))
        }, [d, g, x, n, c]),
        v = p.useCallback(() => {
            if (n) {
                const M = { ...n,
                    elements: [...n.elements, {
                        type: "Control",
                        scope: "#/properties/AdditionalInfo",
                        label: "Additional Info",
                        placeholder: "Any other details..."
                    }]
                };
                g(M)
            }
            if (c) {
                const M = { ...c.properties,
                    AdditionalInfo: {
                        type: "string"
                    }
                };
                x({ ...c,
                    properties: M
                })
            }
        }, [g, x, n, c]),
        S = n ? .elements.some(M => M.scope.endsWith("#/properties/AdditionalInfo")),
        C = Je.getThreadCurrentLeafId(a),
        b = i ? .nodeId !== C;
    if (!i || !c || !n) return o ? .message.status === "in_progress" && t ? s.jsxs("div", {
        className: "flex flex-col gap-2",
        children: [s.jsx(ce, {
            className: "h-[26px] w-full"
        }), s.jsx(ce, {
            className: "h-[26px] w-3/4"
        }), s.jsx(Ps, {})]
    }) : null;
    if (b) return null;
    const D = async M => {
        const w = Lt(l, n);
        Dt(l, n, a), _({
            sourceEvent: M,
            promptMessage: Ke(w),
            completionMetadata: {
                systemHints: [...f],
                conversationMode: {
                    kind: $.PrimaryAssistant
                }
            }
        })
    };
    return s.jsxs(Fs, {
        children: [s.jsx(Pt, {
            formData: l,
            dataSchema: c,
            uiSchema: n,
            setData: d,
            readOnly: b
        }), s.jsxs("div", {
            className: "flex w-full justify-between",
            children: [S ? s.jsx("div", {}) : s.jsx(Z, {
                disabled: b,
                onClick: v,
                color: "secondary",
                className: "text-token-text-secondary",
                children: s.jsx(A, {
                    id: "Sen69P",
                    defaultMessage: "Add a detail"
                })
            }), s.jsxs("div", {
                className: "flex gap-2",
                children: [s.jsx(Z, {
                    disabled: b,
                    onClick: y,
                    color: "secondary",
                    className: "text-token-text-secondary",
                    children: s.jsx(A, {
                        id: "Uqo7UD",
                        defaultMessage: "Reset"
                    })
                }), s.jsx(Z, {
                    disabled: b,
                    onClick: D,
                    children: s.jsx(A, {
                        id: "FVou++",
                        defaultMessage: "Start"
                    })
                })]
            })]
        })]
    })
}

function Pt({
    dataSchema: e,
    uiSchema: a,
    setData: t,
    readOnly: o,
    formData: i
}) {
    return s.jsx("div", {
        children: s.jsx(Vs, {
            formData: i,
            readOnly: o,
            schema: e,
            uiSchema: a,
            onChange: r => t(r)
        })
    })
}
const Ft = 2e3,
    De = .4,
    Vt = .45,
    Ht = .2,
    Ut = .1,
    Bt = .25;
var F = (e => (e[e.Running = 0] = "Running", e[e.Finished = 1] = "Finished", e[e.Error = 2] = "Error", e[e.Stopped = 3] = "Stopped", e[e.Paused = 4] = "Paused", e))(F || {});

function Ca({
    conversationMessages: e,
    icon: a,
    status: t,
    text: o,
    estimatedToolDurationMs: i,
    animationLoopDurationMs: r = Ft,
    shouldPersistAfterFinished: l = !1
}) {
    const [d, n] = p.useState(t === 0 ? 0 : t === 1 && !l ? 7 : 1), [g, c] = p.useState(0);
    p.useEffect(() => {
        t === 2 ? n(8) : t === 3 ? n(9) : t === 4 ? n(10) : t === 1 ? n(d === 2 ? 3 : 7) : t === 0 && d === 10 && (n(2), c(f => f + 1))
    }, [t]);
    const x = Jt(d);
    return p.useEffect(() => {
        const f = e[0].message.id;
        if (x) return de.addDelayedRenderingMessage(f), () => {
            de.removeDelayedRenderingMessage(f)
        }
    }, [x]), Ie(() => {
        V(d) && c(f => f + 1)
    }, r), d === 7 && !l ? null : s.jsxs("div", {
        className: "my-2.5 flex items-center gap-2.5",
        children: [s.jsx(zt, {
            icon: a,
            status: t,
            uiState: d,
            estimatedToolDurationMs: i,
            animationLoopCounter: g,
            shouldPersistAfterFinished: l,
            onFillProgressBarAnimationComplete: () => n(4),
            onFinishAnimationComplete: () => {
                n(5), setTimeout(() => {
                    n(l ? 7 : 6)
                }, Ut * 1e3)
            },
            onHideAnimationComplete: () => n(7)
        }), s.jsx(Wt, {
            text: o,
            uiState: d,
            animationLoopCounter: g,
            onEnterAnimationComplete: () => n(2)
        })]
    })
}
const ge = 50;

function zt({
    icon: e,
    status: a,
    uiState: t,
    estimatedToolDurationMs: o,
    animationLoopCounter: i,
    shouldPersistAfterFinished: r,
    onFillProgressBarAnimationComplete: l,
    onFinishAnimationComplete: d,
    onHideAnimationComplete: n
}) {
    const [g, c] = p.useState(0);
    Ie(() => {
        V(t) ? c(b => b + ge) : t === 10 && c(0)
    }, ge);
    let x, f, _;
    V(t) || t === 10 ? (x = "running", f = s.jsx(e, {
        animationLoopCounter: i
    }), _ = "bg-transparent") : t === 4 || t === 5 || t === 7 && r ? (x = "finished", f = s.jsx(Us, {}), _ = "bg-brand-purple") : a === 2 ? (x = "error", f = s.jsx(Bs, {}), _ = "bg-orange-500") : a === 3 && (x = "stopped", f = s.jsx(zs, {}), _ = "bg-gray-300");
    let y = {
            opacity: 0,
            scale: 0,
            rotate: -180,
            x: 0
        },
        v = {
            type: "spring",
            bounce: .3,
            duration: Vt
        },
        S = {
            opacity: 0,
            scale: .6,
            rotate: 0,
            x: 0
        };
    t === 0 ? (y = {
        opacity: 0,
        scale: .5,
        rotate: -180,
        x: -8
    }, v = {
        type: "spring",
        bounce: .3,
        duration: De
    }) : t === 1 ? y = !1 : t === 5 && (S = {
        opacity: 0,
        scale: 0,
        rotate: 0,
        x: 0
    }, v = {
        type: "spring",
        bounce: .3,
        duration: Bt
    });
    const C = Ws(g, o);
    return s.jsx("div", {
        className: "relative h-5 w-5 shrink-0",
        children: s.jsx(B, {
            onExitComplete: () => {
                t === 6 && n()
            },
            children: x != null && s.jsxs(L.div, {
                className: I("absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white", _),
                initial: y,
                animate: {
                    opacity: 1,
                    scale: 1,
                    rotate: 0,
                    x: 0
                },
                exit: S,
                transition: v,
                onAnimationComplete: () => {
                    t === 4 && d()
                },
                children: [f, (V(t) || t === 10) && s.jsx(Hs, {
                    percentage: t === 3 ? 100 : C,
                    thickness: 1.5 / 23,
                    className: "absolute left-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2 text-brand-purple",
                    backgroundStrokeClassName: "stroke-brand-purple/25 dark:stroke-brand-purple/50",
                    transitionDuration: t === 3 ? `${(100-C)/100*Ht}s` : void 0,
                    transitionTimingFunction: t === 3 ? "cubic-bezier(0.55, 0, 1, 1)" : void 0,
                    onTransitionEnd: () => {
                        t === 3 && l()
                    }
                })]
            }, x)
        })
    })
}

function Wt({
    text: e,
    uiState: a,
    animationLoopCounter: t,
    onEnterAnimationComplete: o
}) {
    const [i, r] = p.useState(e);
    p.useEffect(() => {
        a === 2 && r(e)
    }, [t]), p.useEffect(() => {
        V(a) || r(e)
    }, [a, e]);
    let l = {
            opacity: 0,
            x: 0,
            y: 15
        },
        d = {
            type: "spring",
            bounce: .3,
            opacity: {
                duration: .15
            },
            y: {
                duration: .3
            }
        };
    a === 0 ? (l = {
        opacity: 0,
        x: -8,
        y: 0
    }, d = {
        type: "spring",
        bounce: .3,
        duration: De,
        delay: .15
    }) : a === 1 && (l = !1);
    const n = i ? ? void 0;
    return s.jsx("div", {
        className: I("relative h-5 w-full leading-5", a === 8 || a === 9 ? "text-token-text-tertiary" : "text-token-text-secondary"),
        children: s.jsx(B, {
            children: n != null && s.jsx(L.div, {
                className: "absolute left-0 top-0 line-clamp-1 overflow-visible",
                initial: l,
                animate: {
                    opacity: 1,
                    x: 0,
                    y: 0
                },
                exit: {
                    opacity: 0,
                    x: 0,
                    y: -15
                },
                transition: d,
                onAnimationComplete: () => {
                    a === 0 && o()
                },
                children: n
            }, n.toString())
        })
    })
}

function V(e) {
    return e === 0 || e === 2 || e === 3
}

function Jt(e) {
    return V(e) || e === 4 || e === 5 || e === 6 || e === 10
}
const fe = Te.div `group left-0 top-0 mr-1.5 overflow-hidden mt-1 text-start`,
    Kt = ({
        highlightedCommand: e,
        status: a,
        children: t,
        showWorkUserSetting: o = !1,
        hideOnlyIfNotInteractedWith: i = !1,
        defaultExpanded: r = !1,
        onOpenAnalytics: l,
        onClick: d,
        ...n
    }, g) => {
        const c = t != null || d != null,
            [x] = p.useState(o),
            [f, _] = p.useState(o || r),
            [y, v] = p.useState(!1),
            S = a === F.Finished || a === F.Error,
            C = i ? x ? !1 : !y : !1,
            b = a === F.Running && "loading-shimmer";
        return S && C ? null : c ? s.jsxs(s.Fragment, {
            children: [s.jsx(xe, {
                ref: g,
                $canShowWork: !0,
                ...n,
                children: s.jsx(B, {
                    children: s.jsx(fe, {
                        children: s.jsx(L.button, {
                            onClick: D => {
                                f || l ? .(), _(M => !M), v(!0), d ? .(D)
                            },
                            initial: {
                                opacity: 0
                            },
                            animate: {
                                opacity: 1
                            },
                            exit: {
                                opacity: 0
                            },
                            transition: {
                                duration: .3
                            },
                            className: I(b),
                            children: s.jsxs("div", {
                                className: "flex items-center justify-start gap-1",
                                children: [s.jsx("span", {
                                    className: "text-start",
                                    children: e
                                }), !d && (f ? s.jsx(Js, {
                                    className: "icon-md"
                                }) : s.jsx(Ks, {
                                    className: "icon-md"
                                }))]
                            })
                        }, e ? .toString())
                    })
                })
            }), s.jsx(B, {
                children: f && t && s.jsx(L.div, {
                    initial: "collapsed",
                    animate: "reveal",
                    exit: "collapsed",
                    variants: {
                        collapsed: {
                            translateY: -20,
                            opacity: 0,
                            height: 0
                        },
                        reveal: {
                            translateY: 0,
                            opacity: 1,
                            height: "auto"
                        }
                    },
                    transition: {
                        duration: .3,
                        ease: "easeInOut"
                    },
                    className: "overflow-hidden",
                    children: t
                })
            })]
        }) : s.jsx(xe, {
            ref: g,
            $canShowWork: !1,
            ...n,
            children: s.jsx(fe, {
                className: I(b),
                children: e
            })
        })
    },
    xe = Te.span `block first:mt-0 relative
${({$canShowWork:e})=>e?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,
    qt = p.forwardRef(Kt),
    Yt = 3,
    Qt = .1,
    pe = [0, .26, .4];

function Xt({
    nextMessage: e,
    isLastMessage: a,
    isRequestActive: t,
    isLastTurnInConversation: o,
    clientThreadId: i,
    turnIndex: r
}) {
    let l = a || !e || e && !ae(e.message);
    const d = p.useRef(!1),
        n = Se(),
        g = z(i, X.getGizmoId);
    p.useEffect(() => {
        e && ae(e.message) && !d.current && (d.current = !0, qs(n, g))
    }, [e, n, g]);
    const c = Qe(e ? .message),
        x = Xe(e ? .message);
    e ? .message.id && _t(e ? .message.id);
    const f = [];
    if (x ? .[0] ? .type === "navigation" && e && f.push(s.jsx($t, {
            clientThreadId: i,
            turnIndex: r,
            nextMessage: e,
            isRequestActive: t,
            isLastTurnInConversation: o,
            navigationCitation: x[0]
        }, "fast-nav")), l) {
        const _ = $e(c.slice(0, Yt).map(v => v.entries[0].url)),
            y = t ? s.jsxs("div", {
                className: "flex items-center gap-1",
                children: [_.map((v, S) => s.jsx(L.div, {
                    className: I("-ml-1.5 first:ml-0 last:mr-1.5", "relative"),
                    initial: {
                        width: S === 0 ? 0 : 6,
                        opacity: 0
                    },
                    animate: {
                        width: 20,
                        opacity: 1
                    },
                    transition: {
                        duration: Qt,
                        delay: pe[Math.min(S, pe.length - 1)]
                    },
                    children: s.jsx("div", {
                        className: I("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full", "border-2 border-token-main-surface-primary bg-token-main-surface-primary"),
                        children: s.jsx(Ys, {
                            url: v,
                            size: 32,
                            minSize: 16,
                            className: "icon-md rounded-full"
                        })
                    })
                }, v)), s.jsx(A, {
                    id: "jjx8Qg",
                    defaultMessage: "Searching the web"
                })]
            }) : s.jsx(A, {
                id: "fssXGM",
                defaultMessage: "Error while searching"
            });
        f.push(s.jsx(qt, {
            highlightedCommand: y,
            status: t ? F.Running : F.Error
        }, "search-gpt-query"))
    }
    return f.length ? s.jsx(s.Fragment, {
        children: f
    }) : null
}
const $t = ({
        clientThreadId: e,
        turnIndex: a,
        nextMessage: t,
        isRequestActive: o,
        isLastTurnInConversation: i,
        navigationCitation: r
    }) => {
        const {
            scrollToHeader: l
        } = Ge("searchSources") ? ? {}, d = Ze(), n = es() && d ? .type === "searchSources", {
            openThreadSidebar: g
        } = W(), {
            value: c
        } = Ce("756982148");
        return p.useEffect(() => {
            ss.addFirstTiming("render.fastNavigation")
        }, []), p.useEffect(() => {
            n && g({
                type: "searchSources",
                scrollToHeader: l,
                clientThreadId: e,
                turnIndex: a,
                messageId: t ? .message.id ? ? ""
            })
        }, []), p.useEffect(() => {
            const x = t.message,
                f = x.metadata ? .search_source,
                _ = r.domains.map(y => y.url);
            Qs.logEvent(te.searchToolRequestTimeToFastNav, e, x.id, {
                search_source: f,
                urls: _
            }, () => {
                f === ts.InstantQuery && Xs.logEvent(te.searchToolPageLoadTimeToFastNav, {
                    message_id: x.id,
                    urls: _,
                    search_source: f
                })
            })
        }, [e, t, r]), o && i && c ? s.jsx(L.div, {
            initial: {
                opacity: o ? 0 : 1,
                height: o ? 0 : "auto"
            },
            animate: {
                opacity: 1,
                height: "auto"
            },
            children: s.jsx(he, {
                clientThreadId: e,
                turnIndex: a,
                nextMessage: t,
                navigationCitation: r
            })
        }) : s.jsx(he, {
            clientThreadId: e,
            turnIndex: a,
            nextMessage: t,
            navigationCitation: r
        })
    },
    he = ({
        clientThreadId: e,
        turnIndex: a,
        nextMessage: t,
        navigationCitation: o
    }) => {
        const {
            toggleThreadSidebar: i
        } = W(), {
            value: r
        } = Ce("756982148"), l = p.useMemo(() => ({
            clientThreadId: e,
            turnIndex: a,
            messageId: t ? .message.id
        }), [e, a, t ? .message.id]), d = p.useCallback((g, c) => {
            i({
                type: "searchSources",
                scrollToHeader: c,
                clientThreadId: e,
                turnIndex: a,
                messageId: t ? .message.id ? ? ""
            })
        }, [i, e, a, t ? .message.id]), n = $s(l);
        return r ? s.jsx(ht, {
            navigation: o,
            onShowSearchResults: d,
            trackContentReferenceEvent: n
        }) : s.jsx(Gs, {
            tldr: {
                type: "tldr",
                display_title: o.domains[0].title,
                url: o.domains[0].url,
                matched_text: "",
                start_idx: 0,
                end_idx: 0,
                page_title: "",
                breadcrumbs: [o.domains[0].domain],
                refs: []
            },
            trackContentReferenceEvent: n
        })
    },
    Gt = j(() => N(() =>
        import ("./gah62ec9m9lupxpw.js"), __vite__mapDeps([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]))),
    Zt = j(() => N(() =>
        import ("./k2zciqacu7tc7hir.js"), __vite__mapDeps([14, 1, 3, 4, 15]))),
    ea = j(() => N(() =>
        import ("./ova7df072amsyyll.js"), __vite__mapDeps([16, 1, 3, 4, 8, 6, 7, 9]))),
    sa = j(() => N(() =>
        import ("./mrrykfxpv83z9tmn.js"), __vite__mapDeps([17, 1, 3, 4, 6, 7, 9])).then(e => e.TextMessageEditor)),
    ta = j(() => N(() =>
        import ("./fj96fkvbq9l88uwl.js").then(e => e.b), __vite__mapDeps([18, 1, 3, 4, 19, 6, 7, 20, 2, 5, 21, 10, 9]))),
    aa = j(async () => () => null),
    na = j(async () => (await N(() =>
        import ("./gijyfy18h2lvcn0n.js"), __vite__mapDeps([22, 1, 3, 4, 8, 6, 7, 9, 23, 2, 5, 18, 19, 20, 21, 10, 24, 11, 12, 13]))).ImageGenMessage),
    oa = j(() => N(() =>
        import ("./uhoky0cwglarnjft.js"), __vite__mapDeps([25, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13]))),
    ia = j(() => N(() =>
        import ("./percfv3j35b57wm6.js"), __vite__mapDeps([26, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13])).then(e => e.BrowsingMessage)),
    ra = j(() => N(() =>
        import ("./h3xng9crsp8lzsel.js"), __vite__mapDeps([27, 1, 3, 4, 6, 7])).then(e => e.SearchResultMessage)),
    la = j(() => N(() =>
        import ("./b9l0ct583oiwof9y.js"), __vite__mapDeps([28, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13])).then(e => e.JITPluginMessage)),
    ca = j(() => N(() =>
        import ("./laes23nj33z0vwdj.js"), __vite__mapDeps([29, 3, 1, 4, 6, 7, 8, 9, 10, 11, 12, 13])).then(e => e.DataAnalysisMessage)),
    da = j(() => N(() =>
        import ("./abecm95t02z1dqg1.js"), __vite__mapDeps([30, 1, 3, 4, 6, 7, 31, 32, 33, 8, 9, 10, 11, 12, 13]))),
    ma = j(() => N(() =>
        import ("./mli829qx6uv82l3j.js"), __vite__mapDeps([34, 1, 24, 3, 4, 6, 7, 35, 36, 10, 9, 37, 38, 39, 40, 41, 42, 19, 43, 44, 45, 11, 46, 47, 48, 31, 49])).then(e => e.CoTMessage)),
    ua = j(() => N(() =>
        import ("./f5ao0e2ci4o09nur.js"), __vite__mapDeps([50, 1, 6, 3, 4, 7, 51, 52, 53, 54])).then(e => e.JawboneMessage));

function Sa(e) {
    switch (e.type) {
        case u.Text:
        case u.Debug:
            return [e.message];
        case u.MultiText:
        case u.Browsing:
        case u.CodeInterpreter:
        case u.JITPlugin:
        case u.RetrievalBrowsing:
        case u.ParallelBrowsing:
        case u.Dalle:
        case u.t2uay3k:
        case u.GizmoEditor:
        case u.SearchResult:
        case u.a8km123:
        case u.f959b8c:
        case u.b1de6e2_c:
        case u.b1de6e2_s:
        case u.b1de6e2_d:
        case u.is_loading_message:
        case u.Canmore:
        case u.de1d73e:
        case u.SearchGPTQuery:
        case u.l1p9k3u:
        case u.oiw209h:
        case u.c12k321:
            return e.messages;
        default:
            throw new Error("Bad")
    }
}

function ba({
    groupedMessagesToRender: e,
    allMessages: a,
    allGroupedMessages: t,
    clientThreadId: o,
    isEditing: i,
    isUserTurn: r,
    isCompletionRequestInProgress: l,
    isFeedbackEnabled: d,
    isFinalTurn: n,
    turnIndex: g,
    hasActiveRequest: c,
    handleEnterEdit: x,
    handleExitEdit: f,
    onRequestCompletion: _,
    shouldGrowContainer: y = !0,
    showEditButton: v = !1,
    showCopyButton: S = !1,
    isParagen: C = !1
}) {
    const b = Zs(),
        D = os("1889094680") ? .value,
        {
            showDebugConversationTurns: M
        } = et(),
        [w] = z(o, m => [m ? .mode]),
        O = as(o),
        J = st(),
        H = t.some(m => tt.includes(m.type)),
        K = e.map((m, h) => {
            const k = h === t.length - 1;
            switch (m.type) {
                case u.Text:
                case u.MultiText:
                    {
                        const T = e[h - 1],
                            R = T ? .type,
                            Y = T && "messages" in T ? T.messages : void 0;
                        if (m.type === u.Text) {
                            const Le = m ? .message && !ae(m.message.message),
                                Oe = i ? s.jsx(sa, {
                                    message: m.message,
                                    clientThreadId: o,
                                    onRequestCompletion: _,
                                    onExitEdit: f,
                                    disabled: c
                                }) : H && Le ? null : s.jsx(ft, {
                                    className: "min-h-8",
                                    message: m.message,
                                    isFeedbackEnabled: d,
                                    isCompletionInProgress: k && l,
                                    hasActiveRequest: c,
                                    turnIndex: g,
                                    clientThreadId: o,
                                    showEditButton: v,
                                    showCopyButton: S,
                                    onEnterEdit: x,
                                    isUserTurn: r,
                                    prevGroupedMessageType: R,
                                    prevGroupedMessages: Y
                                });
                            return s.jsxs(p.Fragment, {
                                children: [Oe, s.jsx(ot, {
                                    isUserTurn: r,
                                    message: m.message.message
                                })]
                            }, "group-" + m.message.nodeId)
                        } else return m.type === u.MultiText ? s.jsx(ea, {
                            clientThreadId: o,
                            messages: m.messages,
                            isCompletionInProgress: k && l,
                            isFeedbackEnabled: d,
                            hasActiveRequest: c,
                            prevGroupedMessageType: R,
                            prevGroupedMessages: Y
                        }, "multitext-" + (m.messages[0] ? .nodeId ? ? h)) : m.type
                    }
                case u.Browsing:
                case u.RetrievalBrowsing:
                    {
                        const T = w != null && [$.GizmoInteraction, $.GizmoMagicCreate, $.GizmoTest].includes(w.kind),
                            R = O ? nt(O) : !1;
                        return s.jsx(ia, {
                            messages: m.messages,
                            isRequestActive: c,
                            isLastMessageInTurn: k,
                            isUsingGizmo: T,
                            isUsingSnorlax: R,
                            isRetrieval: m.type === u.RetrievalBrowsing
                        }, "browsing-" + (m.messages[0] ? .nodeId ? ? h))
                    }
                case u.SearchGPTQuery:
                    {
                        const T = t.slice(h + 1).find(({
                                type: Y
                            }) => Y === u.Text),
                            R = T ? .type === u.Text ? T.message : void 0;
                        return s.jsx(Xt, {
                            clientThreadId: o,
                            turnIndex: g,
                            isRequestActive: c,
                            isLastMessage: k,
                            isLastTurnInConversation: n,
                            nextMessage: R
                        }, "searchquery-" + (m.messages[0] ? .nodeId ? ? h))
                    }
                case u.a8km123:
                    if (b ? .isEnabled && m.messages.find(({
                            message: T
                        }) => T.metadata ? .model_slug ? .includes("o3-mini") || D && T.metadata ? .model_slug === "o1")) {
                        const T = a.findLastIndex(({
                            message: R
                        }) => R.author.role === ve.Assistant && R.recipient === "all");
                        return s.jsx(ma, {
                            isStreaming: (k || T < h) && l,
                            messages: m.messages
                        }, "sum-" + (m.messages[0] ? .nodeId ? ? h))
                    }
                    return s.jsx(da, {
                        messages: m.messages,
                        isStreaming: k && l,
                        isLastMessage: k,
                        clientThreadId: o,
                        currentGroupedMessageIndex: h,
                        turnIndex: g
                    }, "sum-" + (m.messages[0] ? .nodeId ? ? h));
                case u.f959b8c:
                    return null;
                case u.is_loading_message:
                    return k && l ? s.jsx(at, {}, "loading-message-" + h) : null;
                case u.c12k321:
                    return null;
                case u.l1p9k3u:
                    return null;
                case u.b1de6e2_c:
                    return s.jsx(Ot, {
                        messages: m.messages,
                        clientThreadId: o,
                        isLastMessage: k
                    }, "b1de6e2-" + (m.messages[0] ? .nodeId ? ? h));
                case u.b1de6e2_s:
                    return s.jsx(wt, {
                        messages: m.messages,
                        clientThreadId: o
                    }, "b1de6e2_s-" + (m.messages[0] ? .nodeId ? ? h));
                case u.b1de6e2_d:
                    return null;
                case u.de1d73e:
                    if (J) {
                        const T = h + 1 < t.length ? t[h + 1] : void 0;
                        return s.jsx(ua, {
                            clientThreadId: o,
                            currentGroupedMessage: m,
                            nextMessage: T && T.type === u.Text ? T.message : void 0,
                            isLastMessage: k,
                            isRequestActive: c
                        }, "jawbone-" + (m.messages[0] ? .nodeId ? ? h))
                    } else return null;
                case u.ParallelBrowsing:
                    return s.jsx(oa, {
                        messages: m.messages
                    }, "parallel-" + (m.messages[0] ? .nodeId ? ? h));
                case u.CodeInterpreter:
                    return s.jsx(ca, {
                        messages: m.messages,
                        isRequestActive: c,
                        clientThreadId: o
                    }, "ada-" + (m.messages[0] ? .nodeId ? ? h));
                case u.JITPlugin:
                    return s.jsx(la, {
                        messages: m.messages,
                        clientThreadId: o,
                        isLastTurnInConversation: n,
                        onRequestCompletion: _
                    }, "jit-" + (m.messages[0] ? .nodeId ? ? h));
                case u.t2uay3k:
                    return s.jsx(na, {
                        messages: m.messages,
                        clientThreadId: o,
                        disableClickThru: C
                    }, "t2uay3k-" + (m.messages[0] ? .nodeId ? ? h));
                case u.Dalle:
                    return s.jsx(ta, {
                        messages: m.messages,
                        clientThreadId: o,
                        disableClickThru: C
                    }, "dalle-" + (m.messages[0] ? .nodeId ? ? h));
                case u.GizmoEditor:
                    return s.jsx(Gt, {
                        messages: m.messages
                    }, "gizmo-editor-" + (m.messages[0] ? .nodeId ? ? h));
                case u.oiw209h:
                    return s.jsx(aa, {
                        messages: m.messages,
                        clientThreadId: o
                    }, "oiw209h-" + (m.messages[0] ? .nodeId ? ? h));
                case u.Canmore:
                    return s.jsx(Tt, {
                        messages: m.messages,
                        allGroupedMessages: e,
                        isFinalTurn: n,
                        isRequestActive: c,
                        clientThreadId: o
                    }, "canmore-" + (m.messages[0] ? .nodeId ? ? h));
                case u.Debug:
                    return M ? s.jsx(Zt, {
                        message: m.message
                    }, "debug-" + m.message.nodeId) : null;
                case u.SearchResult:
                    return s.jsx(ra, {
                        messages: m.messages
                    }, "search-result-" + (m.messages[0] ? .nodeId ? ? h))
            }
        }),
        q = mt();
    return s.jsx(fa, {
        shouldGrowContainer: y,
        children: it() ? s.jsxs(rt, {
            isDisabled: r || !n || !l,
            children: [lt() && !r && n && s.jsx(ct, {
                isWordByWordEnabled: dt(),
                isStreaming: l,
                debug: q
            }), K]
        }) : K
    })
}

function ga() {
    return s.jsx(ut, {
        type: "danger",
        children: s.jsx(A, {
            id: "5eGo3w",
            defaultMessage: "Unable to display this message due to an error."
        })
    })
}

function fa({
    children: e,
    shouldGrowContainer: a
}) {
    return s.jsx("div", {
        className: I({
            "flex max-w-full flex-col": !0,
            "flex-grow": a
        }),
        children: s.jsx(ns, {
            name: "GroupedMessages",
            fallback: ga,
            children: e
        })
    })
}
export {
    ba as C, F as T, qt as a, Ca as b, Sa as g
};
//# sourceMappingURL=m1vqqb108216sh4q.js.map