const __vite__mapDeps = (i, m = __vite__mapDeps, d = (m.f || (m.f = ["assets/il494lu9aixbt0ds.js", "assets/mna1wiucqak6lqzp.js", "assets/lwme42j7zzyr3q7j.js", "assets/bq4rrqi54riy5k2e.js", "assets/root-ey6kd8gf.css", "assets/conversation-small-fu0y35oi.css", "assets/nfk9kd0ic4ezhu1o.js", "assets/br2bcbrev1rtjwjr.js", "assets/i5xoqodqw3uq8x2c.js", "assets/cxz91putlw7pmfk2.js", "assets/ivmslo5piqpot98f.js", "assets/o11fo8c7vh4pckgf.js", "assets/nyviq03ca6m2usa2.js", "assets/h88qamfv10wkp88v.js", "assets/fl41y0is7h6g0gxe.js", "assets/ixqmo96wk3bini88.js", "assets/m89x2zftpo6hrypr.js", "assets/m0wlwtibo8yb2c2h.js", "assets/niyc1j17i1iogjjg.js", "assets/hx3p6g5v1c632c0c.js", "assets/nc7lfqrltu2fqkst.js", "assets/g77ymanjjcustcw3.js", "assets/nmr5d79kmws977p2.js", "assets/m44xlxtgozicne9l.js", "assets/mudxqzvnzrr4lh0z.js", "assets/m3b3wk7x0ejaq5a6.js", "assets/oqh7hur52tf42g0a.js", "assets/m1vqqb108216sh4q.js", "assets/ld626s1jynzsi9nc.js", "assets/kwbqv9yr0idp2qh5.js", "assets/myqg7g7mzr2o7vpk.js", "assets/l3fgg12n4wcqbxtx.js", "assets/cw8u45029jb64qaj.js", "assets/jw6sc4xdk4t84xqm.js", "assets/cpk7efinoraevon9.js", "assets/itn5nsb38f5hxryr.js", "assets/dezjogalgkr4n852.js", "assets/ef49bv6zx1dh47uf.js", "assets/feoa0h9f66d56whq.js", "assets/bnmzmikiaefr3trh.js", "assets/ouycf512rfb59aed.js", "assets/8l9bhaul3xuw3f7c.js", "assets/oiyz7fhepy88tj1j.js", "assets/oxy1s8uq0laen0z6.js", "assets/dryl4ixhgg2bg6zd.js", "assets/bv6c1pz8mio3xeyw.js", "assets/hv7cti4u7pxnx0pn.js", "assets/mvxxu7w01wzdblxk.js", "assets/c6cor4zkeemka9d2.js", "assets/h2oyt3pweoc9pbt3.js", "assets/etiy9jq7h5niuuok.js", "assets/csho1v5a5zmkk18o.js", "assets/hxae11fvkt7vlxfl.js", "assets/dsaom19zfjj0srcy.js", "assets/eb49pd689ujtjrdz.js", "assets/keftiaw7giaegob5.js", "assets/bv651m6o5w8299nr.js", "assets/ogxdbwcg9nriprtc.js", "assets/o0hg3f6p430sj9e8.js", "assets/sec85tgb7vkty17r.js", "assets/fzrn137102spawew.js", "assets/e9lafxuzyeh4418f.js", "assets/eqjyr70wex3y5gfz.js", "assets/mi93vnc3bxzyhv3q.js", "assets/ff3dg9pqimxn5e3g.js", "assets/k51twjs4ydazxehs.js", "assets/etush0ni5l4oh0km.js"]))) => i.map(i => d[i]);
import {
    S as De,
    a0 as de,
    B as K,
    ak as bs,
    dl as Yn,
    gI as Vl,
    gJ as $l,
    hl as Yl,
    er as Kl,
    hm as Ql,
    ci as js,
    en as ma,
    b_ as mt,
    P as F,
    r as et,
    hn as mn,
    a as B,
    dt as Cs,
    bs as Ue,
    N as hn,
    cx as ha,
    cp as lo,
    d as N,
    ho as mr,
    hp as Kn,
    a6 as he,
    T as Jl,
    w as Ne,
    y as Qt,
    hq as Xl,
    aa as Ae,
    k as gt,
    bu as pn,
    a2 as Pt,
    hr,
    aN as pa,
    g as Zl,
    s as ec,
    e6 as jt,
    L as qt,
    bz as ze,
    bA as Ge,
    h as Wn,
    bl as Qn,
    bM as co,
    dq as uo,
    av as ht,
    z as rt,
    a8 as tc,
    ab as Be,
    E as ss,
    cQ as sc,
    cO as nc,
    bZ as pr,
    ds as gr,
    e9 as fr,
    bY as ie,
    cj as at,
    cI as oc,
    cn as ga,
    f as ac,
    eB as rc,
    aB as xr,
    U as It,
    hs as ic,
    ht as fa,
    hu as lc,
    g5 as mo,
    cE as xa,
    cb as Js,
    f_ as cc,
    fZ as dc,
    bJ as uc,
    l as St,
    hv as mc,
    x as hc,
    hw as pc,
    hx as gc,
    e8 as fc,
    d4 as xc,
    D as tn,
    as as gn,
    fz as vc,
    fd as yc,
    aI as Sc,
    fA as bc,
    fB as ho,
    W as po,
    hy as go,
    V as fo,
    gc as xo,
    aK as jc,
    cv as Jt,
    Q as vr,
    cC as Cc,
    aL as va,
    Y as Vt,
    Z as Xt,
    n as Et,
    bm as yr,
    aD as wc,
    cq as kc,
    hz as Tc,
    cz as Mc,
    e3 as sn,
    fn as _c,
    aM as Nc,
    e4 as nn,
    bj as Ws,
    aH as vs,
    aJ as Sr,
    $ as Ac,
    aq as br,
    a1 as Ec,
    c1 as Rc,
    eE as Pc,
    ex as Ic,
    M as Fc,
    bL as Bc,
    c0 as Dc,
    a4 as Lc,
    dV as Hc,
    bw as Oc,
    eA as Uc,
    bv as jr,
    hA as zc,
    hB as Gc,
    gk as Wc
} from "./bq4rrqi54riy5k2e.js";
import {
    c as ce,
    r as i,
    j as e,
    ax as Ze,
    av as q,
    d as Cr,
    M as E,
    L as on,
    b8 as qc,
    b5 as ya,
    R as vo,
    h as Vc,
    a as wr,
    w as $c,
    v as Yc,
    b9 as Kc,
    b3 as Qc,
    b0 as Sa
} from "./mna1wiucqak6lqzp.js";
import {
    u as Jc
} from "./m0wlwtibo8yb2c2h.js";
import {
    S as Xc,
    k as Zc,
    l as ed,
    m as td,
    n as fn,
    s as sd,
    o as nd,
    p as qs,
    q as od,
    r as ad,
    j as xn,
    C as kr,
    u as Tr,
    t as rd,
    e as id
} from "./niyc1j17i1iogjjg.js";
import {
    e8 as bt,
    qh as ld,
    qi as cd,
    qj as dd,
    qk as ud,
    pO as md,
    ql as hd,
    qm as pd,
    dL as gd,
    U as an,
    x as Xe,
    fe as vn,
    ba as fd,
    qn as pt,
    l as xd,
    lS as Mr,
    G as yo,
    bl as vd,
    qo as _r,
    qp as So,
    iP as ba,
    b$ as ws,
    qq as rn,
    c4 as Rt,
    mv as ln,
    qr as bo,
    qs as jo,
    dC as yn,
    c0 as Nr,
    c1 as Ar,
    iM as Er,
    iL as Rr,
    iN as Pr,
    iO as Ir,
    iR as yd,
    qt as Sd,
    bZ as Co,
    c2 as Xs,
    c3 as bd,
    p as Ft,
    gX as jd,
    qu as Cd,
    qv as wd,
    fr as kd,
    ck as Td,
    a1 as ks,
    d5 as wo,
    hB as Md,
    dX as _d,
    fo as Nd,
    qw as Ad,
    qx as Ed,
    qy as Fr,
    gy as $,
    qz as Rd,
    qA as Pd,
    w as st,
    bN as Id,
    qB as ko,
    qC as $t,
    iI as Fd,
    gD as Yt,
    qD as Br,
    qE as Dr,
    gw as Le,
    qF as Ce,
    hb as Lr,
    kW as Hr,
    kZ as Or,
    dR as Bd,
    B as To,
    fI as Dd,
    kV as Ld,
    qG as Ur,
    eg as Hd,
    qH as Od,
    qI as Zt,
    kM as zr,
    qJ as U,
    qK as Gr,
    qL as Ud,
    qM as zd,
    qN as Gd,
    qO as Wd,
    qP as qd,
    qQ as Vd,
    qR as $d,
    qS as Yd,
    qT as Kd,
    qU as Qd,
    qV as Jd,
    qW as Xd,
    qX as Zd,
    bs as eu,
    qY as tu,
    qZ as su,
    q_ as nu,
    q$ as ou,
    r0 as au,
    r1 as ru,
    r2 as iu,
    r3 as lu,
    r4 as cu,
    r5 as du,
    r6 as uu,
    r7 as mu,
    r8 as hu,
    r9 as pu,
    ra as gu,
    rb as fu,
    rc as Wr,
    jf as xu,
    rd as cn,
    cj as vu,
    fE as yu,
    o$ as ja,
    re as Ca,
    y as Sn,
    rf as qr,
    rg as xs,
    rh as Su,
    ri as bu,
    je as dn,
    rj as Vr,
    rk as ju,
    rl as Cu,
    rm as wa,
    rn as wu,
    ro as ku,
    iJ as Tu,
    rp as Mu,
    rq as _u,
    rr as Nu,
    W as $r,
    fz as Au,
    gS as Yr,
    rs as Vs,
    rt as Eu,
    oO as Ru,
    gA as Pu,
    hl as Kr,
    ru as Iu,
    rv as Fu,
    rw as Bu,
    rx as Du,
    ry as Lu,
    rz as Hu,
    rA as Ou,
    ai as Qr,
    rB as Uu,
    rC as Mo,
    rD as zu,
    hf as Jr,
    hg as Xr,
    rE as Gu,
    he as Wu,
    rF as qu,
    rG as Vu,
    rH as $u,
    rI as Yu,
    hd as Zr,
    rJ as ei,
    rK as Ku,
    h8 as Qu,
    iy as _o,
    rL as No,
    rM as Ju,
    f_ as yt,
    bX as bn,
    dD as ti,
    gx as Ao,
    $ as Ts,
    rN as Xu,
    rO as si,
    rP as Eo,
    rQ as Zu,
    rR as em,
    rS as tm,
    hq as ka,
    i2 as ni,
    it as Ro,
    rT as Ta,
    ej as sm,
    rU as nm,
    h_ as om,
    rV as am,
    rW as rm,
    rX as im,
    i7 as lm,
    bz as Jn,
    rY as cm,
    z as Po,
    j7 as Io,
    rZ as dm,
    jb as um,
    ds as mm,
    r_ as hm,
    r$ as pm,
    s0 as gm,
    s1 as fm,
    s2 as xm,
    n1 as vm,
    s3 as ym,
    s4 as Sm,
    s5 as bm,
    pA as jm,
    n4 as Cm,
    s6 as wm,
    s7 as km,
    fP as Tm,
    s8 as Mm,
    dG as _m,
    dH as Nm,
    s9 as Am,
    sa as Em,
    fQ as Rm,
    l4 as Pm,
    fR as Im,
    ec as Fm,
    sb as Bm,
    sc as Dm,
    sd as oi,
    j9 as Lm,
    iZ as es,
    gE as ts,
    M as Hm,
    hD as Om,
    gC as Um,
    se as Xn,
    e as ai,
    lT as Ms,
    sf as ri,
    sg as Ma,
    sh as ii,
    si as zm,
    og as Gm,
    gz as Wm,
    sj as qm,
    kK as li,
    gB as Vm,
    sk as $m,
    sl as Ym,
    g0 as Fo,
    sm as Zs,
    j0 as Km,
    a6 as Qm,
    r as _a,
    sn as ci,
    fU as Jm,
    ad as Xm,
    d9 as Zm,
    ae as eh,
    ao as di,
    b_ as Bo,
    so as ui,
    mU as th,
    jS as sh,
    cY as nh,
    u as oh,
    sp as ah,
    fw as rh,
    J as ih,
    I as lh,
    sq as ch,
    g9 as Zn,
    f6 as dh,
    sr as mi,
    ss as Na,
    st as uh,
    i5 as un,
    su as mh,
    sv as hh,
    sw as $s,
    sx as ph,
    g1 as gh,
    g2 as fh,
    e7 as en,
    dI as xh,
    cF as hi,
    cG as pi,
    em as vh,
    gJ as yh,
    gL as Sh,
    cO as bh,
    sy as jh,
    sz as Do,
    hV as Ch,
    cP as gi,
    sA as wh,
    eb as kh,
    sB as Th,
    sC as Mh,
    sD as _h,
    dm as Nh,
    i4 as Ah,
    co as Eh,
    sE as Rh,
    sF as Ph,
    cQ as Ih,
    sG as Fh,
    sH as Bh,
    sI as eo,
    sJ as Dh,
    sK as Lh,
    dr as Hh,
    jx as Oh,
    l1 as Uh,
    l2 as zh,
    l0 as Gh,
    sL as Wh,
    hG as qh,
    sM as Vh,
    lM as $h,
    lO as Yh,
    N as Kh,
    dc as Qh,
    kn as Jh,
    ko as Xh,
    lR as Zh,
    ee as ep,
    sN as tp,
    lN as sp,
    nC as np,
    lL as op,
    dg as ap,
    kN as rp,
    sO as ip,
    lP as lp,
    cw as cp,
    cx as dp,
    sP as up,
    m_ as mp,
    lQ as hp,
    sQ as pp,
    al as gp
} from "./lwme42j7zzyr3q7j.js";
import {
    a as fi,
    m as Ss,
    c as xi,
    d as fp,
    u as xp
} from "./nc7lfqrltu2fqkst.js";
import {
    a as jn,
    u as Cn,
    e as vi,
    b as wn,
    f as vp,
    t as to,
    c as yi,
    h as Si,
    i as kn,
    j as yp,
    k as Aa,
    l as Sp,
    s as bp,
    m as jp,
    P as Cp
} from "./cxz91putlw7pmfk2.js";
import {
    u as wp,
    c as kp,
    g as Tp,
    d as Mp
} from "./g77ymanjjcustcw3.js";
import {
    G as Lo,
    a as _p
} from "./nmr5d79kmws977p2.js";
import {
    S as _s
} from "./m44xlxtgozicne9l.js";
import {
    S as Np,
    u as Tn,
    G as Ap,
    L as Ep,
    a as Rp
} from "./mudxqzvnzrr4lh0z.js";
import "./hx3p6g5v1c632c0c.js";
import {
    B as Pp
} from "./oqh7hur52tf42g0a.js";
import {
    C as so,
    g as Ip
} from "./m1vqqb108216sh4q.js";
import {
    N as Fp
} from "./ld626s1jynzsi9nc.js";

function Bp({
    usage: t
}) {
    const s = {
            work: {
                icon: ud,
                color: "#35AE47"
            },
            school: {
                icon: md,
                color: "#E937D1"
            },
            personalTasks: {
                icon: hd,
                color: "#EA8444"
            },
            funAndEntertainment: {
                icon: pd,
                color: "#6C71FF"
            },
            justCurious: {
                icon: gd,
                color: "#FFCC00"
            }
        },
        o = s[t].icon,
        n = s[t].color;
    return e.jsx(o, {
        className: "icon-md",
        style: {
            color: n
        }
    })
}

function Dp({
    clientThreadId: t
}) {
    const s = ce(),
        o = fi({
            clientThreadId: t
        });
    return i.useEffect(() => {
        De.logEvent("chatgpt_convo_onboarding_usage_chips_shown")
    }, []), e.jsx(Ze, {
        mode: "wait",
        children: e.jsx(q.div, {
            className: "mx-[-2.125rem] mt-2 flex flex-wrap gap-2 px-[2.125rem]",
            initial: {
                opacity: 0
            },
            animate: {
                opacity: 1,
                transition: {
                    delay: .2,
                    ease: "easeInOut"
                }
            },
            exit: {
                opacity: 0,
                transition: {
                    ease: "easeInOut"
                }
            },
            children: ["school", "work", "personalTasks", "funAndEntertainment", "justCurious"].map(n => e.jsxs("button", {
                className: "inline-flex h-[42px] items-center justify-start gap-2 rounded-[25px] border border-token-border-light bg-token-main-surface-primary px-4 py-3 hover:bg-token-main-surface-secondary",
                onClick: a => {
                    o({
                        sourceEvent: a,
                        stepPrompt: s.formatMessage(Ss[`${n}Prompt`]),
                        messageMetadata: {
                            onboarding: {
                                main_usages: [{
                                    usage: n
                                }]
                            },
                            is_starter_prompt: !0,
                            suggestion_type: bt.Starter
                        }
                    }), De.logEvent("chatgpt_convo_onboarding_usage_chip_clicked", null, {
                        usage: n
                    })
                },
                children: [e.jsx("div", {
                    "data-svg-wrapper": !0,
                    className: "relative",
                    children: e.jsx(Bp, {
                        usage: n
                    })
                }), e.jsx("div", {
                    className: "font-['SF Pro'] text-[13px] font-normal leading-[18px] text-token-text-primary opacity-90",
                    children: s.formatMessage(Ss[n])
                })]
            }, n))
        })
    })
}

function Lp({
    clientThreadId: t,
    examples: s
}) {
    const o = fi({
            clientThreadId: t
        }),
        n = [ld, cd, dd],
        a = ce();
    return i.useEffect(() => {
        De.logEvent("chatgpt_convo_onboarding_examples_shown")
    }, []), e.jsx(Ze, {
        mode: "wait",
        children: e.jsxs("div", {
            children: [e.jsx(q.p, {
                initial: {
                    opacity: 0
                },
                animate: {
                    opacity: 1
                },
                transition: {
                    duration: .3,
                    ease: "easeInOut"
                },
                className: "text-base text-token-text-primary",
                children: a.formatMessage(Ss.tryAnExample)
            }), e.jsx("ul", {
                className: "mx-[-2.125rem] flex list-none flex-nowrap gap-6 overflow-auto px-[2.125rem] py-4",
                children: s.map((r, l) => e.jsx(q.li, {
                    initial: {
                        opacity: 0,
                        y: 10
                    },
                    animate: {
                        opacity: 1,
                        y: 0
                    },
                    transition: {
                        delay: (l + 1) * .2,
                        duration: .3
                    },
                    children: e.jsxs("button", {
                        className: "inline-flex h-60 w-[222px] flex-col items-center justify-start overflow-hidden rounded-2xl bg-token-main-surface-primary outline outline-token-border-xlight transition-all duration-300 hover:shadow-lg hover:shadow-token-border-light",
                        onClick: d => {
                            o({
                                sourceEvent: d,
                                stepPrompt: r.example,
                                messageMetadata: {
                                    onboarding: {
                                        triggered_tools: [r.feature]
                                    },
                                    is_starter_prompt: !0,
                                    suggestion_type: bt.Starter
                                }
                            }), De.logEvent("chatgpt_convo_onboarding_example_clicked", null, {
                                tool: r.feature
                            })
                        },
                        children: [e.jsx("img", {
                            src: n[l % n.length].src,
                            className: "h-[160px] w-full object-cover",
                            alt: a.formatMessage({
                                id: "chatgpt.new-onboarding.example-prompt",
                                defaultMessage: "Example prompt"
                            })
                        }), e.jsx("div", {
                            className: "inline-flex h-20 w-full gap-1 p-4",
                            children: e.jsx("div", {
                                className: "line-clamp-2 shrink grow basis-0 text-start text-base leading-normal text-token-text-primary",
                                title: r.title,
                                children: r.title
                            })
                        })]
                    })
                }, r.feature))
            })]
        })
    })
}

function Hp({
    clientThreadId: t,
    children: s
}) {
    const {
        isEligible: o,
        markAsViewed: n
    } = xi(t), a = ce();
    return i.useEffect(() => {
        o && an.showAnnouncementTooltipExclusively(Xe.hasSeenFilePickerNuxTooltip, !0)
    }, [o]), o ? e.jsx(vn, {
        announcementKey: Xe.hasSeenFilePickerNuxTooltip,
        show: !0,
        side: "top",
        align: "start",
        theme: "bright",
        dismissOnOutsideClick: !0,
        badge: "none",
        title: a.formatMessage(Ss.tryUploadingAFile),
        description: a.formatMessage(Ss.uploadFileExample),
        onDismiss: n,
        sideOffset: 0,
        children: s
    }) : s
}
const bi = ({
        clientThreadId: t,
        rateLimitPopup: s,
        children: o,
        disabled: n,
        highlightTooltip: a = !1,
        disabledReason: r,
        currentModelName: l
    }) => {
        const d = ce(),
            h = de(t, K.getIsNewConversation),
            c = bs(),
            u = f => {
                s != null && f && F.logPopoverHover({
                    type: "rate_limit",
                    location: "file_upload",
                    plan_type: c ? .planType ? ? "unknown"
                })
            },
            m = fd(Yn.signUpButtonText),
            {
                isEligible: p
            } = xi(t),
            g = !!s;
        return e.jsx(e.Fragment, {
            children: g ? e.jsx("div", {
                className: "h-8",
                children: e.jsxs(Vl, {
                    delayDuration: 150,
                    onOpenChange: u,
                    children: [e.jsx($l, {
                        asChild: !0,
                        children: o
                    }), e.jsx(Yl, {
                        children: e.jsx(Kl, {
                            $as: Ql,
                            side: "left",
                            sideOffset: 0,
                            align: "start",
                            alignOffset: -12,
                            className: "max-w-[320px]",
                            children: e.jsx(Op, {
                                isNewConversation: h,
                                rateLimitPopup: s,
                                signUpButtonText: m
                            })
                        })
                    })]
                })
            }) : !n && p ? e.jsx(Hp, {
                clientThreadId: t,
                children: o
            }) : e.jsx(js, {
                sideOffset: 0,
                label: n ? r === pt.ModelNotSupported ? d.formatMessage({
                    id: "pEB4vw",
                    defaultMessage: "Attachments disabled for {modelName}"
                }, {
                    modelName: `${l}`
                }) : r === pt.ThinkModeInUse ? d.formatMessage({
                    id: "NRk4QL",
                    defaultMessage: "Attachments disabled for Reason mode"
                }) : r === pt.SearchModeInUse ? d.formatMessage({
                    id: "YlO80p",
                    defaultMessage: "Attachments disabled for Search mode"
                }) : d.formatMessage({
                    id: "9Wgi7B",
                    defaultMessage: "Attach files is unavailable"
                }) : d.formatMessage({
                    id: "wkpQmi",
                    defaultMessage: "Upload files and more"
                }),
                className: "flex",
                open: a ? !0 : void 0,
                side: "bottom",
                children: o
            })
        })
    },
    Op = ({
        isNewConversation: t = !1,
        rateLimitPopup: s,
        signUpButtonText: o
    }) => {
        const n = bs(),
            a = Cr(),
            r = xd(),
            l = Mr(),
            d = yo();
        if (s == null) return null;
        const {
            call_to_action: h,
            description: c
        } = s, u = c || e.jsx(E, { ...Ea.defaultDescription
        }), m = h ? .includes(ma.GET_PLUS), p = h ? .includes(ma.AUTHENTICATE), g = p && d;
        return e.jsxs("div", {
            className: "p-2 text-sm text-token-text-primary",
            children: [e.jsx("div", {
                className: "mb-3",
                children: u
            }), m ? e.jsx(mt, {
                size: "small",
                color: "secondary",
                onClick: () => {
                    vd(a, "Rate limited file upload popover"), F.logRateLimitGetPlusButtonClicked({
                        type: "file_upload",
                        location: "popover",
                        plan_type: n ? .planType ? ? "unknown",
                        is_hard_block: !1,
                        is_new_conversation: t,
                        hard_block_reason: ""
                    })
                },
                children: e.jsx(E, { ...Ea.getPlus
                })
            }) : null, p ? e.jsx(mt, {
                size: "small",
                color: "primary",
                onClick: () => {
                    r({
                        authType: l ? "login" : "signup",
                        callback: f => {
                            l ? F.logLogInButtonClicked({
                                location: "File picker rate limit tooltip",
                                provider: f
                            }) : F.logSignUpButtonClicked({
                                location: "File picker rate limit tooltip",
                                provider: f
                            })
                        }
                    })
                },
                children: l ? e.jsx(E, { ...Yn.logInButtonText
                }) : e.jsx(E, { ...o
                })
            }) : null, g ? e.jsx(mt, {
                size: "small",
                color: "secondary",
                className: "ml-2",
                onClick: () => {
                    r({
                        authType: l ? "signup" : "login",
                        callback: f => {
                            l ? F.logSignUpButtonClicked({
                                location: "File picker rate limit tooltip",
                                provider: f
                            }) : F.logLogInButtonClicked({
                                location: "File picker rate limit tooltip",
                                provider: f
                            })
                        }
                    })
                },
                children: l ? e.jsx(E, { ...o
                }) : e.jsx(E, { ...Yn.logInButtonText
                })
            }) : null]
        })
    },
    Ea = et({
        defaultDescription: {
            id: "U5qAWP",
            defaultMessage: "You've reached your daily upload limit. Get ChatGPT Plus to unlock more."
        },
        getPlus: {
            id: "TeyLcp",
            defaultMessage: "Get Plus"
        }
    });

function Up({
    clientThreadId: t,
    getInputProps: s,
    openFileDialog: o,
    uploadType: n,
    icon: a,
    isDisabled: r = !1,
    isSmall: l = !1,
    showLabel: d = !1,
    showUpsell: h = !1,
    hideBorder: c = !1,
    highlightTooltip: u = !1,
    disabledReason: m,
    currentModelName: p
}) {
    const g = ce(),
        f = mn();
    r = (r || !!f) && !h;
    const x = e.jsxs(_r, {
            disabled: r,
            $showLabel: d,
            $hideBorder: c,
            $isSmall: l,
            onClick: M => {
                if (M.preventDefault(), h) {
                    F.logNoAuthAttachButtonClicked({
                        location: "No auth upsell"
                    });
                    return
                }
                F.logEvent(B.openFileViewer, {
                    intent: n.toString()
                }), o()
            },
            "aria-label": r ? m === pt.ModelNotSupported ? g.formatMessage({
                id: "pEB4vw",
                defaultMessage: "Attachments disabled for {modelName}"
            }, {
                modelName: `${p}`
            }) : m === pt.ThinkModeInUse ? g.formatMessage({
                id: "NRk4QL",
                defaultMessage: "Attachments disabled for Reason mode"
            }) : m === pt.SearchModeInUse ? g.formatMessage({
                id: "YlO80p",
                defaultMessage: "Attachments disabled for Search mode"
            }) : g.formatMessage({
                id: "PromptFilePicker.attachFilesUnavailable",
                defaultMessage: "Attach files is unavailable"
            }) : g.formatMessage({
                id: "PromptFilePicker.attachFiles",
                defaultMessage: "Upload files and more"
            }),
            children: [a, d && e.jsx("span", {
                className: "whitespace-nowrap pr-1 [display:--force-hide-label]",
                children: g.formatMessage({
                    id: "PromptFilePicker.attachFilesLabel",
                    defaultMessage: "Attach"
                })
            })]
        }),
        b = e.jsx("input", {
            disabled: r,
            ...s({
                className: "hidden"
            })
        }),
        S = e.jsxs("div", {
            className: "flex",
            children: [x, b]
        });
    return h ? e.jsx(js, {
        sideOffset: 0,
        label: e.jsx(E, {
            id: "wkpQmi",
            defaultMessage: "Upload files and more"
        }),
        side: "bottom",
        open: u || void 0,
        children: e.jsx(Cs, {
            triggerButton: S,
            sideOffset: 0,
            alignOffset: 0,
            children: e.jsx(So, {
                location: "attach",
                statsig_login_event: "chatgpt_composer_upsell_login_button_clicked",
                statsig_signup_event: "chatgpt_composer_upsell_signup_button_clicked"
            })
        })
    }) : e.jsx(bi, {
        disabled: r,
        clientThreadId: t,
        rateLimitPopup: f,
        highlightTooltip: u,
        children: S
    })
}

function zp({
    code: t,
    message: s
}) {
    switch (t) {
        case ba.FileTooLarge:
            return Ra.errorFileTooLarge;
        case ba.TooManyFiles:
            return F.logEvent(B.uploadedMaxFilesError), Ra.errorTooManyFiles;
        default:
            return s
    }
}
const Ra = et({
        attachImages: {
            id: "PromptFilePicker.attachImages",
            defaultMessage: "Attach images"
        },
        attachFiles: {
            id: "PromptFilePicker.attachFiles",
            defaultMessage: "Upload files and more"
        },
        errorFileTooLarge: {
            id: "PromptFilePicker.errorFileTooLarge",
            defaultMessage: "Your file is too large. The maximum file size is {size}MB."
        },
        errorTooManyFiles: {
            id: "PromptFilePicker.errorTooManyFiles",
            defaultMessage: "You may only upload {maxNum} files at a time."
        },
        defaultFileUploadRateLimited: {
            id: "U5qAWP",
            defaultMessage: "You've reached your daily upload limit. Get ChatGPT Plus to unlock more."
        },
        getPlusButton: {
            id: "TeyLcp",
            defaultMessage: "Get Plus"
        }
    }),
    Pa = et({
        dragInstructions: {
            id: "FileDropZone.dragInstructions",
            defaultMessage: "Add anything"
        },
        dragAllAccepted: {
            id: "FileDropZone.dragAllAccepted",
            defaultMessage: "Drop any file here to add it to the conversation"
        }
    });

function Gp(t) {
    if (!t.accept || Object.keys(t.accept).length === 0) return [];
    const s = [];
    return Object.values(t.accept).forEach(o => s.push(...o)), s.sort()
}

function Wp(t) {
    const {
        className: s,
        children: o,
        clientThreadId: n,
        currentModelConfig: a,
        noKeyboard: r
    } = t, l = ce(), d = hn(), h = ws(n), c = rn(a, h), u = c !== Rt.None, m = ln(k => k.files), p = (c === Rt.Multimodal ? bo : jo) - m.length, g = p <= 0, {
        getGizmoId: f
    } = yn(), {
        handleFileAccepted: x
    } = Ci(l, rn(a, h), Ar(a, h), "drag", f, Nr(a, h) ? .attachments), b = mn(), S = Er(Rr(a, h)), {
        getRootProps: M,
        isDragActive: w
    } = Pr({
        maxFiles: p,
        disabled: !u || g || b != null,
        noClick: !0,
        noKeyboard: r,
        onDropAccepted: x,
        onDropRejected: k => ji(k, l, d, c),
        multiple: !0,
        maxSize: Ir,
        ...S
    }), R = Gp(S);
    return e.jsxs("div", { ...M({
            className: s
        }),
        children: [o, w && e.jsxs(qp, {
            children: [e.jsx(yd, {}), e.jsx("h3", {
                children: e.jsx(E, { ...Pa.dragInstructions
                })
            }), e.jsx("h4", {
                className: "w-2/3 text-center",
                children: R.length > 0 ? R.join(", ") : e.jsx(E, { ...Pa.dragAllAccepted
                })
            })]
        })]
    })
}

function ji(t, s, o, n) {
    const {
        errors: a
    } = t[0];
    a.forEach(r => {
        const l = zp(r);
        typeof l == "string" ? o.danger(l, {
            hasCloseButton: !0
        }) : o.danger(s.formatMessage(l, {
            size: Sd,
            maxNum: n === Rt.Multimodal ? bo : jo
        }), {
            hasCloseButton: !0
        })
    })
}

function Ci(t, s, o, n, a, r) {
    const l = hn(),
        d = Co();
    return {
        handleFileAccepted: i.useCallback(async (c, u) => {
            F.logEvent(B.uploadFile, {
                client: "web",
                eventSource: n,
                intent: s.toString()
            });
            const m = a != null ? await a() : void 0;
            c.length > 0 && c.forEach(p => {
                Xs.uploadFile(d, bd(p), p, s, o, t, l, {
                    gizmoId: m
                }, r)
            })
        }, [n, s, a, d, o, t, l, r])
    }
}
const qp = Ue.div `absolute inset-0 opacity-80 flex gap-2 flex-col justify-center items-center bg-token-main-surface-primary text-token-text-primary`,
    Ia = Ue.div `m-8 flex flex-col items-center`;

function Fa(t) {
    return e.jsx(q.div, {
        initial: {
            opacity: 0,
            translateY: 20
        },
        animate: {
            opacity: 1,
            translateY: 0,
            transition: {
                duration: .5,
                ease: "easeIn"
            }
        },
        ...t
    })
}

function Vp({
    clientThreadId: t
}) {
    const o = de(t, a => a ? .promptGptRating) ? .gizmoId,
        {
            data: n
        } = Ft(o);
    return o == null || n == null || !jd(n) ? null : e.jsx($p, {
        gizmoId: o
    })
}

function $p({
    gizmoId: t
}) {
    const [s, o] = i.useState(!1), [n, a] = i.useState(!1), r = Cd(t), l = async h => {
        o(!0), setTimeout(() => {
            a(!0)
        }, 5e3), F.logEvent(B.submitInlineRating, {
            gizmo_id: t,
            rating: h
        }), await r.mutateAsync({
            rating: h
        })
    }, d = async () => {
        a(!0), F.logEvent(B.dismissInlineRating, {
            gizmo_id: t
        }), await r.mutateAsync({})
    };
    return i.useEffect(() => {
        n || F.logEvent(B.showInlineRating, {
            gizmo_id: t
        })
    }, [n, t]), n ? null : s ? e.jsx(Ia, {
        children: e.jsxs(Fa, {
            className: "flex flex-col items-center gap-4",
            children: [e.jsx("div", {
                className: "rounded-lg border border-token-border-heavy p-4",
                children: e.jsxs("div", {
                    className: "flex justify-between gap-2",
                    children: [e.jsx(E, {
                        id: "gizmo.inlineReview.reviewLeft",
                        defaultMessage: "Feedback sent"
                    }), e.jsx(ha, {
                        onClick: () => {
                            a(!0)
                        }
                    })]
                })
            }), e.jsx("div", {
                className: "text-xs text-token-text-tertiary",
                children: e.jsx(E, {
                    id: "gizmo.inlineReview.reviewLeftSubtext",
                    defaultMessage: 'To update your rating, click "Send Feedback" in the GPT Menu'
                })
            })]
        })
    }) : e.jsx(Ia, {
        children: e.jsxs(Fa, {
            className: "flex flex-col items-center gap-4 rounded-lg border border-token-border-heavy p-4",
            children: [e.jsxs("div", {
                className: "flex justify-between gap-2",
                children: [e.jsx(E, {
                    id: "gizmo.inlineReview.prompt",
                    defaultMessage: "How would you rate this GPT so far?"
                }), e.jsx(ha, {
                    onClick: d
                })]
            }), e.jsx(wd, {
                rating: void 0,
                onRating: l
            })]
        })
    })
}
const wi = Ue.div `group flex h-10 items-center gap-2 rounded-lg px-2 hover:bg-token-main-surface-secondary text-sm text-token-text-primary`;

function Yp() {
    const {
        data: t,
        isLoading: s
    } = Nd({
        cutId: "recent",
        limit: 8
    }), {
        data: o,
        isLoading: n
    } = Ad();
    return {
        isLoading: s || n,
        recent: t,
        pinned: o
    }
}

function Kp({
    query: t,
    onSelectGizmo: s,
    selectedIdx: o
}, n) {
    const a = kd(),
        r = i.useRef([]),
        {
            isLoading: l,
            recent: d,
            pinned: h
        } = Yp();
    i.useImperativeHandle(n, () => ({
        handleEnterOnIndex: m => {
            if (!u[m]) return m < c.length ? c[m].resource : "create"
        },
        getResultsLength: () => c.length + 1,
        scrollToItem: m => {
            const p = r.current[m];
            p && p.scrollIntoView({
                behavior: "instant",
                block: "nearest"
            })
        }
    }));
    let c = [];
    if (l) return e.jsx("div", {
        className: "absolute right-4 top-0 flex h-full items-center justify-center",
        children: e.jsx(lo, {})
    });
    d && c.push(...d.pages.flatMap(m => m.list.items).map(m => ({
        resource: m.resource,
        from: "recent"
    }))), h && c.push(...h.items.map(m => ({
        resource: m,
        from: "pinned"
    }))), c = Td(c, m => m.resource.gizmo.id);
    const u = c.map(m => m.resource.gizmo.tags ? .includes(ks.WorkspaceDisabled));
    return t && t !== "" && (c = c.filter(m => (m.resource.gizmo.display.name.toLowerCase() + m.resource.gizmo.display.description ? .toLowerCase() + m.resource.gizmo.author.display_name ? .toLowerCase()).includes(t ? .toLowerCase()))), e.jsxs("div", {
        className: "max-h-40 overflow-y-auto",
        children: [c.map((m, p) => e.jsx("div", {
            ref: g => {
                r.current[p] = g
            },
            tabIndex: p,
            onClick: () => {
                u[p] || s(m.resource)
            },
            children: e.jsx(eg, {
                gizmoResource: m.resource,
                from: m.from,
                showDescription: a,
                isSelected: o === p,
                grayedOut: u[p]
            })
        }, m.resource.gizmo.id)), e.jsx("div", {
            ref: m => {
                r.current[c.length] = m
            },
            tabIndex: c.length,
            onClick: () => {
                s("create")
            },
            children: e.jsx(Jp, {
                isSelected: o === c.length
            })
        }, "create")]
    })
}
const Qp = i.forwardRef(Kp),
    Jp = ({
        isSelected: t
    }) => e.jsx(wi, {
        className: t ? "bg-token-main-surface-secondary" : "",
        children: e.jsxs(on, {
            to: "/gpts/editor",
            target: "_blank",
            className: "flex flex-row space-x-2 font-semibold",
            children: [e.jsx("span", {
                className: "self-center",
                children: e.jsx(wo, {
                    className: "icon-sm"
                })
            }), e.jsx("span", {
                children: e.jsx(E, { ...ki.dropdownCreateLabel
                })
            })]
        })
    }),
    Xp = ({
        onClick: t,
        onClose: s
    }) => {
        const [o, n] = i.useState(null), a = i.useRef(null), r = i.useRef(null), [l, d] = i.useState(0), h = ce(), c = u => {
            F.logEvent(B.mentionsClickGizmo, {
                gizmo_id: u === "create" ? "create" : u.gizmo.id
            }), u !== "create" && t(u)
        };
        return e.jsxs(e.Fragment, {
            children: [e.jsx("input", {
                autoFocus: !0,
                placeholder: h.formatMessage(ki.searchPlaceholder),
                ref: a,
                onKeyDown: u => {
                    if (u.nativeEvent.isComposing) return;
                    const m = r.current ? .getResultsLength() ? ? 0;
                    if ((u.key === "Escape" || u.key === "Backspace" && !o) && (u.preventDefault(), s()), u.key === "Enter" || u.key === "Tab") {
                        u.preventDefault();
                        const p = r.current ? .handleEnterOnIndex(l);
                        if (!p) return;
                        p === "create" ? (window.open("/gpts/editor", "_blank"), s()) : c(p)
                    }
                    if (u.key === "ArrowDown" && l < m - 1) {
                        u.preventDefault();
                        const p = l + 1;
                        r.current ? .scrollToItem(p), d(p)
                    }
                    if (u.key === "ArrowUp" && l > 0) {
                        u.preventDefault();
                        const p = l - 1;
                        r.current ? .scrollToItem(p), d(p)
                    }
                },
                onChange: u => {
                    n(u.target.value), d(0)
                },
                className: "w-full border-0 bg-token-main-surface-primary p-2 text-sm focus:outline-none"
            }), e.jsx(Qp, {
                ref: r,
                query: o,
                selectedIdx: l,
                onSelectGizmo: c
            })]
        })
    },
    Zp = ({
        onClick: t,
        onClose: s
    }) => {
        const o = mr(),
            n = !!o;
        return Ed(() => {
            F.logEvent(B.mentionsOpened, {
                gizmo_selector_disabled: n
            })
        }), n ? e.jsx(Fr, {
            clientThreadId: Kn,
            rateLimitInfo: o
        }) : e.jsx("div", {
            onBlur: a => {
                a.currentTarget.contains(a.relatedTarget) || s()
            },
            className: "popover rounded-2xl border border-token-border-light bg-token-main-surface-primary p-2 shadow-lg",
            children: e.jsx(Xp, {
                onClick: t,
                onClose: s
            })
        })
    };

function eg({
    gizmoResource: t,
    from: s,
    showDescription: o,
    isSelected: n,
    grayedOut: a
}) {
    const r = !!t.gizmo.tags ? .includes(ks.FirstParty);
    return e.jsxs(wi, {
        className: N(n ? "bg-token-main-surface-secondary" : "", a && "opacity-50"),
        children: [e.jsx(Lo, {
            isFirstParty: r,
            src: t.gizmo.display.profile_picture_url,
            className: N("icon-xl h-7 w-7 flex-shrink-0", a && "grayscale group-hover:grayscale-0")
        }), e.jsxs("div", {
            className: "flex h-fit grow flex-row justify-between space-x-2 overflow-hidden text-ellipsis whitespace-nowrap",
            children: [e.jsxs("div", {
                className: "flex flex-row space-x-2",
                children: [e.jsx("span", {
                    className: "shrink-0 truncate font-semibold",
                    children: t.gizmo.display.name
                }), o && e.jsx("span", {
                    className: "flex-grow truncate text-sm text-token-text-tertiary sm:max-w-xs lg:max-w-md",
                    children: t.gizmo.display.description
                })]
            }), e.jsx("span", {
                className: "shrink-0 self-center",
                children: s === "recent" ? e.jsx(Md, {
                    className: "icon-sm"
                }) : e.jsx(_d, {
                    className: "icon-sm"
                })
            })]
        })]
    })
}
const ki = et({
    talkingTo: {
        id: "TaggingDropdown.talkingTo",
        defaultMessage: "Talking to"
    },
    dropdownCreateLabel: {
        id: "TaggingDropdown.dropdownCreateLabel",
        defaultMessage: "Create a GPT"
    },
    searchPlaceholder: {
        id: "TaggingDropdown.searchPlaceholder",
        defaultMessage: "Search recent and pinned GPTs"
    }
});

function Ti() {
    const {
        value: t
    } = he("1166240779");
    return t
}

function tg(t) {
    const s = Ti(),
        n = jn().has($.Research),
        r = de(t, d => K.getConversationTurns(d).at(-1) ? .messages.at(-1)) ? .message.author.name === Jl.CLARIFY_WITH_TEXT;
    return {
        lastMessageIsClarifyWithText: r,
        isBigBoxModeActive: s && n && !r
    }
}

function Ho(t) {
    const s = de(t, K.getConversationTurns),
        o = !1,
        n = Cn().has($.Research),
        a = Ti(),
        r = s.filter(c => c.role === Ne.User),
        l = Qt(r),
        d = r.length > 1 ? r[r.length - 2] : null,
        h = r.some(c => c.messages.some(u => u.message.metadata ? .system_hints ? .includes($.Research)));
    if (!n || !a) return "disabled";
    if (s.length === 0 || !h) return "initial";
    if (l ? .messages.some(c => c.message.metadata ? .system_hints ? .includes($.Research))) {
        const c = s.findIndex(m => m === l);
        return s.filter((m, p) => p > c && m.messages.some(g => g.message.metadata ? .b1de6e2_rm)).length > 0 ? "recurrent" : d ? .messages.some(m => m.message.metadata ? .system_hints ? .includes($.Research)) || o ? "running" : "clarify"
    }
    return "recurrent"
}
const sg = {
    p: t => {
        const {
            node: s,
            children: o,
            ...n
        } = t;
        return e.jsx("p", { ...n,
            className: "text-start !text-sm !leading-6 text-white",
            children: o
        })
    },
    a: t => {
        const {
            node: s,
            children: o,
            ...n
        } = t;
        return e.jsx("a", { ...n,
            className: "!text-sm !leading-6 !text-white !underline",
            children: o
        })
    }
};

function ng(t) {
    const s = ko(),
        o = st(t);
    return !o.isLoading && o.eligible && !s
}

function Mi(t, s) {
    const o = Rd(),
        n = Pd(),
        a = vi(s);
    return ng(t) && !o && !a && !n
}

function _i(t, s) {
    const o = st(t.announcementKey);
    return e.jsx(vn, {
        announcementKey: t.announcementKey,
        side: "top",
        show: !0,
        theme: "bright",
        dismissOnOutsideClick: !0,
        badge: "new",
        title: t.nuxTitle,
        onDismiss: o.markAsViewed,
        sideOffset: 0,
        className: "!max-w-2xs xs:!max-w-sm",
        description: e.jsx(Id, {
            componentOverrides: sg,
            children: t.nuxDescription
        }),
        children: e.jsx("div", {
            children: s
        })
    })
}

function Ni(t) {
    const s = Cn(),
        o = t.useState(a => a.getSystemHints()[0]);
    return s.size ? s.values().next().value : o
}

function Ai(t, s) {
    const {
        clearAllSystemHintModeTriggers: o,
        setThreadSystemHintMode: n
    } = wn(), {
        value: a
    } = Ae("1325692000");
    return i.useCallback(({
        hint: r,
        enable: l
    }) => {
        o();
        const d = !!r.composerBarButtonInfo;
        l ? d || a ? (n(r.systemHint, !0, {
            clientThreadId: s
        }), t.removeSystemHints()) : (t.addSystemHint(r.systemHint, r.name), setTimeout(() => {
            t.focus()
        }, 0)) : t.removeSystemHints()
    }, [o, t, n, s, a])
}
const og = {
    [$.Research]: Xl.DEEP_RESEARCH
};

function ag(t) {
    return og[t] ? ? null
}

function rg(t, s) {
    return new Date(t).toLocaleDateString(s, {
        month: "long",
        day: "numeric"
    })
}
const Ei = new Map([
    [$.Think, {
        hover: [B.composerThinkButtonHovered, "composer_think_button_hovered"],
        enable: [B.composerThinkButtonEnabled, "composer_think_button_enabled"],
        disable: [B.composerThinkButtonDisabled, "composer_think_button_disabled"]
    }],
    [$.Research, {
        hover: [B.composerResearchButtonHovered, "composer_research_button_hovered"],
        enable: [B.composerResearchButtonEnabled, "composer_research_button_enabled"],
        disable: [B.composerResearchButtonDisabled, "composer_research_button_disabled"]
    }]
]);

function Ri({
    systemHint: t,
    logo: s,
    isPinnedActive: o = !1,
    isDisabled: n = !1,
    composerController: a,
    analyticsMetadata: r,
    onClick: l,
    showLabel: d = !1
}) {
    const {
        name: h,
        systemHint: c
    } = t, u = c, {
        setThreadSystemHintMode: m,
        clearAllSystemHintModeTriggers: p
    } = wn(), g = vi(u), f = !!t.composerBarButtonInfo ? .upsell, x = vp.useStore(), [b, S] = i.useState(!1), {
        value: M
    } = Ae("2454940646"), w = qc(), R = n || o, k = jn(), V = [$.Search, $.Think].includes(u);
    i.useEffect(() => {
        n && k.has(u) && m(u, !1, r)
    }, [n, u, r, m, k, V]);
    const C = !n && g,
        j = e.jsxs("button", {
            className: N("flex h-9 min-w-8 items-center justify-center rounded-full border p-2 text-[13px] font-medium radix-state-open:bg-black/10", {
                "duration-75 motion-safe:transition-all": b,
                "text-token-text-secondary": !g && !o,
                "border-transparent bg-[#DAEEFF] text-blue-1000 can-hover:hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:can-hover:hover:bg-[#1A416A]": !!C || o,
                "border-token-border-light focus-visible:outline-black can-hover:hover:bg-token-main-surface-secondary dark:focus-visible:outline-white dark:can-hover:hover:bg-gray-700": !o && !C,
                "opacity-30": n && !o,
                "opacity-50": o
            }),
            "aria-pressed": g,
            "aria-label": h,
            disabled: R,
            onTransitionEnd: () => S(!1),
            onClick: T => {
                if (T.stopPropagation(), T.preventDefault(), f && u !== $.Search) return;
                S(!0);
                let P = !0;
                M && V && (x.getState().persistedSystemHints.has($.Search) || x.getState().persistedSystemHints.has($.Think)) && (P = !1), P && p(), m(u, !g, r), g || (a.removeSystemHints(), a.focus());
                const {
                    enable: _,
                    disable: H
                } = Ei.get(u) ? ? {}, [I, Q] = (g ? H : _) ? ? [];
                I && Q && F.logEventWithStatsig(I, Q, r), l ? .(T)
            },
            children: [s, d && e.jsx("div", {
                className: "whitespace-nowrap pl-1 pr-1 [display:--force-hide-label]",
                children: h
            }), e.jsx(Ze, {
                children: !d && g && e.jsx(q.span, {
                    initial: {
                        x: -10,
                        width: 0,
                        opacity: 0
                    },
                    animate: {
                        x: 0,
                        width: "fit-content",
                        opacity: 1
                    },
                    exit: {
                        x: -10,
                        width: 0,
                        opacity: 0
                    },
                    transition: {
                        ease: "easeOut",
                        duration: w ? 0 : .15
                    },
                    children: e.jsx("div", {
                        className: "whitespace-nowrap pl-1 pr-2 [display:--force-hide-label]",
                        children: h
                    })
                })
            })]
        });
    return f ? e.jsx(Cs, {
        triggerButton: j,
        sideOffset: 0,
        alignOffset: 0,
        children: e.jsx(So, {
            location: u,
            statsig_login_event: "chatgpt_composer_upsell_login_button_clicked",
            statsig_signup_event: "chatgpt_composer_upsell_signup_button_clicked"
        })
    }) : j
}

function ig({
    composerController: t,
    systemHint: s,
    composerBarButtonInfo: o,
    isDisabled: n,
    clientThreadId: a,
    showLabel: r,
    isPinnedActive: l,
    currentModelName: d,
    disabledReason: h,
    rateLimitProgress: c
}) {
    const u = {
        clientThreadId: a
    };
    return e.jsx(lg, {
        composerBarButtonInfo: o,
        isDisabled: n,
        isPinnedActive: l,
        analyticsMetadata: u,
        systemHint: s.systemHint,
        currentModelName: d,
        disabledReason: h,
        rateLimitProgress: c,
        children: e.jsx(Ri, {
            isDisabled: n,
            isPinnedActive: l,
            systemHint: s,
            logo: e.jsx(_s, {
                svgString: s.logo,
                className: "h-[18px] w-[18px]"
            }),
            composerController: t,
            analyticsMetadata: u,
            showLabel: r
        })
    })
}

function lg({
    children: t,
    isDisabled: s,
    isPinnedActive: o,
    systemHint: n,
    composerBarButtonInfo: a,
    analyticsMetadata: r,
    currentModelName: l,
    disabledReason: d,
    rateLimitProgress: h
}) {
    const c = Mi(a.announcementKey, n),
        u = _i(a, t),
        m = ce();
    let p;
    return h && h.remaining ? p = e.jsx(cg, {
        remaining: h.remaining,
        reset_date: h.reset_after,
        text: a.tooltipText
    }) : p = e.jsx(Pi, {
        text: a.tooltipText
    }), c ? u : e.jsx("div", {
        children: e.jsx(js, {
            sideOffset: 0,
            label: s ? d === $t.HasAttachedFiles ? m.formatMessage({
                id: "z7E1Px",
                defaultMessage: "Reason disabled for attachments"
            }) : d === $t.DeepResearchHighLoad ? m.formatMessage({
                id: "UrDtrS",
                defaultMessage: "Deep research is temporarily unavailable"
            }) : d === $t.RateLimitReached ? a.rateLimitReachedText : a.disabledText : o ? m.formatMessage({
                id: "gFCsls",
                defaultMessage: "You've selected a thinking model {modelName}"
            }, {
                modelName: `(${l})`
            }) : p,
            side: "bottom",
            onOpenChange: g => {
                if (g) {
                    const {
                        hover: f
                    } = Ei.get(n) ? ? {}, [x, b] = f ? ? [];
                    x && b && F.logEventWithStatsig(x, b, r)
                }
            },
            children: t
        })
    })
}

function Ba({
    logo: t,
    onClick: s,
    showLabel: o,
    label: n,
    showRemoveIcon: a = !1
}) {
    return e.jsxs("button", {
        type: "button",
        className: "flex h-9 items-center gap-2 overflow-hidden rounded-full border border-transparent bg-[#DAEEFF] px-2 text-blue-1000 focus-visible:outline-black can-hover:hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:focus-visible:outline-white dark:can-hover:hover:bg-[#1A416A]",
        "aria-label": o ? void 0 : n,
        onClick: s,
        children: [e.jsxs("div", {
            className: "flex h-full items-center justify-center text-[13px] font-semibold",
            children: [t, o && e.jsx("div", {
                className: "pl-1 [display:--force-hide-label]",
                children: n
            })]
        }), a && e.jsx("div", {
            className: "flex h-full items-center justify-center",
            children: e.jsx(Fd, {
                className: "h-[16px] w-[16px] text-blue-1000 dark:text-[#48AAFF]"
            })
        })]
    })
}
const Pi = ({
        text: t
    }) => e.jsx("span", {
        children: t
    }),
    cg = ({
        remaining: t,
        reset_date: s,
        text: o
    }) => {
        const {
            locale: n
        } = ce(), a = rg(s, n);
        return e.jsxs("div", {
            className: "text-left",
            children: [e.jsx("span", {
                className: "block text-xs font-semibold text-token-text-tertiary",
                children: e.jsx(E, {
                    id: "PromptTextarea.systemHintTooltip.remaining",
                    defaultMessage: "{remaining} available until {resetDate}",
                    values: {
                        remaining: t,
                        resetDate: a
                    }
                })
            }), e.jsx(Pi, {
                text: o
            })]
        })
    },
    Ys = {
        initial: {
            opacity: 0,
            y: 20,
            scale: .9
        },
        animate: {
            opacity: 1,
            y: 0,
            scale: 1
        },
        transition: {
            delay: .1
        },
        exit: {
            opacity: 0,
            scale: .5,
            transition: {
                duration: .2
            }
        }
    },
    dg = ({
        suggestions: t,
        onSelectingSuggestedReply: s
    }) => e.jsx("div", {
        className: "absolute bottom-full flex w-full max-w-[100vw] grow gap-2 overflow-auto px-1 pb-1 contain-inline-size sm:mb-0 sm:justify-start sm:px-2 sm:pb-0 md:static md:mb-2 md:max-w-none md:justify-center md:overflow-visible",
        children: t.slice(0, 2).map((o, n) => e.jsx(q.div, {
            initial: Ys.initial,
            animate: Ys.animate,
            transition: {
                delay: (n - 1) * Ys.transition.delay
            },
            exit: Ys.exit,
            children: e.jsx(mt, {
                as: "button",
                color: "secondary",
                size: "small",
                onClick: a => {
                    s(a, o, t, n)
                },
                className: "group whitespace-nowrap md:whitespace-normal",
                children: e.jsx(mg, {
                    suggestion: o
                })
            }, n)
        }, n))
    });

function ug({
    suggestions: t,
    onSelectingSuggestedReply: s,
    clientThreadId: o
}) {
    const n = t ? .length > 0;
    i.useEffect(() => {
        n && Yt(t, o)
    }, [n, o]);
    const {
        isUnauthenticated: a
    } = gt();
    return n ? t.every(Br) ? e.jsxs(q.div, {
        initial: {
            opacity: 0
        },
        animate: {
            opacity: 1
        },
        transition: {
            duration: .3
        },
        className: "flex flex-col items-center",
        children: [a && e.jsx(pn, {
            className: "mb-6 h-12 w-12 sm:hidden"
        }), e.jsx(Np, {
            starterPrompts: t,
            onSelectStarterPrompt: s
        })]
    }) : t.every(Dr) ? e.jsx(dg, {
        suggestions: t,
        onSelectingSuggestedReply: s
    }) : null : null
}

function mg({
    suggestion: t
}) {
    return Dr(t) ? e.jsx(e.Fragment, {
        children: t.text
    }) : Br(t) ? e.jsxs("div", {
        className: "flex flex-col overflow-hidden",
        children: [t.title && e.jsx("div", {
            className: "truncate font-semibold",
            children: t.title
        }), e.jsx("div", {
            className: N("truncate font-normal", t.title ? "opacity-50" : ""),
            children: t.body
        })]
    }) : null
}

function hg() {
    const {
        store: t
    } = Le(), s = t.useSharedProps();
    return s ? e.jsx(pg, { ...s
    }) : null
}

function pg({
    clientThreadId: t,
    suggestions: s
}) {
    const o = Tn();
    return s === void 0 || s.length === 0 ? null : e.jsx("div", {
        children: e.jsx(gg, {
            children: e.jsx("div", {
                className: "grow",
                children: s !== void 0 && e.jsx(ug, {
                    suggestions: s,
                    onSelectingSuggestedReply: o,
                    clientThreadId: t
                })
            })
        })
    })
}
const gg = Ue.div `h-full flex ml-1 md:w-full md:m-auto gap-0 md:gap-2 justify-center`,
    Ii = ({
        className: t,
        children: s
    }) => e.jsx(q.div, {
        className: t,
        initial: {
            opacity: 0
        },
        animate: {
            opacity: 1
        },
        exit: {
            opacity: 0,
            transition: {
                duration: .1,
                delay: 0
            }
        },
        transition: {
            type: "tween",
            duration: .3,
            delay: .2
        },
        children: s
    });

function fg({
    canContinue: t,
    onContinueGenerating: s
}) {
    const o = i.useCallback(a => {
        s(a), to()
    }, [s]);
    let n = null;
    return t && (n = e.jsx(vg, {
        onHandleContinueGenerating: o
    })), n && e.jsx("div", {
        className: "flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",
        children: n
    })
}

function xg({
    className: t
}) {
    return e.jsx(Lr, {
        className: N("-rotate-180", t)
    })
}
const vg = ({
        onHandleContinueGenerating: t
    }) => e.jsx(Ii, {
        children: e.jsx(mt, {
            as: "button",
            color: "secondary",
            onClick: t,
            className: "whitespace-nowrap py-2",
            icon: xg,
            size: "small",
            children: e.jsx(E, { ...Ce.continueGenerating
            })
        })
    }),
    yg = ({
        clientThreadId: t
    }) => {
        const s = hr(),
            o = de(t, K.getRequestId),
            n = Pt(o);
        i.useEffect(() => {
            n && pa.dismissBanner()
        }, [n]);
        const a = s ? .is_dismissible ? () => pa.dismissBanner() : void 0;
        return e.jsx(Ze, {
            children: s && e.jsx(q.div, {
                transition: {
                    type: "tween",
                    ease: "easeInOut",
                    duration: .1
                },
                initial: {
                    opacity: 0,
                    transform: "translateY(8px)"
                },
                animate: {
                    opacity: 1,
                    transform: "translateY(0px)"
                },
                exit: {
                    opacity: 0,
                    transform: "translateY(8px)"
                },
                children: e.jsx(Fr, {
                    clientThreadId: t,
                    rateLimitInfo: s,
                    onDismiss: a
                })
            })
        })
    };

function Sg(t) {
    const s = de(t, K.getRequestId),
        o = Pt(s),
        n = hr();
    return !o && n != null
}
const no = window.sessionStorage,
    oo = Zl(ec(() => ({
        memoryFullBannerDismissed: !!no ? .getItem(qt.MemoryFullBannerDismissed)
    }))),
    Fi = {
        dismissBanner() {
            oo.setState(t => {
                t.memoryFullBannerDismissed = !0
            }), no ? .setItem(qt.MemoryFullBannerDismissed, "true")
        },
        clearDismissedBanner() {
            oo.setState(t => {
                t.memoryFullBannerDismissed = !1
            }), no ? .removeItem(qt.MemoryFullBannerDismissed)
        }
    };

function bg(t) {
    const s = jt(t),
        o = Hr(),
        {
            data: n
        } = Or(s, !1, o),
        a = n != null,
        r = a && n.memoryFullPct >= 100,
        [l, d] = i.useState(!1);
    i.useEffect(() => {
        !r && a && (d(!0), Fi.clearDismissedBanner())
    }, [r, a]);
    const h = oo(c => c.memoryFullBannerDismissed);
    return r && l && !h
}

function jg() {
    const t = ce(),
        {
            openSettings: s
        } = Bd();
    return e.jsx(q.div, {
        initial: {
            opacity: 0
        },
        animate: {
            opacity: 1
        },
        children: e.jsx(To, {
            title: t.formatMessage(Ks.memoryFullTitle),
            content: t.formatMessage(Ks.memoryFullTooltip, Ks.memoryFullTooltip.values),
            primaryCtaText: t.formatMessage(Ks.memoryManageButton),
            onPrimaryCtaClick: () => s(Dd.Personalization),
            onDismiss: () => Fi.dismissBanner()
        })
    })
}
const Ks = et({
        memoryFullTitle: {
            id: "yRGU2/",
            defaultMessage: "Memory is full."
        },
        memoryManageButton: {
            id: "a5A88o",
            defaultMessage: "Manage"
        },
        memoryFullTooltip: {
            id: "neUc+N",
            defaultMessage: "New memories won’t be created until you make space. <a>Learn more</a>",
            values: {
                a: t => e.jsx("a", {
                    href: Ld,
                    target: "_blank",
                    rel: "noopener noreferrer",
                    className: "underline",
                    children: t
                })
            }
        }
    }),
    Oo = Xe.hasSeenMemoryInSearch;

function Cg() {
    const t = Cr();
    i.useEffect(() => {
        F.logEventWithStatsig(B.chatgptMemoryInSearchAnnouncementShown, "chatgpt_memory_in_search_announcement_shown")
    }, []);
    const {
        markAsViewed: s
    } = st(Oo), o = i.useCallback(() => {
        F.logEventWithStatsig(B.chatgptMemoryInSearchAnnouncementClosed, "chatgpt_memory_in_search_announcement_closed"), s()
    }, [s]), n = i.useCallback(() => {
        F.logEventWithStatsig(B.chatgptMemoryInSearchAnnouncementCTAClicked, "chatgpt_memory_in_search_announcement_cta_clicked"), t("#settings/Personalization"), s()
    }, [s, t]);
    return e.jsx(To, {
        onPrimaryCtaClick: n,
        primaryCtaText: e.jsx(E, {
            id: "8MwdJw",
            defaultMessage: "Settings"
        }),
        onDismiss: o,
        content: e.jsxs("div", {
            className: "flex-grow",
            children: [e.jsx("div", {
                className: "mb-0.5 font-semibold",
                children: e.jsx(E, {
                    id: "Sdp8JT",
                    defaultMessage: "Search, now with memory"
                })
            }), e.jsx("span", {
                className: "text-token-text-secondary",
                children: e.jsx(E, {
                    id: "a4czFu",
                    defaultMessage: "ChatGPT can now use memories to shape searches it sends to search providers, to give you more relevant answers. You can turn this off at any time in settings. {learnMoreLink}",
                    values: {
                        learnMoreLink: e.jsx("a", {
                            href: "https://help.openai.com/en/articles/9237897-chatgpt-search",
                            target: "_blank",
                            rel: "noopener noreferrer",
                            className: "underline",
                            children: e.jsx(E, {
                                id: "JMsjZT",
                                defaultMessage: "Learn more"
                            })
                        }, "learn-more-link")
                    }
                })
            })]
        })
    })
}

function Bi() {
    const t = st(Oo),
        {
            userIsInSearchHoldoutWithWebDisabled: s
        } = yi();
    return t.eligible && !t.isLoading && !s
}

function wg() {
    const {
        markAsViewed: t,
        eligible: s
    } = st(Oo);
    return s ? t : void 0
}
const kg = () => {
        const {
            shouldShowSkipButton: t
        } = Ur();
        return t ? e.jsx(Ii, {
            className: "flex justify-center",
            children: e.jsx(mt, {
                as: "button",
                color: "secondary",
                onClick: () => Hd.skipParagen(),
                children: e.jsx(E, { ...Tg.skip
                })
            })
        }) : null
    },
    Tg = et({
        skip: {
            id: "dvcUbp",
            defaultMessage: "Skip"
        }
    }),
    Mg = ze(() => Ge(() =>
        import ("./il494lu9aixbt0ds.js"), __vite__mapDeps([0, 1, 2, 3, 4, 5, 6, 7])).then(t => t.JawboneNotificationsBanner)),
    Di = i.memo(function({
        className: s
    }) {
        const {
            store: o
        } = Le(), n = o.useIsHeaderContentAreaPopulated();
        return e.jsx("div", {
            className: N(s ? ? "absolute bottom-full left-0 right-0", Ud.PromptTextareaHeader),
            children: e.jsx(Od, {
                shouldRender: n,
                contentArea: Zt.Header,
                children: e.jsxs("div", {
                    className: "mb-2 flex flex-col gap-3.5 pt-2",
                    children: [e.jsx(_g, {}), e.jsx(Ng, {})]
                })
            })
        })
    });

function _g() {
    const {
        store: t
    } = Le(), s = t.useSharedProps(r => r ? .clientThreadId), o = t.useContentAreaId(Zt.HeaderTop), n = zr();
    let a;
    switch (o) {
        case U.ProjectConversationTaskNoFileAccess:
            a = e.jsx(Pg, {});
            break;
        case U.AdvancedVoiceOnMobileAnnouncement:
            a = e.jsx(Qd, {
                clientThreadId: s
            });
            break;
        case U.S09KM1:
            a = null;
            break;
        case U.ParagenControls:
            a = e.jsx(kg, {});
            break;
        case U.ItemActions:
            a = e.jsx(hg, {});
            break;
        case U.BannerSignup:
            a = e.jsx(Rg, {});
            break;
        case U.BannerTermsDisclaimer:
            a = e.jsx(Ig, {});
            break;
        case U.PromptTextareaAction:
            a = e.jsx(Fg, {});
            break;
        case U.BannersRateLimit:
            a = e.jsx(Bg, {});
            break;
        case U.BannerSidekickAnnouncement:
            a = e.jsx(Kd, {});
            break;
        case U.SearchBrowserExtensionAnnouncement:
            a = e.jsx(Zc, {});
            break;
        case U.MemoryInSearchAnnouncement:
            a = e.jsx(Cg, {});
            break;
        case U.MoonshineAnnouncement:
            a = e.jsx(Yd, {});
            break;
        case U.CustomizeChatGPTAnnouncement:
            a = e.jsx($d, {});
            break;
        case U.SearchBrowserExtensionReactiveAnnouncement:
            a = e.jsx(Xc, {});
            break;
        case U.BannerMemoryFull:
            a = e.jsx(jg, {});
            break;
        case U.Box:
            a = e.jsxs("div", {
                className: "flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",
                children: ["box", e.jsxs("div", {
                    className: "flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",
                    children: ["inner", e.jsx("div", {
                        className: "flex h-full w-full items-center justify-center bg-yellow-400 text-center",
                        children: "actual content"
                    })]
                })]
            });
            break;
        case U.JawboneAnnouncement:
            n ? a = e.jsx(Mg, {}) : a = null;
            break;
        case U.JawboneMaxActiveAnnouncement:
            n ? a = e.jsx(Vd, {}) : a = null;
            break;
        case U.PromoRedemptionAnnouncement:
            a = e.jsx(qd, {});
            break;
        case U.OperatorAnnouncement:
            a = e.jsx(Wd, {});
            break;
        case U.BannerPlusUpsell:
            a = e.jsx(Gd, {});
            break;
        case U.ClassmatesPromotionAnnouncement:
            a = e.jsx(zd, {});
            break;
        case U.ReferrerRedemptionAvailableAnnouncement:
            a = null;
            break;
        case U.RefereeRedemptionAvailableAnnouncement:
            a = null;
            break;
        default:
            a = null;
            break
    }
    return a
}

function Ng() {
    const {
        store: t
    } = Le(), s = t.useContentAreaId(Zt.HeaderBottom);
    let o;
    switch (s) {
        case Gr.DallePromptControls:
            o = e.jsx(Eg, {});
            break;
        default:
            o = null;
            break
    }
    return o
}
const Ag = ze(() => Ge(() =>
    import ("./i5xoqodqw3uq8x2c.js"), __vite__mapDeps([8, 1, 3, 4, 2, 5, 9, 10])).then(t => t.default));

function Eg() {
    const {
        store: t
    } = Le(), s = t.useSharedProps(o => o ? .composerController);
    return s ? e.jsx(Ag, {
        composerController: s
    }) : null
}

function Rg() {
    const {
        store: t
    } = Le(), s = t.useSharedProps(a => a ? .clientThreadId), o = Mr(), n = Jd();
    return s ? o ? e.jsx(Xd, {
        threadId: s,
        showSignUp: n
    }) : e.jsx(Zd, {
        threadId: s,
        showLogin: n
    }) : null
}

function Pg() {
    return i.useEffect(() => () => {
        Wn.getItem(qt.TasksHasSeenProjectDisclaimerBanner) || Wn.setItem(qt.TasksHasSeenProjectDisclaimerBanner, !0)
    }, []), e.jsx(To, {
        icon: e.jsx(eu, {}),
        title: e.jsx(E, {
            id: "ibX3g7",
            defaultMessage: "Tasks can’t access project files"
        }),
        content: e.jsx(E, {
            id: "fm94Tm",
            defaultMessage: "There’s a task in this conversation — just FYI, it won’t be able to access project files."
        }),
        onDismiss: () => {
            Wn.setItem(qt.TasksHasSeenProjectDisclaimerBanner, !0)
        }
    })
}

function Ig() {
    const {
        store: t
    } = Le(), s = t.useSharedProps(o => o ? .clientThreadId);
    return s ? e.jsx(tu, {
        threadId: s
    }) : null
}

function Fg() {
    const {
        store: t
    } = Le(), s = t.useSharedProps();
    return s ? e.jsx(fg, { ...s
    }) : null
}

function Bg() {
    const {
        store: t
    } = Le(), s = t.useSharedProps(o => o ? .clientThreadId);
    return s ? e.jsx(yg, {
        clientThreadId: s
    }) : null
}
const Dg = 5,
    Lg = i.memo(function(s) {
        return Hg(s), Og(s), Ug(), null
    });

function Hg(t) {
    const {
        store: s
    } = Le(), o = s.useSetSharedProps();
    Qn(() => {
        o(t)
    }, [t, o])
}

function Og(t) {
    const {
        clientThreadId: s,
        canContinue: o
    } = t, {
        store: n
    } = Le(), a = i.useRef({
        top: n.useContentAreaApi(Zt.HeaderTop),
        bottom: n.useContentAreaApi(Zt.HeaderBottom)
    }).current, r = Wg(t), l = su(s), {
        shouldShowBannerSignup: d,
        shouldShowBannerTermsDisclaimer: h
    } = qg(s), c = Sg(s), u = nu(t), m = ed(t), p = Bi(), g = ko(), f = ou(), x = td(t), b = bg(s), S = au(), M = ru(t), w = iu(s), R = lu(s), k = cu(), {
        eligible: V
    } = st(gu), C = du(), j = uu(), T = de(s, _ => _ ? .modelId), P = ws(s);
    Qn(() => {
        T && P ? .kind === Be.GizmoInteraction && P.gizmo && fu(T, P.gizmo) ? a.top.set(U.ProjectConversationTaskNoFileAccess) : M.eligible ? a.top.set(U.AdvancedVoiceOnMobileAnnouncement) : S ? a.top.set(U.ParagenControls) : h ? a.top.set(U.BannerTermsDisclaimer) : c ? a.top.set(U.BannersRateLimit) : j ? a.top.set(U.BannerPlusUpsell) : w ? a.top.set(U.JawboneAnnouncement) : R ? a.top.set(U.JawboneMaxActiveAnnouncement) : u.eligible ? a.top.set(U.BannerSidekickAnnouncement) : p ? a.top.set(U.MemoryInSearchAnnouncement) : g ? a.top.set(U.MoonshineAnnouncement) : f ? a.top.set(U.CustomizeChatGPTAnnouncement) : m ? a.top.set(U.SearchBrowserExtensionAnnouncement) : x ? a.top.set(U.SearchBrowserExtensionReactiveAnnouncement) : k ? a.top.set(U.PromoRedemptionAnnouncement) : V ? a.top.set(U.OperatorAnnouncement) : C ? a.top.set(U.ClassmatesPromotionAnnouncement) : r ? a.top.set(U.ItemActions) : o ? a.top.set(U.PromptTextareaAction) : d ? a.top.set(U.BannerSignup) : b ? a.top.set(U.BannerMemoryFull) : a.top.set(null)
    }, [a, r, o, h, d, c, u, b, S, M]), Qn(() => {
        l && a.bottom.set(Gr.DallePromptControls)
    }, [a, l])
}

function Ug() {
    const {
        store: t
    } = Le();
    i.useEffect(() => () => {
        t.reset()
    }, [t])
}

function zg(t) {
    const s = Wr(),
        o = co(t),
        n = K.getTree(rt(t)).getLastValidNode(o) ? .message ? .id;
    return s ? .messageId === n ? s.suggestions : []
}

function Gg(t) {
    return zg(t).length > 0
}

function Wg(t) {
    const {
        value: s
    } = he("1887864177"), o = mu(t.clientThreadId), n = Gg(t.clientThreadId);
    return t.isDisabled || s ? !1 : t.isNewThread || o || n
}

function qg(t) {
    const {
        isUnauthenticated: s
    } = gt(), o = co(t), {
        layer: n
    } = uo("3637408529"), {
        layer: a
    } = ht("3637408529"), r = a.get("no_auth_banner_signup_rate_limit", Dg), l = n.get("should_show_no_auth_signup_banner", !0), d = hu(f => f.bannerDisclaimerClientThreadId), h = pu(), c = {
        shouldShowBannerTermsDisclaimer: !1,
        shouldShowBannerSignup: !1
    };
    if (!t) return c;
    const u = K.getTree(rt(t)),
        m = u.countMessagesByAuthor(Ne.User),
        p = u.getNodeByIdOrMessageId(o),
        g = p ? .message ? .author.role === Ne.Assistant && tc(p.message);
    return c.shouldShowBannerTermsDisclaimer = g && s && m === 1 && !h && (d == null || d === t), c.shouldShowBannerSignup = l && g && s && m > 0 && m % r === 0, c
}

function Vg({
    composerController: t,
    isDisabled: s,
    disabledReason: o,
    isPinnedActive: n,
    clientThreadId: a,
    showLabel: r,
    currentModelName: l
}) {
    const d = Si(),
        h = ce(),
        c = i.useMemo(() => ({
            clientThreadId: a
        }), [a]),
        u = i.useCallback(() => {
            F.logEventWithStatsig(B.composerSearchButtonClicked, "composer_search_button_clicked", c), d && t.trimLeadingText(/^search\b/i)
        }, [c, t, d]),
        m = i.useMemo(() => ({
            systemHint: $.Search,
            description: h.formatMessage({
                id: "m/oaZE",
                defaultMessage: "Find on the web"
            }),
            logo: "",
            requiredFeatures: ["search"],
            requiredModels: [],
            requiredConversationModes: [Be.PrimaryAssistant],
            name: h.formatMessage({
                id: "TbHx8d",
                defaultMessage: "Search"
            })
        }), [h]);
    return e.jsx(Yg, {
        analyticsMetadata: c,
        isThreadUsingSearchMode: d,
        isDisabled: s || n,
        disabledReason: o,
        currentModelName: l,
        children: e.jsx(Ri, {
            isDisabled: s || n,
            isPinnedActive: n,
            systemHint: m,
            logo: e.jsx(xu, {
                className: "h-[18px] w-[18px]"
            }),
            composerController: t,
            analyticsMetadata: c,
            onClick: u,
            showLabel: r
        })
    })
}

function $g() {
    const t = Bi(),
        s = ko(),
        o = st(Xe.hasSeenComposerSearchButtonTooltip);
    return !o.isLoading && o.eligible && !t && !s
}

function Yg({
    children: t,
    analyticsMetadata: s,
    isThreadUsingSearchMode: o,
    isDisabled: n,
    disabledReason: a,
    currentModelName: r
}) {
    const l = $g() && !o,
        d = st(Xe.hasSeenComposerSearchButtonTooltip);
    return l ? e.jsx(vn, {
        announcementKey: Xe.hasSeenComposerSearchButtonTooltip,
        side: "right",
        show: !0,
        theme: "bright",
        dismissOnOutsideClick: !0,
        badge: "new",
        title: e.jsx(E, {
            id: "Yjduqi",
            defaultMessage: "Search the web"
        }),
        onDismiss: d.markAsViewed,
        sideOffset: 0,
        className: "!max-w-2xs xs:!max-w-sm",
        description: e.jsx(E, {
            id: "W51Aei",
            defaultMessage: "Get fast answers with trusted sources. {learnMore}",
            values: {
                learnMore: e.jsx(vu, {
                    href: "https://openai.com/index/introducing-chatgpt-search",
                    className: "underline",
                    children: e.jsx(E, {
                        id: "stA7F4",
                        defaultMessage: "Learn more"
                    })
                })
            }
        }),
        children: e.jsx("div", {
            children: t
        })
    }) : e.jsx("div", {
        children: e.jsx(js, {
            sideOffset: 0,
            label: n ? a === cn.ModelNotSupported ? e.jsx(E, {
                id: "GZemJe",
                defaultMessage: "Search disabled for {modelName}",
                values: {
                    modelName: `${r}`
                }
            }) : a === cn.HasAttachedFiles ? e.jsx(E, {
                id: "Wd1fc2",
                defaultMessage: "Search disabled for attachments"
            }) : e.jsx(E, {
                id: "GpDAWD",
                defaultMessage: "Search is unavailable"
            }) : e.jsx(E, {
                id: "c+4o2s",
                defaultMessage: "Search the web"
            }),
            side: "bottom",
            onOpenChange: h => {
                h && F.logEventWithStatsig(B.composerSearchButtonHovered, "composer_search_button_hovered", s)
            },
            children: t
        })
    })
}

function Kg({
    composerController: t,
    clientThreadId: s
}) {
    const o = ss(s),
        n = Cn(),
        {
            setThreadSystemHintMode: a,
            clearAllSystemHintModeTriggers: r
        } = wn(),
        {
            value: l
        } = he("1416952492"),
        {
            value: d
        } = Ae("1325692000"),
        h = kn(s).filter(j => j.systemHint !== $.Think && (j.systemHint !== $.Research || !l) && !j.composerBarButtonInfo ? .upsell),
        [c, u] = i.useState([]),
        [m, p] = i.useState(void 0),
        [g, f] = i.useState(0);
    i.useEffect(() => {
        u(m ? h.filter(j => j.name.toLocaleLowerCase().startsWith(m.text.toLocaleLowerCase()) || j.systemHint.toLocaleLowerCase().startsWith(m.text.toLocaleLowerCase())) : [])
    }, [m]), i.useEffect(() => {
        t.view.dispatch(sd(t.view.state.tr, {
            onHintMatch(j) {
                p(T => gr(T, j) ? T : j)
            }
        }))
    }, [t]);
    const x = !h.length || !c.length || !m;
    i.useEffect(() => {
        x && f(0)
    }, [x]);
    const b = c.length,
        S = i.useCallback(j => {
            f(T => (j(T) % b + b) % b)
        }, [b]),
        M = c[g],
        w = ({
            hintToSave: j = M,
            expectPerfectMatch: T
        }) => {
            if (!m || !M || T && j.name.toLowerCase() !== m.text.toLowerCase()) return !1;
            F.logEvent(B.systemHintSelected, {
                system_hint: j.systemHint,
                conversation_id: o ? ? Kn
            });
            const P = m.range.from === 1 ? j.name : m.text + j.name.slice(m.text.length),
                _ = {
                    clientThreadId: s
                };
            qs(t.view), n.size > 0 && r();
            const H = !!j.composerBarButtonInfo,
                I = j.systemHint === $.Search;
            return d || H || I ? (a(j.systemHint, !0, _, I ? fr.CONVERSATION_COMPOSER_SLASH_SEARCH : void 0), m.range && t.delete(m.range.from, m.range.to), t.removeSystemHints(), !0) : (t.addSystemHint(j.systemHint, P, m.range.from, m.range.to), !0)
        },
        R = i.useRef(w);
    R.current = w;
    const k = i.useRef(S);
    k.current = S;
    const V = i.useRef(m);
    V.current = m;
    const C = t.view;
    return i.useEffect(() => (x || nd(C, j => {
        if (j === "up") k.current(T => T - 1);
        else if (j === "down") k.current(T => T + 1);
        else if (j === "cancel") qs(C), od(C);
        else {
            if (j === "submit") return qs(C), R.current({
                expectPerfectMatch: !1
            });
            if (j === "checkMatch") return R.current({
                expectPerfectMatch: !0
            })
        }
    }), () => qs(C)), [x, C]), i.useEffect(() => {
        x || F.logEvent(B.systemHintListOpened, {
            conversation_id: o ? ? Kn
        })
    }, [x]), x ? null : e.jsx(sc, {
        className: "max-w-60",
        onMouseDown: j => {
            j.preventDefault()
        },
        children: c.map((j, T) => e.jsx("div", {
            onMouseOver: () => f(T),
            onClick: () => {
                w({
                    hintToSave: j,
                    expectPerfectMatch: !1
                }), t.focus()
            },
            children: e.jsx(nc, {
                autoFocus: !1,
                className: "rounded-lg px-1 py-2",
                $spoofHovered: T === g,
                children: e.jsx(Li, {
                    title: j.name,
                    description: j.description,
                    logo: j.logo
                })
            })
        }, j.systemHint))
    })
}

function Li({
    title: t,
    description: s,
    logo: o,
    checked: n
}) {
    return e.jsxs("div", {
        className: "group inline-flex w-full items-center justify-start gap-2 pl-1.5 pr-3",
        children: [e.jsx("div", {
            className: "flex h-7 w-7 items-center justify-center gap-2.5",
            children: e.jsx(_s, {
                svgString: o,
                className: "icon-lg text-token-text-secondary"
            })
        }), e.jsxs("div", {
            className: "shrink grow basis-0",
            children: [e.jsx("p", {
                className: "text-sm font-normal leading-tight text-token-text-primary",
                children: t
            }), !!s && e.jsx("p", {
                className: "text-[13px] font-normal leading-[18px] text-token-text-secondary",
                children: s
            })]
        }), n && e.jsx(pr, {
            className: N("icon-md text-token-text-primary", {
                "group-hover:hidden": !n
            })
        })]
    })
}

function Qg({
    composerController: t,
    clientThreadId: s
}) {
    return t instanceof fn ? e.jsx(Kg, {
        composerController: t,
        clientThreadId: s
    }) : null
}

function Jg({
    children: t,
    className: s,
    showBackground: o
}) {
    return e.jsxs("div", {
        className: "relative",
        children: [t, o && e.jsx(q.div, {
            initial: {
                scale: 0
            },
            animate: {
                scale: 1
            },
            transition: {
                type: "spring",
                stiffness: 260,
                damping: 20
            },
            className: N("pointer-events-none absolute inset-0 rounded-full", s)
        })]
    })
}

function Xg({
    clientThreadId: t,
    icon: s,
    setOpen: o,
    open: n,
    isDisabled: a = !1,
    highlightTooltip: r = !1,
    hideBorder: l = !1,
    isSmall: d = !1,
    disabledReason: h,
    currentModelName: c
}) {
    const u = mn(),
        m = ce();
    return a = a || !!u, e.jsxs(e.Fragment, {
        children: [e.jsx(ie.Trigger, {
            className: "m-0 h-0 w-0 border-none bg-transparent p-0"
        }), e.jsx(bi, {
            clientThreadId: t,
            rateLimitPopup: u,
            highlightTooltip: r,
            disabled: a,
            disabledReason: h,
            currentModelName: c,
            children: e.jsx(_r, {
                disabled: a,
                "aria-disabled": a,
                "aria-label": a ? m.formatMessage({
                    id: "NTwThg",
                    defaultMessage: "Attach files is unavailable"
                }) : m.formatMessage({
                    id: "ixBxc3",
                    defaultMessage: "Upload files and more"
                }),
                onClick: p => {
                    p.preventDefault(), o(!0)
                },
                $open: n,
                $hideBorder: l,
                $isSmall: d,
                children: s
            })
        })]
    })
}

function Hi({
    title: t,
    description: s,
    icon: o,
    checked: n
}) {
    return e.jsxs("div", {
        className: "group inline-flex w-full items-center justify-start gap-3 text-token-content-primary",
        children: [o && e.jsx("div", {
            className: "flex items-center justify-center gap-2.5",
            children: e.jsx(_s, {
                svgString: o,
                className: "icon-md"
            })
        }), e.jsxs("div", {
            className: "shrink grow basis-0",
            children: [e.jsx("p", {
                className: "text-sm font-normal leading-tight",
                children: t
            }), !!s && e.jsx("p", {
                className: "text-xs font-normal text-token-content-secondary",
                children: s
            })]
        }), n ? e.jsx(pr, {
            className: N("icon-md text-token-text-primary", {
                "group-hover:hidden": !n
            })
        }) : null]
    })
}

function Zg({
    onOauthRedirect: t,
    connectors: s,
    isNested: o
}) {
    const n = ce();
    return e.jsxs(ie.Sub, {
        children: [e.jsx(ie.SubMenuTrigger, {
            icon: yu,
            className: N(o && "mx-0 rounded-xl p-1.5 px-2 py-2.5"),
            children: e.jsx(E, { ...ef.oneDriveSubmenuName
            })
        }), e.jsx(ie.Portal, {
            children: e.jsx(ie.SubContent, {
                className: N(o && "flex flex-col justify-start gap-2 p-1.5"),
                children: s.map(a => a ? e.jsx(ie.Item, {
                    onClick: () => t(a),
                    className: N(o && "mx-0 rounded-xl p-1.5 px-2 py-2.5"),
                    children: o ? e.jsx(Hi, {
                        title: ja(a.type, n),
                        description: a.type === at.O365_BUSINESS ? e.jsx(E, { ...Ca.includesSharePoint
                        }) : null
                    }) : e.jsxs("div", {
                        className: "flex flex-col",
                        children: [ja(a.type, n), a.type === at.O365_BUSINESS && e.jsx("div", {
                            className: "text-s text-token-text-tertiary",
                            children: e.jsx(E, { ...Ca.includesSharePoint
                            })
                        })]
                    })
                }, a.id) : null)
            })
        })]
    })
}
const ef = et({
    oneDriveSubmenuName: {
        id: "ContextConnectorPickerOneDriveSubmenu.oneDriveSubmenuName",
        defaultMessage: "Connect to Microsoft OneDrive"
    }
});

function tf() {
    const {
        connectorConfig: t
    } = qr(), s = Sn(), o = $r(), [n, a] = dn(Vr([...t.values()], u => !!u.access_token), u => !!u.access_token), [r, l] = dn(a, u => u.type === at.O365_PERSONAL || u.type === at.O365_BUSINESS), d = !s && !o && n.length > 0, h = !s && !o && !d && r.length > 1;
    return {
        unconnectedConnectors: o ? [] : h ? l : a,
        showUnconnectedInSubmenu: d,
        showOneDriveInSubmenu: h
    }
}

function sf({
    clientThreadId: t,
    icon: s,
    modelAcceptedMimeTypes: o,
    modelSupportedImageMimeTypes: n,
    attachmentsProductFeature: a,
    onOauthRedirect: r,
    uploadType: l,
    getInputProps: d,
    openFileDialog: h,
    isDisabled: c = !1,
    isNested: u = !1,
    highlightTooltip: m = !1,
    showLabel: p,
    isSmall: g = !1,
    hideBorder: f = !1,
    disabledReason: x,
    currentModelName: b
}) {
    const S = oc().locale,
        M = ce(),
        w = hn(),
        R = Co(),
        k = Sn(),
        {
            connectorConfig: V,
            isLoading: C
        } = qr(),
        j = st(Xe.ContextConnectors),
        {
            getGizmoId: T
        } = yn(),
        [P, _] = i.useState();
    i.useEffect(() => {
        T ? T().then(A => _(A)) : _(void 0)
    }, [T]);
    const H = i.useRef(null),
        [I, Q] = i.useState(!1),
        y = i.useRef(!1),
        W = i.useCallback(() => {
            const A = H.current ? .files;
            Array.from(A ? ? []).forEach(re => xs.uploadFile(R, re, n, M, w, a))
        }, [R, n, M, w, a]),
        [ne, D] = i.useState(null),
        Y = i.useCallback(() => D(null), [D]),
        ae = i.useCallback((A, re) => xs.uploadPickedFile(R, A, re, n, o, a, P, M, w), [R, n, o, a, P, M, w]),
        {
            openMenu: L,
            confirmMenuOpened: se
        } = Su();
    i.useEffect(() => {
        L && (Q(!0), se())
    }, [L, se, Q]);
    const oe = i.useCallback(A => {
            xs.doContextConnectorOauthRedirect(location.pathname + location.search + location.hash, A, r, ga.Picker), r()
        }, [r]),
        ye = i.useCallback(A => {
            xs.uploadPickedFile(R, A, at.GDRIVE, n, o, a, P, M, w)
        }, [R, n, o, a, P, M, w]),
        fe = i.useCallback(async A => {
            const {
                access_token: re
            } = A;
            if (!re) {
                oe(A);
                return
            }
            switch (xs.logAttemptIfAccessTokenIsExpired(A, ga.Picker), A.type) {
                case at.GDRIVE:
                    bu(S, A.type, re, ee => ee.forEach(ye));
                    break;
                case at.O365_PERSONAL:
                case at.O365_BUSINESS:
                    D(A.type);
                    break
            }
        }, [ye, oe, D, S]),
        le = () => {
            F.logEvent(B.openFileViewer, {
                intent: l.toString()
            }), h()
        },
        Ee = A => {
            if (!A && y.current && !C) le();
            else if (A && Re && !C) {
                le();
                return
            }
            Q(A), A && (j.eligible && j.markAsViewed(), F.logEvent(B.composerOpenContextConnectorPicker), y.current = !0, setTimeout(() => {
                y.current = !1
            }, 250))
        },
        [Z, xe] = dn(Vr([...V.values()], A => !!A.access_token), A => !!A.access_token);
    nf(Z, fe);
    const [Se] = dn(xe, A => A.type === at.O365_PERSONAL || A.type === at.O365_BUSINESS), {
        unconnectedConnectors: ue,
        showUnconnectedInSubmenu: Me,
        showOneDriveInSubmenu: me
    } = tf(), {
        desktopConnectors: be
    } = ju(n), Re = !Z.length && !ue.length && !be.length, _e = e.jsxs(e.Fragment, {
        children: [Me && ue.length > 0 && e.jsx(Cu, {
            connectorEntries: ue,
            onOauthRedirect: A => oe(A),
            isNested: u
        }), !Me && ue.map(A => e.jsx(wa, {
            entry: A,
            onClick: () => fe(A),
            isNested: u
        }, A.id)), me && e.jsx(Zg, {
            connectors: Se,
            onOauthRedirect: oe,
            isNested: u
        }), C && e.jsx(ie.Item, {
            icon: e.jsx(lo, {
                className: "text-token-text-secondary"
            })
        }), (ue.length > 0 || C) && !u && e.jsx(ie.Separator, {}), Z.map(A => e.jsx(wa, {
            entry: A,
            onClick: () => fe(A),
            isNested: u
        }, A.id)), be.map(A => e.jsx(wu, {
            entry: A,
            isNested: u
        }, A.key)), e.jsx(ku, {
            modelSupportedImageMimeTypes: n
        }), e.jsx(ie.Item, {
            className: N(u && "mx-0 rounded-xl p-1.5 px-2 py-2.5"),
            onClick: le,
            icon: Tu,
            children: e.jsx(E, { ...k ? Da.uploadFileMobile : Da.uploadFile
            })
        }, "upload")]
    }), He = u ? e.jsx("div", {
        className: "relative flex flex-col",
        children: _e
    }) : e.jsxs("div", {
        className: "flex flex-col",
        children: [e.jsx(Mu, {
            type: ne,
            onClose: Y,
            uploadPickedFile: ae
        }), e.jsx("input", {
            onChange: W,
            ...d({
                className: "hidden"
            })
        }), e.jsxs(ie.Root, {
            open: I,
            onOpenChange: Ee,
            children: [e.jsx(Xg, {
                clientThreadId: t,
                icon: s,
                setOpen: Ee,
                open: I,
                isDisabled: c,
                highlightTooltip: m,
                showLabel: p,
                hideBorder: f,
                isSmall: g,
                disabledReason: x,
                currentModelName: b
            }), e.jsx(ie.Portal, {
                children: e.jsx(ie.Content, {
                    alignOffset: -16,
                    side: "top",
                    children: _e
                })
            })]
        }), e.jsx(_u, {
            hasConnectors: !C && !Re
        })]
    });
    return {
        dropdownItems: _e,
        mainComponent: He
    }
}

function nf(t, s) {
    const {
        connector: o,
        clearParam: n
    } = Nu(), a = t.find(r => r.type === o && !!r.access_token);
    i.useEffect(() => {
        a && (s(a), n())
    }, [a, s, n])
}

function of (t) {
    const {
        mainComponent: s
    } = sf(t);
    return s
}
const Da = et({
    attachFiles: {
        id: "ContextConnectorPicker.attachFiles",
        defaultMessage: "Upload files and more"
    },
    uploadFile: {
        id: "LocalFileDropdownItem.uploadFile",
        defaultMessage: "Upload from computer"
    },
    uploadFileMobile: {
        id: "LocalFileDropdownItem.uploadFileMobile",
        defaultMessage: "Upload file"
    }
});

function La({
    clientThreadId: t,
    uploadType: s,
    modelAcceptedMimeTypes: o,
    modelSupportedImageMimeTypes: n,
    attachmentsProductFeature: a,
    getInputProps: r,
    openFileDialog: l,
    onOauthRedirect: d,
    historyDisabled: h,
    isNested: c,
    isDisabled: u,
    highlightTooltip: m,
    disabledReason: p,
    currentModelName: g,
    showLabel: f,
    showUpsell: x,
    hideBorder: b,
    isSmall: S
}) {
    const M = $r(),
        {
            gdriveStatus: w,
            o365Status: R
        } = Au(),
        k = "h-[18px] w-[18px]",
        V = h ? "text-white" : m ? "text-brand-blue-800" : "",
        C = x ? e.jsx(Yr, {
            "aria-label": "",
            className: N(k, V)
        }) : e.jsx(wo, {
            "aria-label": "",
            className: N(k, V)
        }),
        T = (w !== "false" || R !== "false" || M) && !x ? e.jsx( of , {
            hideBorder: b,
            isSmall: S,
            clientThreadId: t,
            icon: C,
            modelAcceptedMimeTypes: o,
            modelSupportedImageMimeTypes: n,
            attachmentsProductFeature: a,
            onOauthRedirect: d,
            uploadType: s,
            openFileDialog: l,
            isNested: c,
            getInputProps: r,
            isDisabled: u,
            highlightTooltip: m,
            disabledReason: p,
            currentModelName: g
        }) : e.jsx(Up, {
            isSmall: S,
            hideBorder: b,
            clientThreadId: t,
            uploadType: s,
            openFileDialog: l,
            getInputProps: r,
            showLabel: f,
            showUpsell: x,
            icon: C,
            isDisabled: u,
            highlightTooltip: m,
            disabledReason: p,
            currentModelName: g
        });
    return c ? T : e.jsx("div", {
        className: "relative",
        children: e.jsx(Jg, {
            showBackground: m,
            className: "bg-brand-blue-800/20",
            children: T
        })
    })
}

function af({
    suggestions: t,
    composerController: s,
    onSelect: o,
    onChange: n
}) {
    const a = Tn(),
        r = i.useCallback((p, g, f, x) => {
            o ? .(g, f, x), a(p, g, f, x)
        }, [o, a]),
        [l, d] = i.useState(() => t.length > 0),
        [h, c] = i.useState(-1),
        [u, m] = i.useState(!1);
    return i.useEffect(() => {
        const p = g => {
            if (!g.isComposing)
                if (g.key === "ArrowDown") {
                    const f = h === t.length - 1 ? 0 : h + 1;
                    c(f), n ? .(f, !0, t[f])
                } else if (g.key === "ArrowUp") {
                g.preventDefault();
                const f = h <= 0 ? t.length - 1 : h - 1;
                c(f), n ? .(f, !0, t[f])
            } else g.key === "Enter" && !g.shiftKey && t[h] && r(g, t[h], t, h)
        };
        return s.subscribe("keydown", p)
    }, [t, h, n, r, s]), i.useEffect(() => s.subscribe("blur", () => {
        c(-1), d(!1), n ? .(-1, !1)
    }), [s, n]), i.useEffect(() => s.subscribe("focus", () => d(!0)), [s]), i.useEffect(() => {
        if (!u) {
            const p = () => {
                m(!0), window.removeEventListener("mousemove", p)
            };
            return window.addEventListener("mousemove", p), () => {
                window.removeEventListener("mousemove", p)
            }
        }
    }, [u]), i.useEffect(() => {
        c(-1), n ? .(-1, !1), m(!1)
    }, [t, n]), e.jsx(q.ul, {
        initial: {
            opacity: 0
        },
        animate: {
            opacity: 1
        },
        exit: {
            opacity: 0
        },
        className: N("w-full flex-col p-2.5 max-lg:flex-col-reverse", l ? "flex" : "hidden"),
        children: t.map((p, g) => e.jsxs(q.li, {
            initial: {
                opacity: 0,
                translateY: 4
            },
            animate: {
                opacity: 1,
                translateY: 0
            },
            transition: {
                delay: g * .03
            },
            exit: {
                opacity: 0,
                translateY: 4
            },
            className: "w-full",
            children: [g > 0 && e.jsx("div", {
                className: N("h-[1px] opacity-60 max-lg:hidden", h === g || h === g - 1 ? "mx-2 bg-token-main-surface-secondary" : "bg-token-border-light")
            }), e.jsxs("button", {
                className: N("flex w-full cursor-pointer items-center justify-start whitespace-pre-wrap rounded-lg px-2.5 py-3 text-start", h === g ? "bg-token-main-surface-secondary" : "bg-token-main-surface-primary"),
                onClick: f => {
                    f.preventDefault(), r(f, p, t, g)
                },
                onMouseDown: f => {
                    f.preventDefault()
                },
                onMouseEnter: () => {
                    u && (c(g), n ? .(g, !1, p))
                },
                onMouseLeave: () => {
                    c(-1), n ? .(-1, !1, p)
                },
                children: [p.icon ? e.jsx("span", {
                    className: "mr-2 h-[18px] w-[18px] text-token-text-secondary",
                    children: p.icon
                }) : null, e.jsx("span", {
                    className: "whitespace-pre-wrap text-sm",
                    children: p.autocompletionChunks && p.autocompletionChunks.length > 0 ? e.jsx(e.Fragment, {
                        children: p.autocompletionChunks.map((f, x) => e.jsx("span", {
                            className: N(f.isMatched ? "text-token-text-tertiary" : "text-token-text-primary"),
                            children: f.text
                        }, x))
                    }) : e.jsxs(e.Fragment, {
                        children: [e.jsx("span", {
                            className: N(p.type === bt.Starter || p.type === bt.Trending ? "text-token-text-secondary" : "text-token-text-tertiary"),
                            children: p.title
                        }), e.jsx("span", {
                            className: "text-token-text-primary",
                            children: p.body
                        })]
                    })
                })]
            }), g > 0 && e.jsx("div", {
                className: N("h-[1px] opacity-60 lg:hidden", h === g || h === g - 1 ? "mx-2 bg-token-main-surface-secondary" : "bg-token-border-light")
            })]
        }, p.id ? ? g))
    })
}

function rf(t, s) {
    t = t.toLocaleLowerCase();
    const o = s;
    s = s.toLocaleLowerCase();
    const n = [];
    let a = 0;
    for (let d = 0; d < s.length && (a < t.length && t[a] === s[d] && (n.push(d), a++), a !== t.length); d++);
    const r = [];
    let l = 0;
    if (n.forEach(d => {
            if (d > l) {
                const h = o.slice(l, d);
                h && r.push({
                    text: h,
                    isMatched: !1
                })
            }
            r.push({
                text: o[d],
                isMatched: !0
            }), l = d + 1
        }), l < s.length) {
        const d = o.slice(l);
        d && r.push({
            text: d,
            isMatched: !1
        })
    }
    return lf(r)
}

function lf(t) {
    if (t.length === 0) return t;
    let s = [t[0]];
    for (let n = 1; n < t.length; n++) {
        const a = s[s.length - 1],
            r = t[n];
        a.isMatched === r.isMatched ? a.text += r.text : s.push(r)
    }
    const o = s.filter(n => n.isMatched).reduce((n, a) => n + a.text.trim().length, 0);
    return s.length <= 4 && o >= 2 ? s : [{
        text: s.map(n => n.text).join(""),
        isMatched: !1
    }]
}
const cf = 350;

function df({
    suggestionData: t,
    composerController: s,
    clientThreadId: o
}) {
    const n = ce(),
        a = Ho(o),
        l = n.formatMessage(Ce.researchSuggestionInitial),
        d = n.formatMessage(Ce.deepResearchPlaceholderBullet1),
        h = n.formatMessage(Ce.deepResearchPlaceholderBullet2),
        c = n.formatMessage(Ce.deepResearchPlaceholderBullet3),
        {
            displayedText: u,
            isStreaming: m
        } = Vs(l, {
            enableStreaming: a !== "disabled"
        }, [s.isEmpty()]),
        p = cf,
        {
            displayedText: g,
            isStreaming: f
        } = Vs(d, {
            startDelay: p,
            enableStreaming: a !== "disabled"
        }),
        {
            displayedText: x,
            isStreaming: b
        } = Vs(h, {
            enableStreaming: !f && a !== "disabled"
        }),
        {
            displayedText: S
        } = Vs(c, {
            enableStreaming: !f && !b && a !== "disabled"
        });
    return e.jsx("div", {
        className: "mb-[8px] mt-[-8px] flex select-none items-start justify-between pl-1 text-token-text-tertiary",
        children: s.isEmpty() ? e.jsxs("ul", {
            className: "list-disc pl-5 text-token-text-tertiary marker:text-token-text-tertiary",
            children: [g && e.jsx("li", {
                children: g
            }), x && e.jsx("li", {
                children: x
            }), S && e.jsx("li", {
                children: S
            })]
        }) : e.jsx("div", {
            className: "relative flex items-center gap-1",
            children: e.jsx("div", {
                className: N(m && "result-streaming", t ? .isLoading && "pulse", "text-token-text-tertiary"),
                children: e.jsx("p", {
                    children: u
                })
            })
        })
    })
}
const Ha = .0025,
    uf = i.forwardRef(function({
        type: s,
        placeholder: o,
        replyRegions: n,
        state: a,
        renderFiles: r,
        leftSideActions: l,
        topRightAction: d,
        onSubmit: h,
        setIsComposerOverflowing: c,
        inputState: u,
        composerController: m,
        clientThreadId: p,
        gizmoId: g,
        disableReason: f,
        controlsDisabled: x,
        setControlsDisabled: b,
        matchaData: S
    }, M) {
        const w = Eu(),
            [R, k] = i.useState(void 0);
        let V = null;
        const {
            isLoading: C
        } = w;
        C || (V = w.modelId);
        const [j, T] = i.useState(300), P = Ru(D => {
            D.contentRect && T(D.contentRect.width)
        });
        i.useEffect(() => {
            C || Pu() || m.focus()
        }, [V, m, C]);
        const {
            value: _
        } = Ae("3780975974"), H = Ho(p), {
            getShowUpsellReason: I
        } = Kr(), Q = _ || I(), y = D => {
            mf({
                target: D.target,
                rootId: "composer-background",
                additonalInteractiveIds: ["reply-regions"]
            }) || m.focus()
        };

        function W(D) {
            if (!(m instanceof fn)) return;
            const Y = m.getSelectionStart();
            b ? .(!1), requestAnimationFrame(() => {
                const {
                    state: ae,
                    dispatch: L
                } = m.view;
                L(ae.tr.insertText(D, Y, Y)), requestAnimationFrame(() => {
                    m.setSelection(Y + D.length)
                })
            })
        }
        const ne = i.useCallback(() => e.jsx(Iu, {
            useStartButtonText: H === "clarify" || !1,
            inputState: u,
            state: a,
            onSubmit: h,
            composerController: m,
            clientThreadId: p,
            gizmoId: g,
            disableReason: f
        }), [u, a, h, m, p, g, f, S, H]);
        return e.jsxs("div", {
            id: "composer-background",
            ref: M,
            className: N("flex w-full cursor-text flex-col rounded-3xl border border-token-border-light px-3 py-1 duration-150 ease-in-out contain-inline-size motion-safe:transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] dark:border-none dark:shadow-none", s !== "temporary" && "shadow-[0_9px_9px_0px_rgba(0,0,0,0.01),_0_2px_5px_0px_rgba(0,0,0,0.06)] has-[:focus]:shadow-[0_2px_12px_0px_rgba(0,0,0,0.04),_0_9px_9px_0px_rgba(0,0,0,0.01),_0_2px_5px_0px_rgba(0,0,0,0.06)]", s !== "temporary" && "bg-token-main-surface-primary dark:bg-[#303030]", s === "temporary" && "dark bg-[#303030]"),
            onClick: y,
            style: {
                viewTransitionName: "var(--vt-composer)"
            },
            children: [e.jsx(Ze, {
                initial: !1,
                children: n.length > 0 && e.jsx(q.div, {
                    initial: {
                        opacity: 0,
                        height: 0
                    },
                    animate: {
                        opacity: 1,
                        height: "auto"
                    },
                    exit: {
                        opacity: 0,
                        height: 0,
                        transition: {
                            duration: .06
                        }
                    },
                    transition: {
                        ease: "easeOut",
                        duration: .1
                    },
                    id: "reply-regions",
                    children: e.jsx("div", {
                        className: "-mx-2",
                        children: e.jsx(Fu, {
                            replyRegions: n
                        })
                    })
                })
            }), e.jsxs(e.Fragment, {
                children: [r, e.jsx(Ze, {
                    initial: !1,
                    children: e.jsxs(q.div, {
                        initial: {
                            minHeight: 0
                        },
                        animate: {
                            minHeight: H === "initial" || H === "recurrent" ? "142px" : 0
                        },
                        exit: {
                            minHeight: 0
                        },
                        transition: {
                            type: "spring",
                            stiffness: 48.7,
                            damping: 13.54,
                            mass: 1
                        },
                        className: N("flex flex-col justify-start"),
                        children: [e.jsxs("div", {
                            className: "flex min-h-[44px] items-start pl-1",
                            ref: P,
                            children: [e.jsx("div", {
                                className: "min-w-0 max-w-full flex-1",
                                children: x ? R ? e.jsx(Bu, {
                                    waveform: R,
                                    containerWidth: j,
                                    scaleFactor: 10,
                                    initialValue: Ha
                                }) : null : e.jsx(ad, {
                                    composerController: m,
                                    placeholder: o
                                })
                            }), e.jsx("div", {
                                className: "w-[32px] pt-1",
                                children: d
                            })]
                        }), (H === "initial" || H === "recurrent") && e.jsx(df, {
                            suggestionData: S,
                            composerController: m,
                            clientThreadId: p
                        })]
                    })
                }), e.jsxs("div", {
                    className: "mb-2 mt-1 flex items-center justify-between sm:mt-5",
                    ref: D => {
                        if (!Q || !("ResizeObserver" in window)) return;
                        let Y = new AbortController,
                            ae = window.innerWidth;
                        const L = Du({
                            axis: "width",
                            debounce: !0,
                            target: D,
                            onChange: () => {
                                if (!D) return;
                                D.scrollWidth > D.clientWidth ? c ? .(!0) : Math.abs(ae - window.innerWidth) > 40 && (c ? .(!1), ae = window.innerWidth)
                            }
                        });
                        return () => {
                            L ? .(), Y.abort()
                        }
                    },
                    children: [e.jsx("div", {
                        className: "flex gap-x-1.5 text-token-text-primary",
                        children: l
                    }), e.jsx("div", {
                        className: "flex gap-x-1.5",
                        children: x ? e.jsx(Lu, {
                            initialValue: Ha,
                            onSuccess: W,
                            onWaveformDataUpdate: k,
                            onExit: () => {
                                b ? .(!1)
                            }
                        }) : e.jsxs(e.Fragment, {
                            children: [e.jsx(Hu, {
                                size: "small",
                                onExit: () => {
                                    b ? .(!0)
                                }
                            }), ne()]
                        })
                    })]
                })]
            })]
        })
    });

function mf({
    target: t,
    rootId: s,
    additonalInteractiveIds: o
}) {
    let n = t;
    for (; n && n != null;) {
        if (n.tagName === "BUTTON" || n.tagName === "INPUT" || n.tagName === "TEXTAREA" || n.isContentEditable || o.includes(n.id)) return !0;
        if (n.id === s) return !1;
        n = n.parentElement
    }
    return !1
}
const Oa = ({
        composerController: t,
        disabled: s,
        clientThreadId: o,
        isComposerV2Mode: n,
        uploadButtons: a,
        showLabel: r,
        showUpsell: l
    }) => {
        const {
            value: d
        } = Ae("1325692000"), h = kn(o).filter(S => S.systemHint === $.Research && (n || d) ? !0 : !S.composerBarButtonInfo && S.systemHint !== $.Search), c = Ni(t), {
            value: u
        } = Ae("3780975974"), m = Ai(t, o), [p, g] = i.useState(!1);
        if (i.useEffect(() => {
                const S = Math.random(),
                    M = setInterval(() => {
                        const w = new Date,
                            R = w.getHours() + w.getMinutes() / 60 + w.getSeconds() / 3600,
                            k = Math.abs((6 + R) % 12 - 6) / 6;
                        g(Math.pow(k, 15) > S)
                    }, 1e3);
                return () => clearInterval(M)
            }, []), !(t instanceof fn) || h.length === 0 && !n) return null;
        const f = {
            clientThreadId: o
        };

        function x() {
            F.logEventWithStatsig(B.composerSystemHintButtonHovered, "composer_system_hint_button_hovered", f)
        }

        function b() {
            F.logEventWithStatsig(B.composerSystemHintButtonClicked, "composer_system_hint_button_clicked", f)
        }
        return e.jsx(hf, {
            systemHints: h,
            selectedHint: c,
            showJack: u ? !1 : p,
            disabled: s,
            isComposerV2Mode: n,
            onHover: x,
            onOpen: b,
            onSelect: m,
            uploadButtons: a,
            showLabel: r,
            showUpsell: l
        })
    },
    hf = ({
        systemHints: t,
        selectedHint: s,
        showJack: o,
        disabled: n,
        isComposerV2Mode: a,
        onHover: r,
        onOpen: l,
        onSelect: d,
        uploadButtons: h,
        showLabel: c,
        showUpsell: u
    }) => {
        const m = ce(),
            [p, g] = i.useState(!1),
            f = t.find(k => k.systemHint === "contextual_answers") ? .name,
            {
                value: x
            } = Ae("3780975974"),
            b = t.length > 0,
            S = !1;
        if (!ac()) return null;
        const w = u ? e.jsx(So, {
                location: "tools",
                statsig_login_event: "chatgpt_composer_upsell_login_button_clicked",
                statsig_signup_event: "chatgpt_composer_upsell_signup_button_clicked"
            }) : e.jsxs(e.Fragment, {
                children: [b && e.jsxs(e.Fragment, {
                    children: [S, t.map(k => e.jsx(ie.Item, {
                        className: N(!a && "px-1 py-2", a && "mx-0 rounded-xl p-1.5 px-2 py-2.5"),
                        onClick: () => d ? .({
                            hint: k,
                            enable: k.systemHint !== s
                        }),
                        children: a ? e.jsx(Hi, {
                            title: k.name,
                            description: k.description,
                            icon: k.logo,
                            checked: k.systemHint === s
                        }) : e.jsx(Li, {
                            title: k.name,
                            description: k.description,
                            logo: k.logo,
                            checked: k.systemHint === s
                        })
                    }, k.systemHint))]
                }), b && h && e.jsx(ie.Separator, {
                    className: "mx-2 my-1",
                    noMargin: !0
                }), h]
            }),
            R = u && c ? e.jsx(Yr, {
                "aria-label": "",
                className: "pointer-events-none h-[18px] w-[18px]"
            }) : e.jsx(wo, {
                "aria-label": "",
                className: "pointer-events-none h-5 w-5"
            });
        return e.jsxs(ie.Root, {
            open: p,
            onOpenChange: k => {
                g(k), k && l ? .()
            },
            children: [e.jsx(pf, {
                disabled: !!n,
                contextualAnswersHintNameIfPresent: f,
                children: e.jsxs(rc, {
                    className: N(Ou.toolsButton, "flex h-9 min-w-9 items-center justify-center rounded-full border border-token-border-light p-1 text-xs font-semibold text-token-text-secondary focus-visible:outline-black disabled:opacity-30 radix-state-open:bg-black/10 can-hover:hover:bg-token-main-surface-secondary dark:focus-visible:outline-white dark:can-hover:hover:bg-gray-700"),
                    "data-opened": Ua(p),
                    "data-jack": Ua(!!o),
                    "aria-label": a ? m.formatMessage({
                        id: "9xVxsA",
                        defaultMessage: "Upload files and more"
                    }) : m.formatMessage({
                        id: "oDAnGy",
                        defaultMessage: "Use a tool"
                    }),
                    disabled: n,
                    onPointerOver: r,
                    onClick: k => {
                        k.preventDefault()
                    },
                    onFocusCapture: k => {
                        k.stopPropagation()
                    },
                    children: [a ? R : x ? e.jsx(Qr, {
                        className: "pointer-events-none h-5 w-5"
                    }) : e.jsx(Uu, {
                        className: "pointer-events-none h-5 w-5"
                    }), u && c && e.jsx("span", {
                        className: "whitespace-nowrap pr-2 text-[13px] font-semibold [display:--force-hide-label]",
                        children: m.formatMessage({
                            id: "AlZBxR",
                            defaultMessage: "Tools"
                        })
                    })]
                })
            }), e.jsx(ie.Portal, {
                children: e.jsx(ie.Content, {
                    alignOffset: -16,
                    className: N(a && "flex flex-col justify-start gap-2", a && !u && "p-1.5"),
                    onCloseAutoFocus: k => {
                        k.preventDefault()
                    },
                    removeVerticalPadding: a || u,
                    children: w
                })
            })]
        })
    },
    pf = ({
        disabled: t,
        children: s,
        contextualAnswersHintNameIfPresent: o
    }) => {
        const n = st(Xe.hasSeenComposerSystemHintButtonTooltip),
            a = st(Xe.hasSeenCaSystemHint),
            r = !t && !n.isLoading && n.eligible,
            l = !t && !n.isLoading && o && !a.isLoading && a.eligible,
            d = r ? {
                announcementKey: Xe.hasSeenComposerSystemHintButtonTooltip,
                title: e.jsx(E, {
                    id: "tTydhk",
                    defaultMessage: "All your tools, in one handy place"
                }),
                onDismiss: n.markAsViewed,
                description: e.jsx(E, {
                    id: "S+BFNe",
                    defaultMessage: "Create a canvas, generate a picture, and more."
                })
            } : l ? {
                announcementKey: Xe.hasSeenCaSystemHint,
                title: e.jsx(E, {
                    id: "uaC1JM",
                    defaultMessage: "Not finding internal information?"
                }),
                onDismiss: a.markAsViewed,
                description: e.jsx(E, {
                    id: "TL/S+W",
                    defaultMessage: "If ChatGPT didn't search your files automatically, type {hintName} or select it from the menu.",
                    values: {
                        hintName: e.jsx("span", {
                            className: "whitespace-nowrap font-bold",
                            children: '"/' + o + '"'
                        })
                    }
                })
            } : void 0;
        return d ? e.jsx(vn, {
            show: !0,
            side: "bottom",
            theme: "bright",
            dismissOnOutsideClick: !0,
            badge: "new",
            sideOffset: 0,
            className: "!max-w-2xs xs:!max-w-sm",
            ...d,
            children: s
        }) : e.jsx(js, {
            side: "top",
            sideOffset: 0,
            label: t ? e.jsx(E, {
                id: "uw9x80",
                defaultMessage: "Tools unavailable"
            }) : e.jsx(E, {
                id: "mrYNGk",
                defaultMessage: "View tools"
            }),
            children: s
        })
    };

function Ua(t) {
    return t ? "" : null
}
const ao = ({
        children: t,
        ...s
    }) => {
        const {
            isOpen: o,
            closePopover: n,
            popoverContentRef: a
        } = Mo();
        return i.useEffect(() => {
            if (o) return zu(n, a)
        }, [o, a, n]), e.jsx(Jr, {
            forceMount: !0,
            children: e.jsx(Xr, {
                forceMount: !0,
                asChild: !0,
                align: "center",
                sideOffset: -50,
                onEscapeKeyDown: n,
                ...s,
                children: e.jsx("div", {
                    ref: a,
                    className: N(!o && "pointer-events-none"),
                    children: e.jsx(Ze, {
                        mode: "wait",
                        children: o && e.jsx(q.div, {
                            className: "flex w-[215px] overflow-clip rounded-2xl border border-white bg-white/80 shadow-[0px_24px_88px_rgba(0,0,0,0.4)] backdrop-blur-2xl origin-radix-popover dark:border-black dark:bg-black/80 dark:shadow-[0px_24px_88px_rgba(0,0,0,0.4)]",
                            initial: {
                                scale: .9
                            },
                            animate: {
                                scale: 1
                            },
                            exit: {
                                scale: .95,
                                opacity: 0,
                                transition: {
                                    duration: .1,
                                    ease: "easeOut"
                                }
                            },
                            transition: Gu,
                            children: t
                        })
                    })
                })
            })
        })
    },
    gf = ({
        as: t = "div",
        children: s,
        className: o,
        ...n
    }) => {
        const a = t === "div" ? q.div : q.button;
        return e.jsx(a, {
            className: N("relative -ml-1 flex cursor-pointer select-none flex-row items-center justify-center gap-1 whitespace-nowrap rounded-3xl px-2 py-1 font-medium *:pointer-events-none dark:border-white/10", "hover:border-black/0 can-hover:hover:bg-black/5 motion-safe:transition-colors dark:can-hover:hover:bg-white/5", "[color:var(--pill-color,var(--text-primary))] [font-size:var(--pill-font-size,14px)]", o),
            ...n,
            children: s
        })
    },
    ff = {
        active: {
            scaleX: 1
        },
        inactive: {
            scaleX: 1.5
        }
    },
    ro = ({
        children: t,
        className: s,
        variants: o = ff
    }) => {
        const {
            isOpen: n,
            openPopover: a,
            popoverTriggerRef: r
        } = Mo(), l = i.useCallback(h => {
            (h.key === "Enter" || h.key === " ") && (h.preventDefault(), a())
        }, [a]), d = i.useCallback(() => {
            a()
        }, [a]);
        return e.jsx(Wu, {
            asChild: !0,
            children: e.jsx(gf, {
                animate: n ? "inactive" : "active",
                as: "button",
                className: N("motion-safe:[transition:background-color_0.6s_var(--spring-fast),border-color_0.1s_ease-in-out]", s),
                "data-reasoning-popover-action": !0,
                onClick: d,
                onKeyDown: l,
                ref: r,
                tabIndex: 0,
                transition: qu,
                variants: o || void 0,
                children: t
            })
        })
    };

function xf(t = !1) {
    const [s, o] = i.useState(t), [n, a] = i.useState(!1);
    return {
        isOpen: s,
        isStartingToOpen: n,
        setIsOpen: o,
        setIsStartingToOpen: a
    }
}

function ys({
    layoutMode: t,
    initialOpen: s = !1,
    children: o,
    onClose: n
}) {
    const {
        isOpen: a,
        isStartingToOpen: r,
        setIsOpen: l,
        setIsStartingToOpen: d
    } = xf(s), h = i.useRef(null), c = i.useRef(null), u = i.useCallback(() => {
        l(!0), Vu(), requestAnimationFrame(() => {
            d(!0), $u({
                root: h.current,
                autoFocus: !0
            })
        })
    }, [l, d]), m = i.useCallback(() => {
        l(!1), d(!1), requestAnimationFrame(() => {
            c.current ? .focus()
        }), n ? .()
    }, [n, l, d]), p = f => {
        f ? u() : m()
    }, g = {
        Trigger: {
            type: ro,
            instance: null
        },
        Content: {
            type: ao,
            instance: null
        }
    };
    return i.Children.forEach(o, f => {
        i.isValidElement(f) && (f.type === ro ? g.Trigger.instance = f : f.type === ao && (g.Content.instance = f))
    }), e.jsx(Yu, {
        value: {
            closePopover: m,
            isOpen: a,
            isStartingToOpen: r,
            layoutMode: t,
            openPopover: u,
            popoverContentRef: h,
            popoverTriggerRef: c
        },
        children: e.jsxs(Zr, {
            open: a,
            onOpenChange: p,
            children: [g.Trigger.instance, g.Content.instance]
        })
    })
}
ys.Trigger = ro;
ys.Content = ao;

function Oi({
    value: t,
    className: s,
    size: o
}) {
    const a = {
            1: 0,
            2: .5,
            3: 1
        }[t],
        r = ei(),
        l = 40,
        d = 250 / 360 * 2 * Math.PI * l,
        h = 330,
        c = 220,
        u = h * Math.PI / 180,
        m = c * Math.PI / 180,
        p = {
            x: 50 + l * Math.cos(u),
            y: 50 + l * Math.sin(u)
        },
        g = {
            x: 50 + l * Math.cos(m),
            y: 50 + l * Math.sin(m)
        },
        f = ya(d, x({
            stiffness: 150,
            damping: 20
        }));
    i.useEffect(() => {
        f.set(d * (1 - a))
    }, [a, f, d]);

    function x(M) {
        return r ? {
            duration: 0
        } : M
    }
    const b = 310,
        S = ya(b, x({
            stiffness: 80,
            damping: 12
        }));
    return i.useEffect(() => {
        S.set(b + a * 270 + 90 + 5)
    }, [a, S]), e.jsxs("div", {
        className: N("relative flex -scale-x-100 -scale-y-100 items-center justify-center", o === "small" && "h-5 pb-2.5", s),
        children: [e.jsx(q.div, {
            className: "absolute",
            animate: {
                translateX: Math.sin(a > .5 ? -a + 1.5 : a - .5) * 1,
                translateY: Math.sin(a > .5 ? -a + .5 : a - .5) * -4 + -1
            },
            transition: r ? void 0 : {
                delay: .1,
                stiffness: 80,
                damping: 12
            },
            children: e.jsxs(q.svg, {
                width: "22",
                height: "38",
                viewBox: "0 0 22 38",
                style: {
                    rotate: S,
                    transformOrigin: "50% 80%",
                    scaleY: o === "small" ? .22 : .4,
                    scaleX: o === "small" ? .22 : .4,
                    translateY: -9
                },
                fill: "none",
                xmlns: "http://www.w3.org/2000/svg",
                children: [e.jsx("g", {
                    clipPath: "url(#clip0_0_3)",
                    children: e.jsx("path", {
                        d: "M10.0394 2.31831C10.3181 1.35572 11.6819 1.35572 11.9606 2.31831L18.9414 26.4338C20.472 31.7213 16.5046 37 11 37V37C5.49537 37 1.52803 31.7213 3.05864 26.4338L10.0394 2.31831Z",
                        className: t > 1 ? "fill-[#0077ff]" : "fill-[#444] dark:fill-[#888]"
                    })
                }), e.jsx("defs", {
                    children: e.jsx("clipPath", {
                        id: "clip0_0_3",
                        children: e.jsx("rect", {
                            width: "22",
                            height: "38",
                            fill: "#000"
                        })
                    })
                })]
            })
        }), e.jsxs("svg", {
            "data-testid": "arc-gauge-svg",
            width: "100",
            height: "60",
            viewBox: "0 0 100 60",
            children: [e.jsx("path", {
                d: `M ${p.x.toFixed(2)} ${p.y.toFixed(2)} A ${l} ${l} 0 1 1 ${g.x.toFixed(2)} ${g.y.toFixed(2)}`,
                fill: "none",
                className: t < 2 ? "stroke-[rgba(0_0_0_/_30%)] dark:stroke-[rgba(255_255_255_/_20%)]" : "stroke-[rgba(0_0_0_/_18%)] dark:stroke-[rgba(255_255_255_/_18%)]",
                strokeWidth: 8,
                strokeLinecap: "round"
            }), e.jsx(q.path, {
                d: `M ${p.x.toFixed(2)} ${p.y.toFixed(2)} A ${l} ${l} 0 1 1 ${g.x.toFixed(2)} ${g.y.toFixed(2)}`,
                fill: "none",
                stroke: "#0077ff",
                strokeWidth: 8,
                strokeDasharray: d,
                style: {
                    strokeDashoffset: f
                },
                strokeLinecap: "round"
            })]
        })]
    })
}

function vf(t) {
    const {
        reasoningLevelTypes: s,
        reasoningLevelType: o
    } = t, {
        ReasoningLevels: n
    } = s;
    let a = 1;
    return o === n.medium.type ? a = 2 : o === n.high.type && (a = 3), e.jsx("div", {
        className: "h-5 w-5 overflow-clip pb-2.5",
        children: e.jsx(Oi, {
            size: "small",
            value: a
        })
    })
}

function yf({
    reasoningLevelTypes: t,
    reasoningLevelType: s
}) {
    const o = ce();
    return e.jsxs("div", {
        className: "flex items-center gap-2",
        children: [e.jsx(vf, {
            reasoningLevelTypes: t,
            reasoningLevelType: s
        }), e.jsx("span", {
            className: "mr-1 text-token-text-secondary [display:--force-hide-label]",
            children: o.formatMessage({
                id: "ptCFjr",
                defaultMessage: "Juice"
            })
        })]
    })
}
const Sf = ({
        clientThreadId: t,
        reasoningLevelTypes: s,
        reasoningLevelType: o,
        onReasoningLevelChanged: n,
        currentModel: a,
        category: r,
        shouldShowModelPicker: l
    }) => {
        const d = ce(),
            {
                isStartingToOpen: h,
                layoutMode: c,
                closePopover: u
            } = Mo(),
            {
                reasoningLevelList: m,
                reasoningLevelsByValue: p
            } = s,
            g = m.find(S => S.type === o),
            f = i.useRef(!1),
            [x, b] = i.useState(!1);
        return e.jsxs("div", {
            className: N("max-h-[max(calc(var(--radix-popover-content-available-height)-64px), 215px)] flex snap-y snap-proximity overflow-y-auto scroll-smooth [scrollbar-gutter:stable]", c === "centered" && "origin-center flex-col", c === "bottom" && "flex-col-reverse"),
            children: [!x && e.jsxs(e.Fragment, {
                children: [e.jsxs(q.div, {
                    initial: {
                        scaleX: "80%"
                    },
                    animate: {
                        scaleX: "100%"
                    },
                    exit: {
                        scaleX: "80%"
                    },
                    transition: {
                        type: "spring",
                        visualDuration: .3,
                        bounce: .45
                    },
                    className: N("relative mx-4 flex flex-col items-center rounded-3xl bg-token-border-xlight", c === "bottom" ? "mb-4" : "mt-4"),
                    children: [e.jsx("datalist", {
                        id: "juice-level-markers",
                        className: "pointer-events-none absolute inset-0 z-[-1] flex items-center justify-between px-3.5",
                        children: m.map((S, M) => e.jsx("option", {
                            value: S.value,
                            className: N("aspect-square h-1.5 overflow-hidden rounded-full bg-black/10 text-transparent [min-block-size:6px] dark:bg-white/10", M === 0 && "translate-x-1.5", M === m.length - 1 && "-translate-x-1.5"),
                            label: S.label
                        }, S.type))
                    }), e.jsx("input", {
                        type: "range",
                        id: "juce-level",
                        name: "juice-level",
                        className: N(Ku.rangeSelector, "h-8 w-full cursor-pointer touch-pan-y appearance-none rounded-2xl bg-transparent px-1"),
                        style: {
                            "--slider-thumb-translate-x": h ? "0px" : g.type === "medium" ? 0 : g.type === "low" ? "45px" : "-45px"
                        },
                        min: "0",
                        step: "1",
                        tabIndex: 0,
                        max: "2",
                        value: g.value,
                        onKeyDown: S => {
                            (S.key === "Escape" || S.key === " " || S.key === "Enter") && u()
                        },
                        onPointerUp: () => {
                            f.current && requestAnimationFrame(() => {
                                u()
                            })
                        },
                        onChange: S => {
                            const M = S.target.value,
                                w = p.get(parseInt(M));
                            w && (n(w.type), f.current = !0)
                        },
                        list: "juice-level-markers"
                    })]
                }), e.jsx("div", {
                    children: e.jsxs("div", {
                        className: "text-md my-4 flex flex-col items-center justify-center text-black dark:text-white",
                        children: [e.jsx("div", {
                            className: "h-10 w-10 overflow-clip",
                            children: e.jsx(Oi, {
                                value: g.value + 1,
                                size: "large"
                            })
                        }), e.jsx("label", {
                            htmlFor: "juice-level-label",
                            className: "my-1.5 font-semibold tracking-[-0.32px] [font-size:16px]",
                            children: g.label
                        }), e.jsx("div", {
                            className: "mb-2 text-balance px-2 text-center text-xs font-normal text-token-text-secondary",
                            children: g.description
                        }), l && e.jsxs(Ui, {
                            onClick: S => {
                                S.preventDefault(), b(!x)
                            },
                            "data-reasoning-popover-action": !0,
                            children: [d.formatMessage({
                                id: "zsMG/q",
                                defaultMessage: "Model: {label}"
                            }, {
                                label: r ? .shortLabel ? ? a ? .title
                            }), e.jsx(Qu, {
                                "aria-label": "",
                                className: "icon-sm pointer-events-none text-token-text-tertiary"
                            })]
                        })]
                    })
                })]
            }), x && l && e.jsx(bf, {
                clientThreadId: t,
                isModelPickerOpen: x,
                setIsModelPickerOpen: b
            })]
        })
    },
    bf = ({
        clientThreadId: t,
        isModelPickerOpen: s,
        setIsModelPickerOpen: o
    }) => {
        const n = ce(),
            a = _o(),
            r = No(t, a, !1, !0);
        return e.jsxs(e.Fragment, {
            children: [e.jsx("div", {
                className: "flex w-full flex-col pb-8",
                children: r.map(l => e.jsx(vo.Fragment, {
                    children: l.content
                }, l.id))
            }), e.jsx("div", {
                className: "absolute bottom-0 left-0 right-0 z-10 flex justify-center overflow-clip bg-token-main-surface-primary py-2",
                children: e.jsx(Ui, {
                    onClick: l => {
                        l.preventDefault(), o(!s)
                    },
                    "data-reasoning-popover-action": !0,
                    children: n.formatMessage({
                        id: "BJSpNc",
                        defaultMessage: "Back"
                    })
                })
            })]
        })
    };

function Ui({
    children: t,
    ...s
}) {
    return e.jsx("button", {
        className: "inline-flex cursor-pointer items-center text-center text-xs text-token-text-tertiary hover:underline",
        ...s,
        children: t
    })
}
const jf = ({
        clientThreadId: t,
        reasoningLevelType: s,
        onReasoningLevelChanged: o,
        layoutMode: n,
        currentModel: a,
        category: r,
        shouldShowModelPicker: l = !1
    }) => {
        const d = Ju(),
            [h, c] = i.useState(s);
        return e.jsxs(ys, {
            layoutMode: n,
            onClose: () => c(s),
            children: [e.jsx(ys.Trigger, {
                children: e.jsx(yf, {
                    reasoningLevelTypes: d,
                    reasoningLevelType: h
                })
            }), e.jsx(ys.Content, {
                children: e.jsx(Sf, {
                    clientThreadId: t,
                    reasoningLevelTypes: d,
                    reasoningLevelType: s,
                    onReasoningLevelChanged: o,
                    currentModel: a,
                    category: r,
                    shouldShowModelPicker: l
                })
            })]
        })
    },
    Cf = 1,
    wf = 3e3,
    za = "search-button",
    Ga = "active-hint-tag";

function kf({
    onAbortCompletion: t,
    onCreateNewCompletion: s,
    onContinueGenerating: o,
    account: n,
    currentModelId: a,
    currentModelConfig: r,
    models: l,
    defaultModelSlug: d,
    modelCategories: h,
    clientThreadId: c,
    isNewThread: u,
    isCompletionInProgress: m,
    className: p,
    disabled: g = !1,
    disabledReason: f,
    canPause: x = !1,
    canContinue: b = !1,
    suggestions: S,
    isInteractableSharedThread: M,
    composerContainerRef: w,
    autocompletions: R,
    matchaData: k,
    requiresFileUpload: V,
    onComposerInput: C,
    onComposerChange: j,
    onAutocompleteSelect: T,
    headerClassName: P,
    hideHeader: _,
    onTaggingDropdownOpen: H,
    onTaggingDropdownClose: I
}) {
    yt.markStart("PromptTextarea"), yt.markRendered("PromptTextarea");
    const Q = i.useRef(null),
        y = xn(),
        W = bn(),
        ne = n ? .isFree(),
        {
            isUnauthenticated: D
        } = gt(),
        Y = ce(),
        ae = hn(),
        L = Co(),
        [se, oe, ye] = de(c, v => [K.getCurrentLeafId(v), K.getRequestId(v), K.getConversationTurns(v).some(J => !!J.messages.length)]),
        [fe] = Vc(),
        {
            gizmoEditorData: le,
            mode: Ee,
            getGizmoId: Z
        } = yn(),
        xe = xr(),
        Se = yo(),
        ue = It(),
        Me = ti(),
        me = ss(c),
        be = !!mr(),
        Re = !!ic(),
        _e = !!fa(),
        He = fa(),
        A = lc(),
        re = Ao.useIsEnabled(c),
        ee = !!mo(),
        {
            setThreadSystemHintMode: we,
            clearSystemHintModeTrigger: Bt,
            getSystemHintModeTrigger: ns
        } = wn(),
        Pe = jn(),
        Ct = Ho(c),
        We = Pe.has($.Search),
        it = Pe.has($.Think);
    Pe.has($.Research);
    const qe = kn(c),
        Dt = qe.length > 0,
        z = Pe.size === 1 && Pe.values().next().value,
        O = z && z !== $.Search && z !== $.Think,
        te = qe.find(v => v.systemHint === z),
        [je, Ie] = i.useState(!1),
        [Ve, Oe] = i.useState(0),
        [$e, Ye] = i.useState(!1),
        wt = i.useRef(!1),
        pe = h ? .find(v => v.defaultModel === a),
        kt = null;
    let X = ws(c),
        Ke = X && "gizmo" in X ? X.gizmo : void 0;
    const Tt = Ts(Ke ? .gizmo.id),
        Mn = wg(),
        _n = Xu(),
        Lt = si(),
        Ns = Eo(Ke ? .gizmo.id),
        [Fe, Ht] = i.useState(null);
    Fe !== null && (X = {
        gizmo: Fe,
        gizmo_id: Fe.gizmo.id,
        kind: Be.GizmoInteraction
    }, Ke = Fe);
    const Mt = rn(r, X),
        Nn = mn(),
        _t = !g && Mt !== Rt.None && !D,
        nt = Ar(r, X),
        os = Rr(r, X);
    let ke = ln(v => v.files);
    const [as] = i.useState(() => Zu());
    Ee === "magic" ? ke = ke.filter(v => v.gizmoId != null) : ke = ke.filter(v => v.gizmoId == null);
    const rs = em(),
        lt = ke.length > 0 || rs,
        Ot = ln(bm.hasUploadInProgress),
        is = tm(c),
        Ut = y.useState(v => {
            const J = yp(v);
            return typeof r ? .maxTokens == "number" && J > r.maxTokens
        }),
        As = y.useState(v => !v.isEmpty()),
        zt = !Ut && !Ot && (As || lt),
        Es = (Mt === Rt.Multimodal ? bo : jo) - ke.length,
        ls = Es <= 0,
        ot = zt && !g && !ee && (!m || Lt),
        [Rs, cs] = i.useState(!1),
        {
            value: Ps,
            isLoading: An
        } = Ae("3780975974"),
        {
            value: En
        } = Ae("759329447"),
        {
            value: Rn
        } = Ae("2223246572"),
        {
            value: ct
        } = Ae("1325692000"),
        ft = ka(r, xa.Search),
        {
            userIsInSearchHoldoutWithWebDisabled: Is
        } = yi(),
        Pn = D && !ft,
        G = !g && (!Ke || Tt) && xe ? .includes(Js.SearchTool) && !xe.includes(Js.SearchToolHoldout) && !Is && (xe.includes(Js.BrowsingAvailable) || !n ? .isEnterprisey()) && (!ct || !O) && !Pn,
        {
            value: Te
        } = he("1416952492"),
        {
            value: xt
        } = he("4239853523"),
        vt = G && ft,
        {
            targetedContent: Fs,
            setTargetedContent: Bs
        } = ni(),
        tt = Fs ? .isFocusedViewContent && !Me ? void 0 : Fs,
        {
            rebaseSystemMessageContent: zo
        } = Ro(),
        Ki = X == null || X ? .kind === Be.PrimaryAssistant || X ? .kind === Be.GizmoInteraction && Tt,
        Qi = X ? .kind === Be.PrimaryAssistant || X ? .kind === Be.GizmoInteraction && Tt,
        Ji = qe.find(v => v.systemHint === $.Think),
        {
            getUpsellLabelType: Go,
            getUpsellShowsAttach: Xi,
            getShowUpsellReason: Wo
        } = Kr(),
        {
            layer: qo
        } = ht("2149763392"),
        In = {
            getShowReasoningPopover: Ta({
                layer: qo,
                paramName: "show-in-main-composer",
                defaultValue: !1
            }),
            getShowModelPicker: Ta({
                layer: qo,
                paramName: "show-model-picker",
                defaultValue: !1
            })
        },
        [Zi, el] = i.useState("low"),
        tl = Ps && Ji && kt == null && X ? .kind === Be.PrimaryAssistant && (En || ct) && !In.getShowReasoningPopover() && (!ct || !O),
        sl = X ? .kind === Be.PrimaryAssistant && !ue && !ct && !xt,
        ds = Dt && Ki,
        [Vo, nl] = i.useState(!1),
        ol = !ne && ds && !Rn,
        [us, al] = i.useState(!1);
    i.useEffect(() => {
        if (!W ? .id) return;
        const v = Aa.getAndReset(W.id, me);
        v && y.setText(v.inputText)
    }, [W ? .id, me, y]), i.useEffect(() => {
        const v = fe.get("prompt") ? ? "";
        y.getCurrentText().length === 0 && v.length > 0 && y.setText(v)
    }, [y, fe]), i.useEffect(() => {
        Rs !== ot && (cs(ot), ot && cc(!0).then(v => {
            sm.startEnforcement(v), dc.startEnforcement(v)
        }))
    }, [ot, Rs, X ? .kind, xe]);
    const Ds = Nr(r, X),
        {
            handleFileAccepted: rl
        } = Ci(Y, rn(r, X), nt, "mouse", Z, Ds ? .attachments),
        {
            getInputProps: il,
            open: ll
        } = Pr({
            disabled: g || !_t || ls,
            noClick: !0,
            onDropAccepted: rl,
            onDropRejected: v => ji(v, Y, ae, Mt),
            multiple: !0,
            maxSize: Ir,
            maxFiles: Es,
            ...Er(os)
        }),
        $o = uc(as),
        {
            value: cl
        } = Ae("1988730211"),
        {
            isBigBoxModeActive: dl
        } = tg(c),
        Yo = i.useCallback(() => {
            y.eraseContent(), $o.clearMessages(), y.resize(Cf), y.usedDictation = !1, nm();
            for (const v of ke) Xs.remove(L, v.tempId, "none");
            om.markAllAsSent()
        }, [y, $o, ke, L]),
        Ls = async (v, J) => {
            if (v.preventDefault(), g || !zt && !J || !X || rt(c) ? .isLoading !== !1) return;
            if (Lt && ps === "streaming") {
                const Je = K.getMessage(rt(c)),
                    Gn = Je ? hc(Je).length : 0;
                F.logEventWithStatsig(B.conversationStreamInterrupted, "chatgpt_web_conversation_stream_interrupted", {
                    client_thread_id: c,
                    interrupted_message_length: Gn
                })
            }
            const ge = pc(oe);
            if (Lt && ge && !ge.turnTracker.isStreamOpen) return;
            Ie(!0), Mn ? .(), _n();
            const ve = y.getContentToSend(),
                Qe = bp(ve.content),
                Wt = jm({
                    namespace: Cm.CompletionRequest,
                    opts: {
                        expectedTimingLogs: [{
                            name: "prompt_submitted",
                            expectedInMs: 3e3
                        }],
                        debug: !1
                    }
                });
            Wt.reset();
            const {
                content: fs,
                attachments: zs
            } = wm(L, Qe, r, X), On = [], la = [];
            zo && la.push(gc(zo));
            const Un = { ...X
            };
            "gizmo" in Un && delete Un.gizmo;
            let Gs = y.getSystemHints();
            Pe.size > 0 && (Gs = Array.from(Pe));
            const ca = ns($.Search),
                Gl = We ? ca ? ? fr.CONVERSATION_COMPOSER_WEB_ICON : void 0,
                da = km(),
                ua = Tm(),
                Wl = y.usedDictation,
                ql = fc(fs, { ...zs.length > 0 && {
                        attachments: zs
                    },
                    ...Fe && {
                        gizmo_id: Fe.gizmo.id
                    },
                    ...Gs.length > 0 && {
                        system_hints: Gs
                    },
                    ...!!ve.metadata && {
                        serialization_metadata: ve.metadata
                    },
                    ...da.length > 0 && {
                        canvas: {
                            user_created_textdocs: da.map(Je => ({
                                user_created_temp_textdoc_id: Je.tempTextdocId,
                                type: Je.type,
                                title: Je.title,
                                content: Je.content,
                                create_source: Je.create_source,
                                remix_shared_textdoc_id: Je.remixSharedTextdocId
                            }))
                        }
                    },
                    ...Object.keys(ua).length > 0 && {
                        __internal: {
                            search_settings: ua
                        }
                    },
                    dictation: Wl
                });
            let ut = {
                sourceEvent: v,
                completionMetadata: {
                    suggestions: S,
                    conversationMode: Un,
                    systemHints: Gs,
                    searchSource: Gl
                },
                promptMessage: ql,
                prependMessages: On,
                appendMessages: la,
                profiler: Wt
            };
            const zn = {};
            if (ut = Mm(ut), cl && ut.completionMetadata ? .systemHints) {
                let Je = !1;
                ut.completionMetadata.systemHints = ut.completionMetadata.systemHints.filter(Gn => Gn === $.Search ? (Je = !0, !1) : !0), Je && (zn.forceUseSearch = !0)
            }
            re && (zn.enableMessageFollowups = !0), ut.extraStreamParams = zn, tt ? .createNewCompletionParams && (ut = await tt.createNewCompletionParams(ut)), Wt.logTiming("request_params_ready"), s(ut), tt ? .onCreateCompletion ? .({
                serverThreadId: me,
                currentLeafId: se
            }), tt ? .shouldPersistAcrossMessages !== !0 && Bs(void 0), an.hideThreadHeader(), Yo(), Ie(!1), S !== void 0 && (De.logEvent("chatgpt_prompt_ignore_suggestions"), F.logEvent(B.promptIgnoreSuggestions)), We && ca && Bt($.Search)
        },
        ul = i.useRef(Ls);
    i.useEffect(() => {
        ul.current = Ls
    });
    const ml = v => {
            Bs(v.targetedReply), v.targetedReply && (y.focus(), F.logEventWithStatsig(B.targetedReplyButtonClicked, "chatgpt_targeted_reply_button_clicked", {
                conversationId: me,
                sourceMessageId: v.messageId
            }))
        },
        Ko = i.useCallback(() => {
            tt ? .onCleared ? .({
                serverThreadId: me,
                currentLeafId: se
            }), Bs(void 0), y.focus()
        }, [se, me, tt, Bs, y]),
        Qo = {
            Enter: {
                validator: v => {
                    const J = v.isComposing || v.keyCode === 229,
                        ge = $e && wt.current;
                    return dl ? !ge && !J && (v.metaKey || v.ctrlKey) : !ge && (v.metaKey || (Se || xc) && !v.shiftKey && !J)
                },
                handler: v => {
                    if (!ot) {
                        Ut && ae.danger("The message you submitted was too long, please submit something shorter.", {
                            hasCloseButton: !0
                        });
                        return
                    }
                    v.preventDefault(), Ls(v)
                }
            },
            Escape: {
                validator: v => !v.isComposing,
                handler: v => {
                    x && m && (t(oe), F.logEvent(B.pauseCompletion, {
                        threadId: St(c),
                        currentLeafId: K.getMessageId(rt(c)),
                        eventSource: "keyboard"
                    })), v.target.value === "" && Ko()
                }
            }
        },
        ms = i.useRef(Qo);
    ms.current = Qo;
    const Hs = am(r ? .tags, X ? .kind),
        [Fn, Os] = i.useState(!1),
        hs = Hs && Fn && !Tt,
        Jo = y.isReady();
    i.useEffect(() => y.subscribe("keydown", v => {
        y.acceptLegacyKeydown() && ms.current[v.key].validator(v) && ms.current[v.key].handler(v);
        const ge = y.getCurrentText();
        if (v.key === "@") {
            const ve = y.getSelectionStart(),
                Qe = ge.substring(0, ve);
            (!Qe || /\s$/.test(Qe) || ve === 0) && setTimeout(() => Os(!0), 10)
        } else Fn && Os(!1);
        v.key === "Escape" && (Ht(null), Ye(!1)), We && v.key === "Escape" && we($.Search, !1, {
            clientThreadId: c
        })
    }), [y, Jo, Fn, vt, Pe, We, we, c]), i.useEffect(() => {
        const v = Object.fromEntries(Object.keys(ms.current).map(J => [J, ve => {
            const Qe = ms.current[J];
            if (!Qe || y.acceptLegacyKeydown()) return !1;
            const {
                validator: Wt,
                handler: fs
            } = Qe;
            return Wt(ve) ? (fs(ve), !0) : !1
        }]));
        y.registerKeyHandlers(v)
    }, [y, Jo]), i.useEffect(() => y.subscribe("paste", v => {
        rm({
            filePickerStore: L,
            event: v,
            intl: Y,
            toaster: ae,
            clientThreadId: c,
            conversationMode: X,
            currentModelConfig: r,
            getEditorGizmoId: Z,
            modelSupportedImageMimeTypes: nt
        })
    }), [Y, c, X, r, Z, nt, y, ae, L]);
    const hl = v => {
            be || Ht(v), y.trimLeadingText("@"), to(), Os(!1)
        },
        pl = im(c, as, nt, Ds ? .attachments),
        gl = i.useCallback(v => {
            v.preventDefault(), t(oe), F.logEvent(B.pauseCompletion, {
                threadId: St(c),
                currentLeafId: K.getMessageId(rt(c)),
                eventSource: "mouse"
            }), to()
        }, [t, c, oe]),
        Xo = i.useCallback(() => {
            Aa.set(W ? .id, me, y.getCurrentText())
        }, [me, W ? .id, y]);
    i.useEffect(() => {
        le || !je && !lm() && y.focus()
    }, [je, y]), i.useEffect(() => {
        if (nt.length > 0)
            for (const J of ke) Sp(J.fileSpec ? .mimeType, os) || Xs.remove(L, J.tempId, "none");
        else Xs.reset(L)
    }, [a, L]), i.useEffect(() => {
        (!Hs && Fe || be) && Ht(null)
    }, [Hs, Fe, be]);
    const {
        layer: fl
    } = ht("4031588851"), {
        layer: Zo
    } = ht("3637408529"), xl = Zo.get("is_in_composer_text_exp", !1), vl = Zo.get("composer_text", "MESSAGE_CHATGPT"), yl = fl.get("composer_text", "MESSAGE_CHATGPT"), Sl = xl ? vl : yl, [Us, bl] = (() => {
        switch (f) {
            case "workspaceDisallowsGizmo":
                return [Ce.disallowedByWorkspacePlaceholder, !0];
            case "noModelsAvailable":
                return [Ce.noModelsAvailablePlaceholder, !0];
            case "requiresPluginsToBeInstalled":
                return [Ce.requiresPluginsToBeInstalled, !0];
            case "loadingPlugins":
                return [Ce.loading, !0];
            case "noTestGizmoId":
                return [Ce.noTestGizmoId, !0];
            default:
                {
                    if (M) return [Ce.placeholderWithName, !1];
                    if (tt ? .placeholderTextOverride != null) return [tt.placeholderTextOverride, !1];
                    if (Ct === "initial" || Ct === "recurrent" || Ct === "clarify") return ye ? [Ce.researchSuggestionInitial, !1] : [Ce.deepResearchPlaceholder, !1];
                    switch (Sl) {
                        case "BLANK":
                            return [null, !1];
                        case "ASK_ANYTHING":
                            return [Ce.placeholderAskAnythingVariant, !1];
                        case "ASK_CHATGPT_ANYTHING":
                            return [Ce.placeholderAskNameAnythingVariant, !1];
                        default:
                            return [Ce.placeholderWithName, !1]
                    }
                }
        }
    })(), jl = Tt ? u ? Y.formatMessage(Jn.newChatInProject) : Us ? Y.formatMessage(Us, {
        name: "ChatGPT"
    }) : "​" : Us ? Y.formatMessage(Us, {
        name: le != null ? Ee === "magic" ? cm : le.name || "GPT" : Ke ? .gizmo.display.name ? ? "ChatGPT"
    }) : "​";
    i.useEffect(() => y.subscribe("input", () => {
        Po.getState().isThreadHeaderVisible && an.hideThreadHeader(), Ye(!0)
    }), [y]), i.useEffect(() => y.subscribe("input", () => {
        Oe(performance.now()), C ? .()
    }), [y, C]), i.useEffect(() => {
        if (j) return y.subscribe("change", () => {
            j()
        })
    }, [y, j]), i.useEffect(() => y.subscribe("focus", () => {
        Ye(!0)
    }), [y]), i.useEffect(() => {
        ct && z && O && !qe.some(({
            systemHint: v
        }) => v === z) && !D && we(z, !1, {
            clientThreadId: c
        })
    }, [c, we, z, O, qe, D, ct]);
    const ea = Ps || An || Wo(),
        ta = {
            clientThreadId: c,
            uploadType: Mt,
            modelAcceptedMimeTypes: os,
            modelSupportedImageMimeTypes: nt,
            attachmentsProductFeature: Ds ? .attachments,
            getInputProps: il,
            openFileDialog: ll,
            historyDisabled: ue,
            onOauthRedirect: Xo,
            highlightTooltip: V && !lt
        },
        Bn = qe.some(({
            systemHint: v,
            requiredModels: J
        }) => v === $.Think && J.some(ge => {
            const ve = Io(l, ge);
            return ve ? ve.product_features.attachments : !1
        })),
        Nt = [],
        sa = !g && !ls && (_t || Nn != null) && !We && (!it || Bn),
        Dn = Xi(),
        na = Dn || !D,
        oa = Mt === Rt.None ? pt.ModelNotSupported : it ? pt.ThinkModeInUse : We ? pt.SearchModeInUse : void 0;
    !xt && na ? Nt.push(e.jsx("div", {
        style: {
            viewTransitionName: "var(--vt-composer-attach-file-action)"
        },
        children: e.jsx(La, { ...ta,
            showLabel: Go() === "all",
            showUpsell: Dn,
            isDisabled: !sa || us,
            disabledReason: oa,
            currentModelName: r ? .title ? ? ""
        })
    }, "file-upload-button")) : Nt.push(e.jsx("div", {
        style: {
            viewTransitionName: "var(--vt-composer-system-hint-action)"
        },
        children: e.jsx(Oa, {
            composerController: y,
            clientThreadId: c,
            disabled: !na,
            showLabel: Go() === "all",
            showUpsell: Dn,
            isComposerV2Mode: !0,
            uploadButtons: e.jsx(La, { ...ta,
                isDisabled: !sa,
                isNested: !0,
                disabledReason: oa,
                currentModelName: r ? .title ? ? ""
            })
        })
    }, "system-hint-button"));
    const dt = [];
    te && O && ct && dt.push(e.jsx("div", {
        style: {
            viewTransitionName: `var(--vt-composer-${te}-action)`
        },
        children: e.jsx(Ba, {
            logo: e.jsx(_s, {
                svgString: te.logo,
                className: "h-[18px] w-[18px] text-blue-1000 dark:text-[#48AAFF]"
            }),
            label: te.name,
            showRemoveIcon: !0,
            onClick: () => {
                we(te.systemHint, !1, {
                    clientThreadId: c
                })
            },
            showLabel: ea
        })
    }, Ga));
    const aa = Sn();
    let Ln = "bottom";
    aa ? Ln = "bottom" : u && (Ln = "centered"), In.getShowReasoningPopover() && dt.push(e.jsx("div", {
        className: "flex [--pill-color:var(--text-secondary)] [--pill-font-size:13px]",
        children: e.jsx(jf, {
            clientThreadId: c,
            reasoningLevelType: Zi,
            onReasoningLevelChanged: el,
            layoutMode: Ln,
            currentModel: r,
            category: pe,
            shouldShowModelPicker: In.getShowModelPicker()
        })
    }, "reasoning-level")), G && dt.push(e.jsx("div", {
        style: {
            viewTransitionName: "var(--vt-composer-search-action)"
        },
        children: e.jsx(Vg, {
            composerController: y,
            clientThreadId: c,
            isDisabled: !vt || lt || us,
            disabledReason: ft ? lt ? cn.HasAttachedFiles : void 0 : cn.ModelNotSupported,
            showLabel: !Vo,
            currentModelName: r ? .title ? ? ""
        })
    }, za));
    const Cl = i.useMemo(() => A.reduce((v, J) => (v[J.feature_name] = J, v), {}), [A]);
    qe.forEach(v => {
        const J = ag(v.systemHint) ? ? v.systemHint,
            ge = Cl[J] ? ? null,
            ve = v.systemHint === $.Think,
            Qe = v.systemHint === $.Research;
        if (ve && !tl || v.systemHint === $.Search && G || Qe && !sl) return;
        const fs = ve && (Re || !Bn && lt) || Qe && (_e || Te);
        if (v.composerBarButtonInfo) {
            const zs = r ? .tags.includes("reasoning") || r ? .id.includes("o1") || r ? .id.includes("o3");
            let On = v.composerBarButtonInfo;
            Qe && He && (On.rateLimitReachedText = Y.formatMessage({
                id: "T3aUKM",
                defaultMessage: "More available {time}"
            }, {
                time: He.resets_after_text
            })), dt.push(e.jsx("div", {
                style: {
                    viewTransitionName: `var(--vt-composer-${v.systemHint}-action)`
                },
                children: e.jsx(ig, {
                    composerController: y,
                    systemHint: v,
                    rateLimitProgress: ge,
                    composerBarButtonInfo: v.composerBarButtonInfo,
                    clientThreadId: c,
                    isDisabled: !ds || fs || us,
                    isPinnedActive: zs && ve,
                    showLabel: ea,
                    currentModelName: r ? .title ? ? "",
                    disabledReason: ve && !Bn && lt ? $t.HasAttachedFiles : Qe ? Te ? $t.DeepResearchHighLoad : $t.RateLimitReached : void 0
                })
            }, `system-hint-${v.systemHint}`))
        }
    }), Ns && dt.push(e.jsx("div", {
        style: {
            viewTransitionName: "var(--vt-composer-system-model-selector)"
        },
        children: e.jsx(dm, {
            clientThreadId: c
        })
    }, "model-selector-button")), ol && !Wo() && !xt && dt.push(e.jsx("div", {
        style: {
            viewTransitionName: "var(--vt-composer-system-hint-action)"
        },
        children: e.jsx(Oa, {
            composerController: y,
            clientThreadId: c,
            disabled: !ds || us
        })
    }, "system-hint-button"));
    const wl = um(!1);
    if (!ct || a === d || !Qi) Nt.push(...dt);
    else if (r && d && h && pe) {
        Nt.push(e.jsx(Ba, {
            showLabel: !0,
            logo: null,
            label: pe.shortLabel,
            onClick: () => wl({
                location: "PromptTextArea",
                modelId: d
            }),
            showRemoveIcon: !0
        }));
        const v = dt.find(ge => ge.key === za);
        ft && v ? Nt.push(v) : Pe.has($.Search) && we($.Search, !1, {
            clientThreadId: c
        }), Pe.has($.Think) && we($.Think, !1, {
            clientThreadId: c
        });
        const J = dt.find(ge => ge.key === Ga);
        Nt.push(J)
    }
    const kl = bl ? "disabled" : "default",
        Tl = m && x,
        Ml = mc(),
        _l = !ot || je || Ml,
        Nl = jp(Ot, As, Ut, is),
        ps = Tl ? "streaming" : _l ? "disabled" : "idle",
        gs = i.useRef(null),
        Gt = i.useRef(null),
        {
            value: Al
        } = he("222560275"),
        El = Al || a && !a.startsWith("o1") && !a.startsWith("o3");
    i.useEffect(() => {
        const v = () => {
            gs.current != null && tn.addAction("composer_state_disabled", {
                threadId: St(c),
                disabledReason: gs.current
            })
        };
        if (zt && ps === "disabled") {
            let J = "unknown";
            g ? J = f ? ? "component_disabled_unknown" : m ? J = "completion_in_progress" : ee ? J = "thread_hard_blocked" : je && (J = "starting_new_completion_request"), gs.current !== J && (Gt.current && clearTimeout(Gt.current), Gt.current = setTimeout(v, wf)), gs.current = J
        } else gs.current = null;
        return () => {
            Gt.current && (clearTimeout(Gt.current), Gt.current = null)
        }
    }, [c, zt, ps, g, f, m, ee, je]);
    const Hn = [];
    if (tt ? .label && Hn.push({
            type: tt.type,
            value: tt.label,
            onRemoveRegion: Ko
        }), Fe !== null) {
        const v = !!Fe.gizmo.tags ? .includes(ks.FirstParty);
        Hn.push({
            type: "mention",
            value: Fe.gizmo.display.name,
            icon: e.jsx(Lo, {
                isFirstParty: v,
                src: Fe.gizmo.display.profile_picture_url,
                className: "icon-md"
            }),
            onRemoveRegion: () => {
                Ht(null), y.focus()
            }
        })
    }
    i.useEffect(() => {
        (!R || R.length === 0 || !$e) && (wt.current = !1)
    }, [R, $e]);
    const Rl = (v, J, ge) => {
            wt.current = v >= 0, J && y.setText(ge ? `${ge.title}${ge.body}` : "")
        },
        ra = $e && R && R.length > 0 && !hs && !y.hasMultipleLines() && y.canShowAutocompletion();
    i.useEffect(() => {
        hs ? H ? .() : I ? .()
    }, [hs, H, I]);
    const ia = v => {
            if (Ve > 0) {
                const J = performance.now() - Ve;
                _m.hist(Nm.DEFAULT, "final_user_input_to_submit_ms", [], J)
            }
            ps === "streaming" && (!Lt || y.isEmpty()) ? gl(v) : Ls(v)
        },
        Pl = ka(r, xa.Canvas),
        {
            value: Il
        } = Ae("61299031"),
        Fl = mm(),
        Bl = Pl && Il && !Fl && !rs && !aa;
    i.useEffect(() => {}, [kt, y]), he("3993182790");
    const Dl = e.jsx(Lg, {
            canUseInlineTagging: Hs,
            isDisabled: g,
            clientThreadId: c,
            currentLeafId: se,
            currentRequestId: oe,
            canContinue: b,
            composerController: y,
            suggestions: S,
            isNewThread: u,
            onCreateNewCompletion: s,
            onContinueGenerating: o,
            onResetState: Yo,
            conversationMode: X,
            isShowingAutocomplete: !!ra
        }),
        Ll = X != null && El && hm.includes(X.kind) && e.jsx(pm, {
            clientThreadId: c,
            onTargetedReply: ml
        }),
        Hl = ra && e.jsx("div", {
            className: "absolute left-0 z-[-1] box-border w-full bg-token-main-surface-primary pl-0 max-lg:bottom-full lg:top-full",
            children: e.jsx(af, {
                suggestions: R,
                composerController: y,
                onSelect: T,
                onChange: Rl
            })
        }),
        Ol = e.jsx(Am, {
            composerController: y,
            parsedDocumentHandler: pl
        }),
        Ul = !_ && e.jsx(Di, {
            className: P
        }),
        zl = e.jsx(gm, {
            modelSupportedImageMimeTypes: nt,
            uploadType: Rt.Retrieval,
            attachmentsProductFeature: Ds ? .attachments
        });
    return e.jsxs(fm.Provider, {
        value: as,
        children: [e.jsx(xm, {
            onOauthRedirect: Xo,
            children: e.jsx("form", {
                className: p,
                onSubmit: ia,
                children: e.jsxs("div", {
                    className: "relative z-[1] flex h-full max-w-full flex-1 flex-col",
                    children: [Ul, e.jsxs("div", {
                        ref: w,
                        className: "group relative z-[1] flex w-full items-center",
                        style: {
                            "--force-hide-label": Vo ? "none" : "block"
                        },
                        children: [e.jsxs(Zr, {
                            open: hs || ds || Ns,
                            children: [e.jsx(vm, {
                                className: "w-full",
                                children: e.jsx(uf, {
                                    type: ue ? "temporary" : "default",
                                    ref: Q,
                                    replyRegions: Hn,
                                    placeholder: jl,
                                    inputState: kl,
                                    setIsComposerOverflowing: nl,
                                    composerController: y,
                                    matchaData: k,
                                    leftSideActions: Nt,
                                    topRightAction: Bl && e.jsx(ym, {
                                        composerRef: Q,
                                        composerController: y,
                                        clientThreadId: c
                                    }),
                                    state: ps,
                                    onSubmit: ia,
                                    renderFiles: lt && e.jsxs(e.Fragment, {
                                        children: [Ee === "magic" && e.jsx("div", {
                                            className: "m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",
                                            children: e.jsx(E, { ...Ce.gizmoKnowledgeWarning
                                            })
                                        }), e.jsx(Sm, {
                                            files: ke,
                                            className: "-ml-1.5 flex flex-nowrap gap-2 overflow-x-auto p-1.5"
                                        })]
                                    }),
                                    clientThreadId: c,
                                    gizmoId: Ke ? .gizmo.id,
                                    disableReason: Nl,
                                    modelId: a,
                                    controlsDisabled: us,
                                    setControlsDisabled: al
                                })
                            }), e.jsx(Jr, {
                                children: e.jsxs(Xr, {
                                    side: "bottom",
                                    align: "start",
                                    sideOffset: 12,
                                    onOpenAutoFocus: v => v.preventDefault(),
                                    children: [hs && e.jsx(Zp, {
                                        onClick: v => hl(v),
                                        onClose: () => {
                                            Os(!1), y.focus()
                                        }
                                    }), ds && e.jsx(Qg, {
                                        composerController: y,
                                        clientThreadId: c
                                    })]
                                })
                            })]
                        }), Hl]
                    }), Ol, zl]
                })
            })
        }), Dl, Ll]
    })
}

function Tf(t, s) {
    const o = !s && t.message.author.role === Ne.User && t.message.status === "in_progress",
        n = t.metadata ? .err != null && t.metadata.errCode !== va.ContentPolicy,
        a = t.metadata ? .errCode === va.ModelIncompatibility;
    return t.metadata ? .canRetry === !1 || a ? !1 : o || n
}
const Mf = ({
    clientThreadId: t,
    isNewThread: s,
    currentModelId: o,
    onRequestCompletion: n,
    composerContainerRef: a,
    shouldUseUnifiedComposer: r
}) => {
    const d = xn(),
        h = i.useContext(po),
        c = go(h),
        u = fo(),
        m = xo(),
        p = de(t, x => Tf(K.getCurrentNode(x), !1));
    oi(d);
    const {
        value: g
    } = he("3779321121");
    if (!g && !m && p) return e.jsx(_f, {
        clientThreadId: t
    });
    const f = e.jsxs(e.Fragment, {
        children: [e.jsx(Vp, {
            clientThreadId: t
        }), e.jsx(es, {
            verticalMargin: "none",
            isStaticSharedThread: u,
            verticalPadding: c ? "last-standard" : "none",
            horizontalPadding: "standard",
            children: e.jsx(ts, {
                children: e.jsx(zi, {
                    composerContainerRef: a,
                    clientThreadId: t,
                    currentModelId: o,
                    isNewThread: s,
                    hideHeader: s,
                    onRequestCompletion: n
                })
            })
        })]
    });
    return r ? e.jsx(q.div, {
        layout: !0,
        transition: {
            type: "spring",
            bounce: .1,
            duration: .5
        },
        children: f
    }) : f
};

function _f({
    clientThreadId: t
}) {
    const s = wp({
            clientThreadId: t
        }),
        o = de(t, r => K.getCurrentNode(r).metadata ? .errCode === jc.ModelCapExceeded),
        n = Lm(r => r.isoDate),
        a = co(t);
    return o && n != null && n !== "" ? null : e.jsxs("div", {
        children: [e.jsx("div", {
            className: "mb-3 text-center text-xs",
            "data-has-thread-error": !0,
            children: e.jsx(E, { ...Wa.errorGeneratingResponse
            })
        }), e.jsx("div", {
            className: "flex items-center md:mb-4",
            children: e.jsx(mt, {
                as: "button",
                color: "primary",
                onClick: r => {
                    De.logEvent("chatgpt_regenerate_due_to_error_button_clicked", void 0, Jt({
                        clientThreadId: t
                    })), s({
                        sourceEvent: r,
                        nodeId: a
                    })
                },
                className: "m-auto",
                icon: Lr,
                "data-testid": "regenerate-thread-error-button",
                children: e.jsx(E, { ...Wa.regenerateResponse
                })
            })
        })]
    })
}

function zi({
    clientThreadId: t,
    currentModelId: s,
    isNewThread: o,
    onRequestCompletion: n,
    composerContainerRef: a,
    autocompletions: r,
    matchaData: l,
    requiresFileUpload: d,
    onComposerInput: h,
    onComposerChange: c,
    onAutocompleteSelect: u,
    headerClassName: m,
    hideHeader: p,
    onTaggingDropdownClose: g,
    onTaggingDropdownOpen: f
}) {
    const {
        data: x
    } = gn(), [b, S, M, w, R, k, V] = de(t, A => {
        const re = K.getCurrentLeafId(A);
        return [K.getRequestId(A), A ? .async_status === vr.STREAMING, K.isMessageTurnEnded(A), A ? .tree.getHasErrorFromNode(re) ? ? !1, Cc(K.getMessage(A)), A ? .mode, A ? .continuingFromSharedConversationId != null]
    }), C = bs(), j = Pt(b), T = vc({
        clientThreadId: t
    }), P = yc(), {
        isOpen: _,
        onClose: H
    } = Em({
        type: "just-hit-rate-limit"
    }), {
        value: I
    } = Ae("1988730211"), Q = Cn(), y = i.useCallback(A => {
        F.logEvent(B.continueCompletion);
        const re = Array.from(Q),
            {
                systemHints: ee,
                extraStreamParams: we
            } = I ? Rm(re) : {
                systemHints: re,
                extraStreamParams: {}
            };
        n({
            sourceEvent: A,
            completionType: Sc.Continue,
            extraStreamParams: we,
            completionMetadata: {
                conversationMode: rt(t) ? .mode,
                systemHints: ee
            }
        })
    }, [Q, I, n, t]), W = wr(), ne = i.useCallback(A => {
        Pm({
            clientThreadId: t,
            currentRequestId: A,
            isHistoryAndTrainingDisabled: P,
            queryClient: W
        })
    }, [t, P, W]), Y = i.useCallback(A => {
        Im(t), n({ ...A,
            conduitToken: L.current
        }), L.current = null, se.current = !1
    }, [t, n, null, C ? .normalizedAccountUserId]), ae = Fm(), L = i.useRef(null), se = i.useRef(!1), oe = i.useCallback(() => {
        c ? .()
    }, [t, s, ae, c]), ye = !M && (j || S), fe = i.useMemo(() => ye ? !1 : !w && R, [w, R, ye]), le = ye, Ee = jt(t), Z = Ft(Ee).data, xe = Wr(), Se = de(t, K.getLastValidNode), ue = (() => {
        if (xe ? .messageId === Se.message.id) return xe.suggestions
    })(), Me = bc(), me = Z ? .gizmo.tags ? .includes(ks.WorkspaceDisabled) && !Me ? "workspaceDisallowsGizmo" : x ? .models.size === 0 ? "noModelsAvailable" : k ? .kind === Be.GizmoTest && k.gizmo_id == null ? "noTestGizmoId" : null, be = $c(), Re = ho(), _e = be.action === "moderate", {
        value: He
    } = he("1860647109");
    return e.jsxs(e.Fragment, {
        children: [e.jsx("div", {
            className: "flex justify-center empty:hidden",
            children: Re && _e && He ? e.jsx(Bm, {}) : null
        }), _ ? e.jsx(Dm, {
            onClose: H
        }) : null, e.jsx(kf, {
            composerContainerRef: a,
            clientThreadId: t,
            onCreateNewCompletion: Y,
            onAbortCompletion: ne,
            onContinueGenerating: y,
            currentModelId: s,
            account: C,
            modelCategories: x ? .categories,
            models: x ? .models,
            currentModelConfig: Io(x ? .models, s),
            defaultModelSlug: x ? .defaultModelSlug ? ? null,
            isNewThread: o,
            isCompletionInProgress: T,
            className: "w-full",
            canContinue: fe,
            suggestions: ue ? ? [],
            disabled: !!me,
            disabledReason: me ? ? void 0,
            canPause: le,
            isInteractableSharedThread: V,
            autocompletions: r,
            matchaData: l,
            requiresFileUpload: d,
            onComposerInput: h,
            onComposerChange: oe,
            onAutocompleteSelect: u,
            headerClassName: m,
            hideHeader: p,
            onTaggingDropdownClose: g,
            onTaggingDropdownOpen: f
        }, t)]
    })
}
const Wa = et({
    errorGeneratingResponse: {
        id: "PromptTextarea.errorGeneratingResponse",
        defaultMessage: "There was an error generating a response"
    },
    regenerateResponse: {
        id: "PromptTextarea.regenerateResponse",
        defaultMessage: "Regenerate"
    }
});

function Nf({
    label: t,
    description: s,
    icon: o,
    badge: n,
    onClick: a,
    disabled: r = !1
}) {
    return e.jsxs("button", {
        type: "button",
        disabled: r,
        onClick: a,
        className: N("group relative flex min-w-[162px] flex-col items-start gap-2 rounded-[20px] border border-token-border-light py-3 pl-3 pr-4 text-start text-[13px] leading-[18px] transition enabled:hover:bg-token-main-surface-secondary disabled:cursor-not-allowed"),
        children: [e.jsxs("div", {
            className: "flex w-full items-center justify-between",
            children: [o && e.jsx("div", {
                className: "mr-2",
                children: o
            }), n && e.jsx("span", {
                className: "rounded bg-blue-400 px-1 text-[10px] font-semibold text-white",
                children: n
            })]
        }), e.jsxs("span", {
            className: "block max-w-full select-none font-medium text-token-text-secondary",
            children: [t, s && e.jsx("p", {
                className: "font-normal text-gray-500",
                children: s
            })]
        })]
    })
}

function Af({
    composerBarButtonInfo: t,
    systemHintType: s,
    mobileLayout: o,
    children: n
}) {
    const a = Mi(t.announcementKey, s),
        r = !o && a,
        l = _i(t, n);
    return r ? l : n
}

function Ef(t) {
    const {
        value: s,
        isLoading: o
    } = Ae("2223246572"), n = kn(t), a = i.useMemo(() => n.filter(r => r.suggestedPrompt).sort((r, l) => (r.suggestedPrompt ? .sortOrder ? ? 0) - (l.suggestedPrompt ? .sortOrder ? ? 0)).map(r => ({
        id: r.systemHint,
        label: r.suggestedPrompt ? .title ? ? "",
        description: r.suggestedPrompt ? .subtitle ? ? "",
        icon: e.jsx(_s, {
            svgString: r.logo,
            className: "h-[22px] w-[22px]",
            color: r.suggestedPrompt ? .theme ? ? ""
        }),
        badge: r.suggestedPrompt ? .badge,
        systemHint: r
    })), [n]);
    return {
        replaceStarterPromptsWithToolChips: s,
        isLoading: o,
        toolChips: a
    }
}
const qa = ze(() => Ge(() =>
        import ("./o11fo8c7vh4pckgf.js"), __vite__mapDeps([11, 1, 2, 3, 4, 5, 12, 13, 14, 9, 6, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28])).then(t => t.SnorlaxSplashScreen)),
    qn = 4;

function Rf() {
    const {
        layer: t
    } = uo("4031588851"), s = t.get("autocomplete_qualified_start_date", "2099-09-13T00:00:00Z"), o = bn();
    return !!o && o.created * 1e3 >= new Date(s).getTime()
}
const Vn = t => `${t.title}${t.body}`.toLocaleLowerCase();

function Pf(t) {
    const s = jt(t.clientThreadId),
        o = Ts(s);
    return e.jsx(kr, {
        clientThreadId: t.clientThreadId,
        children: o && s && qa ? e.jsx(qa, {
            clientThreadId: t.clientThreadId,
            gizmoId: s,
            currentModelId: t.currentModelId,
            onRequestCompletion: t.onRequestCompletion
        }) : e.jsx(Df, { ...t
        })
    })
}

function If({
    children: t
}) {
    const {
        store: s
    } = Le(), [o, n] = i.useState(!1), a = xn();
    i.useEffect(() => a.subscribe("focus", () => {
        n(!0)
    }), [a]), i.useEffect(() => a.subscribe("blur", () => {
        n(!1)
    }), [a]);
    const r = s.useSharedProps(),
        l = !!(r != null && r.isShowingAutocomplete);
    return t(l && o)
}

function Ff({
    isSendBlocked: t,
    clientThreadId: s,
    headlineOption: o,
    shouldShowStarterPrompts: n,
    promptChips: a,
    onSelectStarterPrompt: r,
    starterPromptExpanded: l,
    setStarterPromptExpanded: d,
    replaceStarterPromptsWithToolChips: h = !1,
    toolChips: c,
    onSelectToolChip: u,
    selectedHint: m,
    isToolChipsLoading: p = !1
}) {
    const g = ri();
    return e.jsx(If, {
        children: f => e.jsx(q.div, {
            initial: {
                opacity: 0
            },
            animate: {
                opacity: f ? 0 : 1
            },
            exit: {
                opacity: 0
            },
            transition: {
                duration: .1
            },
            className: N("h-full flex-col text-token-text-primary [display:var(--display-hidden-until-loaded,flex)]", {
                "mt-[var(--screen-optical-compact-offset-amount)] flex-shrink items-center justify-center overflow-hidden": !h
            }, f ? "pointer-events-none" : "", g ? "@lg/thread:hidden" : "lg:hidden"),
            children: h && c ? e.jsxs(e.Fragment, {
                children: [e.jsx("div", {
                    className: "h-full"
                }), e.jsx("div", {
                    className: "mx-[-12px]",
                    children: e.jsx(qi, {
                        toolChips: c,
                        onSelectToolChip: u,
                        disabled: t,
                        mobileLayout: !0,
                        selectedHint: m
                    })
                })]
            }) : e.jsxs(e.Fragment, {
                children: [p ? null : o === "CHATGPT_LOGO" ? e.jsx(pn, {
                    className: "inline-block h-12 w-12"
                }) : e.jsx(Gi, {
                    headlineOption: o
                }), e.jsx(q.div, {
                    initial: {
                        opacity: 0
                    },
                    animate: {
                        opacity: 1
                    },
                    transition: {
                        duration: .3
                    },
                    className: N(!l && !h && "h-[116px]"),
                    children: n && e.jsx(Wi, {
                        starterPrompts: a,
                        onSelectStarterPrompt: r,
                        disabled: t,
                        clientThreadId: s,
                        onExpand: () => d(!0),
                        mobileLayout: !0
                    })
                })]
            })
        })
    })
}

function Bf(t) {
    const {
        isUnauthenticated: s
    } = gt(), o = he("1468311859").value, n = he("2053937752").value, a = he("3664702598").value, r = he("471233253").value, {
        layer: l
    } = ht("4031588851"), {
        layer: d
    } = ht("3533083032"), h = Rf(), c = !s && o || s && n, u = (!s && a || s && r) && h;
    let m = "HARDCODED"; {
        const p = s ? d : l;
        if (t) {
            const g = p.get("search_autocomplete_mode", "");
            c && g && (m = g)
        } else u && (m = p.get("autocomplete_mode", "HARDCODED"))
    }
    return m
}

function Df({
    clientThreadId: t,
    currentModelId: s,
    isModelLoaded: o,
    onRequestCompletion: n,
    chatgptHomepageDisclaimer: a,
    shouldUseUnifiedComposer: r = !1
}) {
    const l = xn(),
        d = Vt(t),
        h = mo(),
        [c, u] = i.useState([]);
    i.useState([]), i.useRef(0);
    const [m, p] = i.useState(), g = i.useCallback(z => {
        u(O => {
            const te = typeof z == "function" ? z(O) : z;
            return gr(te, O) ? O : te
        })
    }, []), {
        trendingSuggestions: f,
        fetchTrendingSuggestions: x
    } = Uf(qn), b = i.useRef(!1), {
        isUnauthenticated: S
    } = gt(), M = Hm(), [w, R] = i.useState(!1), k = Si();
    oi(l);
    const V = he("589604007").value,
        {
            layer: C
        } = ht("4031588851"),
        {
            layer: j
        } = uo("3533083032"),
        T = S ? j : C,
        {
            replaceStarterPromptsWithToolChips: P,
            isLoading: _,
            toolChips: H
        } = Ef(t),
        I = Ai(l, t),
        Q = Ni(l),
        {
            prospectiveModelId: y
        } = Om(t),
        W = o ? s : y ? ? "auto",
        ne = d && !T.get("web-disable", !1),
        {
            promptStarters: D,
            isSuccess: Y
        } = Um(ne, t, 8, V, !0, W),
        ae = M && !!c.find(z => !!z.requires_file_upload),
        L = i.useCallback(z => {
            const O = l.getCurrentText();
            return O && Vn(z).startsWith(O.toLocaleLowerCase())
        }, [l]),
        se = i.useCallback(z => {
            const O = l.getCurrentText(),
                te = z.title + z.body;
            return L(z) ? { ...z,
                title: O,
                body: te.slice(O.length)
            } : { ...z,
                title: te,
                body: ""
            }
        }, [l, L]),
        oe = i.useCallback((z = !1) => {
            g(O => !O.some(L) && O.length > 0 ? [] : z ? O : O.map(se))
        }, [L, se, g]),
        ye = (z, O, te, je) => {
            const Ie = O.title;
            g([]), l.focus(), l.setText(Ie), requestAnimationFrame(() => {
                const Ve = (D ? .filter(Oe => Oe.theme === O.theme) ? ? []).map(Oe => {
                    const $e = Et(Oe.oneliner),
                        Ye = $e.startsWith(Oe.title);
                    return { ...Oe,
                        title: Ye ? `${Oe.title} ` : "",
                        body: Ye ? Oe.body : $e,
                        autocompletionChunks: rf(Ie, $e),
                        type: bt.Autocomplete
                    }
                });
                g(Ve), Ve.length > 0 && Yt(Ve, t), Wm(O, je, t)
            })
        };
    i.useEffect(() => {
        const z = c.some(O => O.theme === Xn.Search);
        k && l.getCurrentText() === "" ? f.length > 0 ? g(f) : x() : z && !k && g(O => O.filter(te => te.theme !== Xn.Search))
    }, [c, k, f, x, l, g]), i.useEffect(() => {
        k && l.getCurrentText() === "" && f.length > 0 && Yt(f, t)
    }, [k, l, f, t]);
    const fe = D ? .reduce((z, O) => (O.theme && !z[O.theme] && (z[O.theme] = O), z), {}),
        le = [];
    if (fe)
        for (const z in fe) z !== "For you" && le.push(fe[z]);
    const Ee = le.length > 0,
        Z = !!(ne && Y && Ee && o && !P);
    ne && (yt.markStart("StarterPromptChips", yt.NS_COMPOSER), Z && yt.markRendered("StarterPromptChips", yt.NS_COMPOSER));
    const xe = qn - c.filter(L).length,
        Se = Bf(k),
        ue = T.get("headline_option", "HELP_WITH"),
        Me = C.get("autocomplete_min_char", 4),
        me = C.get("autocomplete_fetch_interval", 200),
        be = i.useRef(null),
        Re = i.useCallback(ai(async z => {
            const O = l.getCurrentText();
            if (!O || O.length < Me || O.length > 80 || l.hasMultipleLines()) {
                g([]);
                return
            }
            if (!b.current && !(be.current && be.current.length > Me && O.startsWith(be.current))) try {
                const te = S ? await Xt.generateAutocompletionsAnon(O, z, k) : await Xt.generateAutocompletions(O, z, k);
                if (te.completions.length === 0) {
                    be.current = O;
                    return
                }
                const je = te.completions.map(Ie => ({
                    id: Yc(),
                    type: bt.Autocomplete,
                    title: Ie.slice(0, O.length),
                    body: Ie.slice(O.length),
                    oneliner: Ie,
                    prompt: Ie,
                    source: Se
                })).filter(L).map(se);
                g(Ie => {
                    const Ve = Ie.filter(L),
                        Oe = je.filter($e => {
                            const Ye = Vn($e);
                            return !Ve.some(wt => {
                                const pe = Vn(wt);
                                if (Ye === pe) return !0;
                                const kt = /[\p{P}\p{S}]$/u,
                                    X = Ye.replace(kt, ""),
                                    Ke = pe.replace(kt, "");
                                return X === pe || Ye === Ke || X === Ke
                            })
                        }).slice(0, qn - Ve.length);
                    return [...Ve, ...Oe]
                }), je.length > 0 && Yt(je, t)
            } catch {}
        }, Se === "BING" ? 150 : me), [l, Se, se, me]);
    ln(z => z.files);
    const He = jn().has($.Research),
        re = He && !1,
        ee = i.useCallback(() => {
            oe(), xe > 0 && Re(xe)
        }, [Re, oe, xe]);
    i.useEffect(() => {
        b.current && g([])
    }, [b, g]);
    const we = i.useMemo(() => Se === "HARDCODED" ? oe : ee, [Se, ee, oe]),
        Bt = !1,
        ns = i.useCallback(() => {
            we()
        }, [we, Bt, re, g]),
        Pe = i.useCallback(() => {
            l instanceof fn && oe(!0), l.getCurrentText().indexOf(`
`) > 0 && (g([]), p(void 0))
        }, [l, g, oe, Bt, re]),
        Ct = i.useCallback((z, O, te) => {
            O.forEach(je => {
                je.id === z.id && (je.userInput = l.getCurrentText())
            }), g([O[te]])
        }, [l, g]),
        We = Ms(),
        it = ri(),
        qe = !1,
        Dt = e.jsxs(e.Fragment, {
            children: [e.jsx("div", {
                className: N("hidden text-center", We && "mb-5", !We && "mb-7", it ? "@lg/thread:block" : "lg:block"),
                children: ue === "CHATGPT_LOGO" ? e.jsx(pn, {
                    className: "inline-block h-12 w-12"
                }) : e.jsx(Gi, {
                    headlineOption: ue,
                    overrideMessage: He ? Kt.deepResearchPlaceholder : void 0
                })
            }), e.jsx(Ff, {
                headlineOption: ue,
                shouldShowStarterPrompts: Z,
                promptChips: le,
                onSelectStarterPrompt: ye,
                starterPromptExpanded: w,
                setStarterPromptExpanded: R,
                isSendBlocked: h,
                clientThreadId: t,
                replaceStarterPromptsWithToolChips: P,
                toolChips: H,
                onSelectToolChip: I,
                selectedHint: Q,
                isToolChipsLoading: _
            }), e.jsx("div", {
                className: N(r ? "absolute bottom-0 left-0 w-full md:fixed md:bottom-5" : it ? "@lg/thread:absolute @lg/thread:bottom-8 @lg/thread:left-0 @lg/thread:w-full" : "[display:var(--display-hidden-until-loaded,block)] lg:absolute lg:bottom-8 lg:left-0 lg:w-full"),
                children: e.jsx(es, {
                    verticalMargin: "none",
                    verticalPadding: "none",
                    horizontalPadding: "standard",
                    children: e.jsx(Ma, {
                        className: "relative @lg/thread:pb-0",
                        children: e.jsx(Di, {
                            className: "block"
                        })
                    })
                })
            })]
        });
    return r ? e.jsx("div", {
        className: "flex grow items-center md:items-end",
        children: Dt
    }) : e.jsx(e.Fragment, {
        children: e.jsx(Ze, {
            children: e.jsx("div", {
                className: N("h-full w-full", qe),
                children: e.jsx(es, {
                    isStaticSharedThread: !1,
                    verticalPadding: "none",
                    horizontalPadding: "standard",
                    fullHeight: !0,
                    children: e.jsxs(Ma, {
                        className: "relative",
                        children: [Dt, e.jsx("div", {
                            className: "w-full",
                            children: e.jsx(zi, {
                                clientThreadId: t,
                                isNewThread: d,
                                currentModelId: s,
                                onRequestCompletion: n,
                                autocompletions: c,
                                matchaData: m,
                                requiresFileUpload: ae,
                                onComposerInput: ns,
                                onComposerChange: Pe,
                                onAutocompleteSelect: Ct,
                                onTaggingDropdownClose: () => {
                                    b.current = !1
                                },
                                onTaggingDropdownOpen: () => {
                                    b.current = !0
                                },
                                hideHeader: !0
                            })
                        }), ne || P ? e.jsxs(q.div, {
                            initial: {
                                opacity: 0
                            },
                            animate: {
                                opacity: 1
                            },
                            transition: {
                                duration: .3
                            },
                            className: N("hidden", it ? "@lg/thread:block" : "lg:block", a && S && w ? "" : !P && "h-[70px]", !P && We && "mt-5 min-h-[108px]"),
                            children: [Z && e.jsx(Wi, {
                                starterPrompts: le,
                                onSelectStarterPrompt: ye,
                                disabled: h,
                                clientThreadId: t,
                                onExpand: () => R(!0)
                            }), P && e.jsx(qi, {
                                toolChips: H,
                                onSelectToolChip: I,
                                disabled: h,
                                selectedHint: Q
                            })]
                        }) : null, a && e.jsx("div", {
                            className: N("w-full translate-y-4 px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden xs:translate-y-8 md:px-[60px]", it ? "@lg/thread:absolute @lg/thread:bottom-0 @lg/thread:left-0" : "lg:absolute lg:bottom-0 lg:left-0"),
                            children: e.jsx("div", {
                                className: N("min-h-4"),
                                children: a
                            })
                        })]
                    })
                })
            })
        })
    })
}

function Gi({
    headlineOption: t,
    overrideMessage: s
}) {
    const n = ce().formatMessage(s ? ? (zf[t] || Kt.whatCanIHelpWith)),
        a = It(),
        r = Ms(),
        l = e.jsxs("div", {
            className: "grid min-h-[74px] grid-cols-1 items-center justify-end",
            children: [e.jsx("h1", {
                className: N("flex h-full items-end justify-center [grid-area:1/1] motion-safe:[transition:0.3s_transform_var(--spring-standard),0.5s_opacity_var(--spring-standard),0.5s_visibility_var(--spring-standard)]", r && "text-[28px] font-semibold leading-[34px] tracking-[0.38px]", a ? "invisible -translate-y-full opacity-0" : "translate-y-0 opacity-100"),
                "aria-hidden": a,
                children: n
            }), e.jsx("div", {
                className: N("flex h-full flex-col items-center justify-end [grid-area:1/1] motion-safe:[transition:0.3s_transform_var(--spring-standard),0.5s_opacity_var(--spring-standard),0.5s_visibility_var(--spring-standard)]", a ? "translate-y-0 opacity-100" : "invisible translate-y-full opacity-0"),
                "aria-hidden": !a,
                children: e.jsx(ii, {})
            })]
        });
    return e.jsxs("div", {
        className: "relative inline-flex justify-center text-center text-2xl font-semibold leading-9",
        children: [r && e.jsx("div", {
            style: {
                viewTransitionName: "var(--vt-splash-screen-headline)"
            },
            children: l
        }), !r && e.jsx("h1", {
            style: {
                viewTransitionName: "var(--vt-splash-screen-headline)"
            },
            children: n
        })]
    })
}

function Lf({
    starterPrompt: t,
    starterPrompts: s,
    index: o,
    disabled: n,
    onSelectStarterPrompt: a
}) {
    const r = t.theme ? ? t.title,
        l = Tn(),
        {
            mutate: d
        } = qm(),
        h = t.category === "onboarding" ? c => {
            d({
                key: Xe.hasUsedConversationalOnboardingStarterPrompt
            }), l(c, t, s, o)
        } : c => a(c, t, s, o);
    return e.jsx(li, {
        disabled: n,
        onClick: h,
        icon: e.jsx(Vm, {
            category: t.category,
            useV2Colors: !0
        }),
        label: r
    })
}

function Va({
    clientThreadId: t,
    onClick: s
}) {
    i.useEffect(() => {
        $m(t)
    }, [t]);
    const o = ce();
    return e.jsx(q.div, {
        initial: {
            opacity: 0
        },
        animate: {
            opacity: 1
        },
        exit: {
            opacity: 0
        },
        transition: {
            duration: .3,
            ease: "easeOut"
        },
        className: "inline-block",
        children: e.jsx(li, {
            onClick: () => {
                Ym(t), s()
            },
            label: o.formatMessage(Kt.moreStarterPrompts)
        })
    })
}
const Hf = 5,
    Of = 3;

function Wi({
    starterPrompts: t,
    onSelectStarterPrompt: s,
    disabled: o,
    clientThreadId: n,
    onExpand: a,
    mobileLayout: r = !1
}) {
    const l = r ? Of : Hf,
        [d, h] = i.useState(l),
        [c, u] = i.useState(!1),
        m = i.useRef(null),
        p = t.length <= d;
    i.useEffect(() => {
        Yt(t.slice(0, l), n)
    }, [n]), i.useEffect(() => {
        if (!c && !p && m.current) {
            const f = m.current,
                x = f.getBoundingClientRect(),
                b = x.width,
                S = Array.from(f.children);
            let M = 0;
            for (let w = 0; w < S.length && S[w].getBoundingClientRect().right - x.left <= b; w++) M++;
            h(M), u(!0)
        }
    }, [t, p, c]);
    const g = () => {
        const f = t.slice(d, t.length).map(x => ({ ...x,
            isAdditional: !0
        }));
        f.length > 0 && Yt(f, n), h(t.length), a()
    };
    return e.jsxs("div", {
        className: N("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5", c && t.length > 0 ? "opacity-100" : "opacity-[0.01]", r ? "flex-wrap" : "flex-nowrap"),
        children: [e.jsxs("ul", {
            className: N("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5", p || r ? "flex-wrap justify-center" : "flex-nowrap justify-start"),
            ref: m,
            children: [t.slice(0, d).map((f, x) => e.jsx(q.li, {
                initial: {
                    opacity: 0
                },
                animate: {
                    opacity: 1
                },
                exit: {
                    opacity: 0
                },
                transition: {
                    duration: .3,
                    ease: "easeOut"
                },
                children: e.jsx(Lf, {
                    starterPrompt: f,
                    starterPrompts: t,
                    index: x,
                    disabled: o,
                    onSelectStarterPrompt: s
                })
            }, f.id ? ? x)), r && t.length > d && e.jsx(Va, {
                clientThreadId: n,
                onClick: g
            })]
        }), !r && t.length > d && e.jsx(Va, {
            clientThreadId: n,
            onClick: g
        })]
    })
}

function qi({
    toolChips: t,
    onSelectToolChip: s,
    disabled: o,
    mobileLayout: n = !1,
    selectedHint: a
}) {
    const r = ei(),
        l = Ms(),
        d = !r && l;
    return e.jsx("div", {
        className: N("mt-5 min-h-[108px] gap-x-2 transition-opacity xl:gap-x-2.5", t.length > 0 ? "opacity-100" : "opacity-[0.01]", {
            "flex flex-wrap justify-center": !n
        }),
        children: e.jsx("ul", {
            className: N("relative flex gap-3 sm:gap-y-2", !l && "py-2", {
                "w-full snap-x snap-proximity flex-nowrap overflow-x-auto scroll-smooth whitespace-nowrap px-3": n
            }, {
                "flex-wrap justify-start": !n
            }),
            children: t.map(({
                id: h,
                label: c,
                description: u,
                icon: m,
                systemHint: p,
                badge: g
            }, f) => {
                const x = e.jsx(Nf, {
                    label: c,
                    description: u,
                    icon: m,
                    badge: g,
                    onClick: () => {
                        p && s({
                            hint: p,
                            enable: p.systemHint !== a
                        })
                    },
                    disabled: o,
                    mobileLayout: n
                });
                return e.jsx(q.li, {
                    initial: {
                        opacity: d ? 0 : 1
                    },
                    animate: d ? {
                        opacity: 1
                    } : !1,
                    exit: {
                        opacity: 0
                    },
                    transition: {
                        type: "spring",
                        stiffness: 175,
                        damping: 26
                    },
                    className: N({
                        "shrink-0": n
                    }),
                    children: p.composerBarButtonInfo ? e.jsx(Af, {
                        composerBarButtonInfo: p.composerBarButtonInfo,
                        systemHintType: p.systemHint,
                        mobileLayout: n,
                        children: x
                    }) : x
                }, h ? ? f)
            })
        })
    })
}
const Uf = t => {
    const [s, o] = i.useState([]), n = i.useCallback(async () => {
        const r = (await Xt.generateTrendingSuggestions(t)).suggestions.map((l, d) => ({
            type: bt.Trending,
            title: $a(l),
            body: "",
            icon: e.jsx(zm, {
                className: "h-full w-full"
            }),
            prompt: $a(l),
            id: `search-trending-${d}`,
            theme: Xn.Search
        }));
        o(r)
    }, [t]);
    return {
        trendingSuggestions: s,
        fetchTrendingSuggestions: n
    }
};

function $a(t) {
    return t.split(" ").map(Gm).join(" ")
}
const Kt = et({
        whatCanIHelpWith: {
            id: "SplashScreenV2.whatCanIHelpWith",
            defaultMessage: "What can I help with?"
        },
        whereShouldWeStart: {
            id: "SplashScreenV2.whereShouldWeStart",
            defaultMessage: "Where should we start?"
        },
        askChatgptAnything: {
            id: "SplashScreenV2.askChatgptAnything",
            defaultMessage: "Ask ChatGPT anything"
        },
        moreStarterPrompts: {
            id: "SplashScreenV2.moreStarterPrompts",
            defaultMessage: "More"
        },
        deepResearchPlaceholder: {
            id: "G1v9do",
            defaultMessage: "What are you researching?"
        }
    }),
    zf = {
        HELP_WITH: Kt.whatCanIHelpWith,
        WHERE_TO_START: Kt.whereShouldWeStart,
        ASK_CHATGPT: Kt.askChatgptAnything
    };

function Gf({
    clientThreadId: t,
    currentModelId: s,
    isModelLoaded: o,
    onRequestCompletion: n,
    chatgptHomepageDisclaimer: a,
    shouldUseUnifiedComposer: r
}) {
    const l = Pf;
    return e.jsx(l, {
        clientThreadId: t,
        currentModelId: s,
        isModelLoaded: o,
        onRequestCompletion: n,
        chatgptHomepageDisclaimer: a,
        shouldUseUnifiedComposer: r
    })
}

function Wf({
    clientThreadId: t,
    currentModelId: s,
    isModelLoaded: o,
    onRequestCompletion: n,
    showChatgptHomepage: a,
    chatgptHomepageDisclaimer: r,
    shouldUseUnifiedComposer: l
}) {
    const d = It(),
        h = Ms();
    let c = e.jsx(Ep, {}),
        u;
    return d && !h ? (u = e.jsx(ii, {}), c = e.jsx(pn, {
        className: "mb-6 h-12 w-12 brand:hidden"
    })) : t != null ? (u = a ? e.jsx(Gf, {
        clientThreadId: t,
        currentModelId: s,
        isModelLoaded: o,
        onRequestCompletion: n,
        chatgptHomepageDisclaimer: r,
        shouldUseUnifiedComposer: l
    }) : e.jsx(Rp, {
        clientThreadId: t
    }), c = null) : u = e.jsx(qf, {}), e.jsxs("div", {
        className: "flex h-full flex-col items-center justify-center text-token-text-primary",
        children: [c, u]
    })
}

function qf() {
    return e.jsx("div", {
        className: "mb-5 text-2xl font-semibold",
        children: e.jsx(E, { ...$f.howCanIHelpYouToday
        })
    })
}

function Vf({
    clientThreadId: t,
    currentModelId: s,
    isModelLoaded: o,
    onRequestCompletion: n,
    showChatgptHomepage: a,
    chatgptHomepageDisclaimer: r,
    shouldUseUnifiedComposer: l
}) {
    const d = jt(t),
        h = yr(),
        c = mo(),
        {
            data: u
        } = Ft(d);
    return (h != null || d != null) && u == null ? null : e.jsx("div", {
        className: "relative h-full",
        children: u != null ? e.jsx(Ap, {
            gizmo: u,
            showStarterPrompts: !0,
            disableStarterPrompts: c
        }) : e.jsx(Wf, {
            clientThreadId: t,
            currentModelId: s,
            isModelLoaded: o,
            onRequestCompletion: n,
            showChatgptHomepage: a,
            chatgptHomepageDisclaimer: r,
            shouldUseUnifiedComposer: l
        })
    })
}
const $f = et({
    temporaryChat: {
        id: "GizmoLanding.temporaryChat",
        defaultMessage: "Temporary Chat"
    },
    temporaryChatBizMemoryAvailable: {
        id: "g1opBW",
        defaultMessage: "This chat won't appear in your history and won't use or create memories."
    },
    temporaryChatBizMemoryUnavailable: {
        id: "fQmbtG",
        defaultMessage: "This chat won't appear your conversation history."
    },
    temporaryChatDescriptionMemoryAvailable: {
        id: "GizmoLanding.temporaryChatDescriptionMemoryAvailable",
        defaultMessage: "This chat won't appear in history, use or create memories, or be used to train our models. For safety purposes, we may keep a copy for up to 30 days."
    },
    temporaryChatDescriptionMemoryUnavailable: {
        id: "GizmoLanding.temporaryChatDescriptionMemoryUnavailable",
        defaultMessage: "This chat won't appear in history or be used to train our models. For safety purposes, we may keep a copy of this chat for up to 30 days."
    },
    temporaryChatDescriptionGptActions: {
        id: "GizmoLanding.temporaryChatDescriptionGptActions",
        defaultMessage: "Any data shared with a third party through GPT actions are subject to the third party's privacy policy. <link>Learn more</link>"
    },
    howCanIHelpYouToday: {
        id: "GizmoLanding.howCanIHelpYouToday",
        defaultMessage: "How can I help you today?"
    }
});

function Vi(t) {
    const {
        currentModelId: s
    } = Tr(), o = ws(t), [n, a] = de(t, m => [K.hasUserMessage(m), K.getGizmoId(m)]), r = It(), l = Fo(s), d = Vt(t) && !n && (Zs(o) || o ? .kind === Be.GizmoTest), h = Ts(a);
    return {
        showEmptyState: d,
        canUseNewHomepage: d && h || d && !a && !l && !r
    }
}
const Ya = Ue.button `max-w-28 xs:max-w-40 sm:max-w-60 md:max-w-none group flex cursor-pointer items-center gap-1 rounded-lg py-1.5 ${({$shimmer:t})=>t?"loading-shimmer":""} px-1 text-lg hover:bg-token-main-surface-secondary radix-state-open:bg-token-main-surface-secondary font-semibold text-token-text-secondary overflow-hidden whitespace-nowrap`;

function Yf({
    conversation: t,
    gizmoResource: s,
    elementRef: o
}) {
    const a = de(t.id, r => r ? .title ? ? null) ? ? t.title;
    return e.jsx(on, {
        to: Xm(t.id, s),
        children: e.jsx(ie.Item, {
            onSelect: () => {
                F.logEvent(B.projectsBreadcrumbPickerPickConversation)
            },
            icon: Zm,
            children: e.jsx("div", {
                ref: o,
                children: a
            })
        }, t.id)
    })
}

function Kf({
    gizmoId: t,
    clientThreadId: s,
    inMobileHeader: o,
    modelLabel: n
}) {
    const a = ce(),
        r = Eo(t),
        l = !r,
        d = _o(),
        h = No(s, d, r),
        {
            data: c
        } = Ft(t),
        {
            items: u,
            hasNextPage: m,
            fetchNextPage: p,
            isLoading: g,
            isFetchingNextPage: f
        } = Km(t),
        x = i.useRef(null),
        b = i.useCallback(_ => {
            g || _ == null || (x.current ? .disconnect(), x.current = new IntersectionObserver(H => {
                H[0].isIntersecting && m && p()
            }), x.current.observe(_))
        }, [g, m, p]);
    i.useEffect(() => () => {
        x.current ? .disconnect()
    }, []);
    const [S, M, w] = de(s, _ => [_ ? .isLoading, _ ? .title ? ? null, K.getThreadTitleSource(_)]), {
        showEmptyState: R
    } = Vi(s), k = a.formatMessage(Jn.newChatTitle), {
        resolvedTitle: V,
        isTypingEffect: C
    } = Qm(s, M, !0);
    if (!c || R) return null;
    const j = V == null && (Vt(s) || w === wc.NewChat),
        T = S ? e.jsx(e.Fragment, {}) : e.jsxs(Ya, {
            $shimmer: j,
            children: [e.jsxs("div", {
                className: "truncate",
                children: [C ? e.jsx(eh, {
                    text: V ? ? ""
                }) : V ? ? k, l && e.jsx("span", {
                    className: "relative bottom-[1px] mx-1 inline-block rounded-md bg-token-main-surface-secondary px-1 text-xs leading-4 text-token-text-secondary",
                    children: n
                })]
            }), e.jsx(di, {
                className: "icon-md text-token-text-tertiary"
            })]
        }),
        P = c.gizmo.display.name;
    return e.jsxs("div", {
        className: "flex items-center gap-0 overflow-hidden whitespace-nowrap px-2 py-1.5",
        children: [e.jsx(Ya, {
            children: e.jsx(on, {
                className: "truncate",
                to: _a(c),
                children: P
            })
        }), e.jsxs(e.Fragment, {
            children: [e.jsx(kc, {
                className: "icon-md text-token-text-tertiary"
            }), e.jsxs(Cs, {
                contentAlign: o ? "center" : "start",
                size: "small",
                onOpenChange: _ => {
                    _ && F.logEvent(B.projectsBreadcrumbPickerOpen)
                },
                triggerButton: T,
                contentClassName: "max-h-[50dvh] overflow-y-scroll",
                children: [l && e.jsxs(ie.Sub, {
                    onOpenChange: _ => {
                        _ && F.logEvent(B.projectsBreadcrumbPickerModelPickerOpen)
                    },
                    children: [e.jsx(ie.SubMenuTrigger, {
                        children: e.jsxs("div", {
                            className: "flex w-full items-center justify-between gap-1",
                            children: [e.jsx(E, {
                                id: "ilkdMh",
                                defaultMessage: "Model"
                            }), e.jsx("span", {
                                className: "text-xs font-medium text-token-text-secondary",
                                children: n
                            })]
                        })
                    }), e.jsx(ie.Portal, {
                        children: e.jsx(ie.SubContent, {
                            onClick: () => {
                                F.logEvent(B.projectsBreadcrumbPickerModelPickerSelect)
                            },
                            children: e.jsx(ci, {
                                sections: h
                            })
                        })
                    })]
                }), e.jsx(on, {
                    to: _a(c),
                    children: e.jsx(ie.Item, {
                        onSelect: () => {
                            F.logEvent(B.projectsBreadcrumbPickerPickNewChat)
                        },
                        icon: Jm,
                        children: e.jsx(E, { ...Jn.newChatProjectDropdownItem,
                            values: {
                                name: `"${c.gizmo.display.name}"`
                            }
                        })
                    }, "new-chat")
                }), u.filter(_ => _.id !== s).map((_, H) => {
                    const I = m && H === u.length - 4 ? b : void 0;
                    return e.jsx(Yf, {
                        elementRef: I,
                        conversation: _,
                        gizmoResource: c
                    }, _.id)
                }), f && e.jsx("div", {
                    className: "m-4 mb-5 flex justify-center",
                    children: e.jsx(lo, {})
                })]
            })]
        })]
    })
}
const Qf = ze(() => Ge(() =>
        import ("./kwbqv9yr0idp2qh5.js"), __vite__mapDeps([29, 3, 1, 4, 2, 5, 30])).then(t => t.ThreadHeaderGizmoDropdown)),
    Jf = ze(() => Ge(() =>
        import ("./l3fgg12n4wcqbxtx.js"), __vite__mapDeps([31, 1, 2, 3, 4, 5, 32, 33, 14, 9, 34, 35, 36, 37, 38, 22, 24, 25, 39, 17, 18, 19, 20, 21, 23, 26, 27, 28])).then(t => t.ConversationHeaderMenuItems));

function Xf({
    modelLabel: t
}) {
    return e.jsx("span", {
        className: "overflow-x-clip text-ellipsis text-token-text-secondary",
        children: t
    })
}
const Zf = ({
    clientThreadId: t
}) => {
    const s = _o(),
        o = No(t, s);
    return e.jsx(ci, {
        sections: o
    })
};

function ex({
    clientThreadId: t,
    inMobileHeader: s
}) {
    const {
        isLoading: o,
        data: n
    } = gn(), a = Tc(), l = Bo(t).id;
    yt.markStart("ThreadModelSelector");
    const {
        modelLabel: d,
        omitPrefix: h
    } = ui(l, n), c = ce(), {
        isUnauthenticated: u
    } = gt(), m = !u && !a;
    d && yt.markRendered("ThreadModelSelector");
    const p = e.jsxs("div", {
            className: "text-token-text-secondary",
            children: [h ? null : `${sh} `, m ? e.jsx("span", {
                className: "text-token-text-secondary",
                children: d
            }) : u && d ? e.jsx(Xf, {
                modelLabel: d
            }) : null]
        }),
        g = e.jsxs(th, {
            style: {
                viewTransitionName: "var(--vt-thread-model-switcher)"
            },
            "aria-label": d ? c.formatMessage({
                id: "JrtGPQ",
                defaultMessage: "Model selector, current model is {modelLabel}"
            }, {
                modelLabel: d
            }) : "",
            children: [p, e.jsx(di, {
                className: "icon-md text-token-text-tertiary"
            })]
        });
    return o ? g : e.jsx(Cs, {
        sideOffset: 8,
        size: "large",
        triggerButton: g,
        onOpenChange: f => {
            F.logEvent(B.toggleModelSwitcher, {
                isOpen: f
            }), De.logEvent("toggle_model_switcher", null, {
                isOpen: String(f)
            })
        },
        contentAlign: s ? "center" : "start",
        testId: "model-switcher-dropdown",
        children: e.jsx(Zf, {
            clientThreadId: t
        })
    })
}

function Ka({
    clientThreadId: t,
    inMobileHeader: s = !1
}) {
    const o = jt(t),
        n = Ts(o),
        a = Eo(o),
        {
            showEmptyState: r
        } = Vi(t),
        {
            data: l
        } = Ft(o),
        {
            data: d
        } = gn(),
        c = Bo(t).id,
        {
            modelLabel: u
        } = ui(c, d),
        m = e.jsx(ex, {
            clientThreadId: t,
            inMobileHeader: s
        });
    return o == null ? a ? e.jsx(Jf, {
        clientThreadId: t
    }) : m : n ? r && l && !a ? m : e.jsx(Kf, {
        modelLabel: u ? ? "",
        gizmoId: o,
        clientThreadId: t,
        inMobileHeader: s
    }) : e.jsx(Qf, {
        clientThreadId: t,
        gizmoId: o,
        inMobileHeader: s
    })
}
const tx = ({
        clientThreadId: t
    }) => {
        const s = Po(m => m.activeStageSidebar),
            o = ss(t),
            n = nh(Js.WorkspaceShareLinks),
            {
                isUnauthenticated: a
            } = gt(),
            r = It(),
            l = jt(t),
            d = Ts(l),
            h = oh(),
            c = n && o && !a && !r && !d && !h,
            u = !s;
        return e.jsx("div", {
            className: "flex items-center gap-2 pr-1 leading-[0]",
            children: e.jsx(rd, {
                showShareButton: c,
                showProfileDropdown: u,
                clientThreadId: t
            })
        })
    },
    sx = ze(() => Ge(() =>
        import ("./ouycf512rfb59aed.js"), __vite__mapDeps([40, 1, 3, 4, 41, 42, 2, 5, 43, 44, 45, 46, 24, 22, 9, 25, 30, 47, 38, 39, 48, 49, 18, 17, 19, 50])).then(t => t.GizmoUsingAsOwnerNotice));

function nx({
    clientThreadId: t,
    isEmptyState: s
}) {
    const o = jt(t),
        n = fo(),
        a = ah(),
        {
            data: r
        } = Ft(o),
        l = bs(),
        d = yo(),
        h = !1;
    return n ? null : e.jsxs(e.Fragment, {
        children: [e.jsxs(rh, {
            className: N("max-md:hidden", s && "absolute left-0 right-0", h),
            children: [e.jsxs("div", {
                className: "absolute start-1/2 ltr:-translate-x-1/2 rtl:translate-x-1/2",
                children: [r != null && l ? .isWorkspaceAccount() && r.gizmo.tags ? .includes(ks.WorkspaceDisabled) && e.jsx(sx, {
                    gizmo: r
                }), e.jsx(ih, {
                    gizmoId: o,
                    clientThreadId: t
                })]
            }), e.jsxs("div", {
                className: "flex items-center gap-0 overflow-hidden",
                children: [e.jsx(id, {
                    clientThreadId: t
                }), d ? e.jsx(lh, {
                    children: e.jsx(Ka, {
                        clientThreadId: t
                    })
                }) : e.jsx(Ka, {
                    clientThreadId: t
                })]
            }), e.jsx(tx, {
                clientThreadId: t
            })]
        }), a && e.jsx(ch, {})]
    })
}
const ox = "bg-token-main-surface-primary text-token-text-primary",
    ax = "openai",
    Qa = ["bg-blue-300 text-white"];

function rx(t) {
    return Qa[(t ? .charCodeAt(0) ? ? 0) % Qa.length]
}
const Qs = ({
    children: t
}) => e.jsx("div", {
    className: "pt-0",
    children: e.jsx("div", {
        className: N(i.isValidElement(t) && t.type === Zn ? "gizmo-bot-avatar" : "gizmo-shadow-stroke", "flex h-8 w-8 items-center justify-center overflow-hidden rounded-full"),
        children: t
    })
});

function io(t) {
    const {
        messages: s,
        isUserTurn: o,
        avatarClassName: n,
        gizmo: a
    } = t, r = "medium", d = s[0] ? .message.metadata ? .shared_conversation_id, h = d != null, c = bn(), {
        gizmoEditorData: u,
        mode: m
    } = yn();
    let p = e.jsx(Qs, {
        children: e.jsx(Zn, {
            className: n ? ? ox,
            iconName: ax,
            size: r
        })
    });
    return a ? p = e.jsx(Qs, {
        children: e.jsx(_p, {
            gizmoId: a.gizmo.id,
            className: "h-full w-full"
        })
    }) : u != null && m === "test" && (p = e.jsx(Lo, {
        isFirstParty: !1,
        src: u.profilePictureUrl,
        className: "h-8 w-8 first:pt-[3px]"
    })), e.jsx("div", {
        className: void 0,
        children: o ? h ? e.jsx(Qs, {
            children: e.jsx(Zn, {
                className: rx(d),
                iconName: "user",
                size: r
            })
        }) : e.jsx(Qs, {
            children: e.jsx(dh, {
                user: c,
                size: r
            })
        }) : p
    })
}
const Ja = ze(() => Ge(() =>
    import ("./csho1v5a5zmkk18o.js"), __vite__mapDeps([51, 3, 1, 4, 2, 5, 52])).then(t => t.MemoryActionResult));

function Xa(t, s, o) {
    Ac.updateTree(t, n => {
        n.updateNodeMetadata(s, {
            inlineComparisonRating: o
        })
    })
}
const Za = ({
    messages: t
}) => {
    for (const {
            message: {
                metadata: s
            }
        } of t) {
        const {
            augmented_paragen_prompt_label: o
        } = s ? ? {};
        if (o) return o
    }
};

function ix(t) {
    const s = i.useRef({
            left_visibility_initial: null,
            left_visibility_max: null,
            right_visibility_initial: null,
            right_visibility_max: null
        }),
        o = i.useRef({
            left: null,
            right: null
        });
    return t.stubSideBySideFeedback ? e.jsx($i, {
        setPreferredFeedback: () => {},
        leftVariantId: "left-placeholder",
        rightVariantId: "right-placeholder",
        leftTurn: null,
        rightTurn: null,
        originalTurn: null,
        hasActiveRequest: !0,
        visibilityStateRef: s,
        firstVisibleTokenTimestampsRef: o,
        ...t
    }) : e.jsx(lx, { ...t,
        visibilityStateRef: s,
        firstVisibleTokenTimestampsRef: o
    })
}

function lx(t) {
    const {
        clientThreadId: s,
        variantIds: o,
        turnIndex: n,
        firstVisibleTokenTimestampsRef: a
    } = t;
    if (o.length !== 2) throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");
    const r = Uo(),
        l = xo(),
        d = Mc(),
        [h, c] = i.useMemo(() => mi(o.join(""))() < .5 ? [0, 1] : [1, 0], [o[0], o[1]]),
        u = h < c ? "left" : "right",
        m = u === "left" ? "right" : "left",
        p = o[h],
        g = o[c],
        [f, x] = de(s, C => [Et(C).tree.getLeafFromNode(p).id, Et(C).tree.getLeafFromNode(g).id]),
        b = Et(sn(s, n, f)),
        S = Et(sn(s, n, x)),
        M = u === "left" ? b : S,
        w = u === "left" ? S : b,
        R = r ? "skippable_parallel_2_in_stream:a:2.0" : "skippable_parallel_2_in_stream:a:1.5";
    i.useEffect(() => (Na.setState({
        displayingSideBySideFeedback: !0
    }), () => {
        Na.setState({
            displayingSideBySideFeedback: !1
        })
    }), []), uh();
    const k = i.useRef({
        left_visibility_initial: null,
        left_visibility_max: null,
        right_visibility_initial: null,
        right_visibility_max: null
    });
    i.useEffect(() => _c(Nc, {
        requestCompletion: () => {
            const C = St(s),
                T = K.getTree(rt(s)).getParentPromptNode(f),
                P = [b, S].map((I, Q) => ({
                    messageId: I.messages[I.messages.length - 1].message.id,
                    loadFirstTokenTime: Q === 0 ? a.current.left : a.current.right,
                    loadEndTime: Qt(I.messages) ? .completionSampleFinishTime
                })),
                _ = {},
                H = T.metadata ? .variantsInStreamInfo == null && T.message.metadata ? .paragen_variants_info != null;
            for (const I of P) _[I.messageId] = H ? {
                load_first_token_time: t.conversationTurnMountTime,
                load_end_time: t.conversationTurnMountTime
            } : {
                load_first_token_time: I.loadFirstTokenTime,
                load_end_time: I.loadEndTime
            };
            ar({
                params: {
                    conversation_id: C,
                    displayed_message_ids: P.map(I => I.messageId),
                    message_metadatas: _,
                    rating: "skipped",
                    selected_message_id: null,
                    source_timestamp: Date.now(),
                    ui_variant: r ? 2 : 1,
                    user_prompt_message_id: T.message.id
                }
            })
        }
    }), [b, S, f, s, t.conversationTurnMountTime, R, m, M ? .messages, w ? .messages, d, r, a]);
    const V = C => {
        vs(s, W => {
            Sr.setCurrentBranch(W, C)
        });
        const j = C === p,
            T = j === (u === "left");
        M.messages.length > 0 && Xa(s, M.messages[M.messages.length - 1].nodeId, T ? "original" : "new"), w.messages.length > 0 && Xa(s, w.messages[w.messages.length - 1].nodeId, T ? "original" : "new");
        const P = St(s),
            _ = [b, S].map((W, ne) => ({
                messageId: W.messages[W.messages.length - 1].message.id,
                loadFirstTokenTime: ne === 0 ? a.current.left : a.current.right,
                loadEndTime: Qt(W.messages) ? .completionSampleFinishTime
            })),
            H = j ? _[0].messageId : _[1].messageId,
            I = K.getParentPromptNode(rt(s), f),
            Q = {},
            y = I.metadata ? .variantsInStreamInfo == null && I.message.metadata ? .paragen_variants_info != null;
        for (const W of _) Q[W.messageId] = y ? {
            load_first_token_time: t.conversationTurnMountTime,
            load_end_time: t.conversationTurnMountTime
        } : {
            load_first_token_time: W.loadFirstTokenTime,
            load_end_time: W.loadEndTime
        };
        ar({
            params: {
                conversation_id: P,
                displayed_message_ids: _.map(W => W.messageId),
                message_metadatas: Q,
                rating: "selected",
                selected_message_id: H,
                source_timestamp: Date.now(),
                ui_variant: r ? 2 : 1,
                user_prompt_message_id: I.message.id
            }
        })
    };
    return e.jsx($i, { ...t,
        setPreferredFeedback: V,
        leftVariantId: p,
        rightVariantId: g,
        leftTurn: b,
        rightTurn: S,
        hasActiveRequest: l,
        originalTurn: M,
        visibilityStateRef: k
    })
}

function $i({
    setPreferredFeedback: t,
    leftVariantId: s,
    rightVariantId: o,
    leftTurn: n,
    rightTurn: a,
    hasActiveRequest: r,
    originalTurn: l,
    visibilityStateRef: d,
    ...h
}) {
    const {
        defaultParagenLabel: c,
        shouldShowParagenLabels: u = !1
    } = Ur(), m = n && Za(n) || c, p = a && Za(a) || c, g = i.useMemo(() => n ? .messages ? ? [], [n ? .messages]), f = i.useMemo(() => a ? .messages ? ? [], [a ? .messages]), {
        avatarClassName: x,
        firstVisibleTokenTimestampsRef: b
    } = h, S = i.useMemo(() => un(g), [g]), M = i.useMemo(() => un(f), [f]), w = Hr(), R = Pt(n ? nn.getRequestIdFromConversationTurn(n) : ""), k = Pt(a ? nn.getRequestIdFromConversationTurn(a) : ""), V = n ? .role === Ne.User, C = a ? .role === Ne.User, j = i.useRef(null), T = i.useRef(null), P = i.useRef(null), _ = !!h.stubSideBySideFeedback, H = !!h.stubSideBySideFeedback;
    !_ && b.current.left == null && (b.current.left = Date.now()), !H && b.current.right == null && (b.current.right = Date.now()), i.useEffect(() => {
        if (j.current && T.current && P.current) {
            const W = Array(11).fill(0).map((D, Y) => Y / 10),
                ne = new IntersectionObserver(D => D.forEach(Y => {
                    Y.target === T.current ? (d.current.left_visibility_initial == null && (d.current.left_visibility_initial = Y.intersectionRatio), d.current.left_visibility_max = Math.max(d.current.left_visibility_max ? ? 0, Y.intersectionRatio)) : Y.target === P.current && (d.current.right_visibility_initial == null && (d.current.right_visibility_initial = Y.intersectionRatio), d.current.right_visibility_max = Math.max(d.current.right_visibility_max ? ? 0, Y.intersectionRatio))
                }), {
                    root: j.current,
                    threshold: W
                });
            return ne.observe(T.current), ne.observe(P.current), () => ne.disconnect()
        }
    }, [d]);
    const {
        data: I
    } = Or(void 0, !1, w), Q = Uo(), y = e.jsx("div", {
        className: "text-pretty px-6 pb-5 pt-1 text-center text-sm text-token-text-secondary",
        children: e.jsx(E, {
            id: "TK934w",
            defaultMessage: "Which response do you prefer? Responses may take a moment to load."
        })
    });
    return e.jsxs("div", {
        className: "relative flex flex-col",
        children: [e.jsxs("div", {
            className: N("sticky top-[-1px] z-[1] text-pretty bg-token-main-surface-primary px-6 text-center text-lg", Q ? "md:top-header-height" : "md:static"),
            "data-testid": "paragen-feedback-title",
            children: [e.jsx(E, {
                id: "JgCHDY",
                defaultMessage: "You’re giving feedback on a new version of ChatGPT."
            }), Q ? y : null]
        }), Q ? null : y, e.jsx("div", {
            className: "relative -mb-2 snap-x snap-mandatory overflow-x-auto overflow-y-clip px-3 pb-4 md:px-5 lg:px-10",
            ref: j,
            children: e.jsx("div", {
                className: "min-w-fit",
                children: e.jsxs("div", {
                    className: N("mx-auto flex max-w-6xl items-start", Q && "divide-x divide-token-border-medium dark:divide-token-border-heavy", !Q && "gap-4 sm:gap-6"),
                    children: [e.jsxs(er, {
                        horizontalScrollContainerRef: j,
                        rootElementRef: T,
                        onClick: () => {
                            t(s)
                        },
                        hasActiveRequest: r,
                        isWaitingOnFirstUserVisibleToken: _,
                        children: [e.jsxs(nr, {
                            children: [e.jsx(io, {
                                messages: g,
                                isUserTurn: V,
                                avatarClassName: x
                            }), e.jsx(sr, {
                                children: u ? e.jsx("span", {
                                    className: "font-bold text-token-text-primary",
                                    children: m
                                }) : e.jsx(E, { ...rr.responseNumber,
                                    values: {
                                        responseIndex: 1
                                    }
                                })
                            })]
                        }), Q && _ ? e.jsx(tr, {}) : e.jsxs(e.Fragment, {
                            children: [I != null && !V && e.jsx(Ja, {
                                clientThreadId: h.clientThreadId,
                                messages: g,
                                isParagen: !0
                            }), e.jsx(so, { ...h,
                                allMessages: g,
                                groupedMessagesToRender: S,
                                allGroupedMessages: S,
                                isEditing: !1,
                                isUserTurn: V,
                                isCompletionRequestInProgress: R,
                                hasActiveRequest: r,
                                handleEnterEdit: Ws,
                                handleExitEdit: Ws,
                                shouldGrowContainer: !1,
                                showEditButton: !1,
                                showCopyButton: !1,
                                isParagen: !0
                            }), e.jsx(or, {
                                clientThreadId: h.clientThreadId,
                                conversationTurnMountTime: h.conversationTurnMountTime,
                                turn: n,
                                originalTurn: l
                            })]
                        })]
                    }), e.jsxs(er, {
                        horizontalScrollContainerRef: j,
                        rootElementRef: P,
                        onClick: () => {
                            t(o)
                        },
                        hasActiveRequest: r,
                        isWaitingOnFirstUserVisibleToken: H,
                        children: [e.jsxs(nr, {
                            children: [e.jsx(io, {
                                messages: f,
                                isUserTurn: C,
                                avatarClassName: x
                            }), e.jsx(sr, {
                                children: u ? e.jsx("span", {
                                    className: "font-bold text-token-text-primary",
                                    children: p
                                }) : e.jsx(E, { ...rr.responseNumber,
                                    values: {
                                        responseIndex: 2
                                    }
                                })
                            })]
                        }), Q && H ? e.jsx(tr, {}) : e.jsxs(e.Fragment, {
                            children: [I != null && !C && e.jsx(Ja, {
                                clientThreadId: h.clientThreadId,
                                messages: f,
                                isParagen: !0
                            }), e.jsx(so, { ...h,
                                allMessages: f,
                                groupedMessagesToRender: M,
                                allGroupedMessages: M,
                                isEditing: !1,
                                isUserTurn: C,
                                isCompletionRequestInProgress: k,
                                hasActiveRequest: r,
                                handleEnterEdit: Ws,
                                handleExitEdit: Ws,
                                shouldGrowContainer: !1,
                                showEditButton: !1,
                                showCopyButton: !1,
                                isParagen: !0
                            }), e.jsx(or, {
                                clientThreadId: h.clientThreadId,
                                conversationTurnMountTime: h.conversationTurnMountTime,
                                turn: a,
                                originalTurn: l
                            })]
                        })]
                    })]
                })
            })
        })]
    })
}

function er({
    horizontalScrollContainerRef: t,
    rootElementRef: s,
    onClick: o,
    children: n,
    hasActiveRequest: a,
    isWaitingOnFirstUserVisibleToken: r
}) {
    const l = Uo(),
        {
            scrollX: d
        } = Kc({
            layoutEffect: !1,
            container: t,
            target: s
        }),
        h = mh(),
        c = hh(),
        u = i.useRef(null),
        m = i.useRef(null),
        p = i.useRef(null),
        [g, f] = i.useState(!1),
        [x, b] = i.useState(!1),
        [S, M] = i.useState(!1),
        [w, R] = i.useState(0);
    i.useEffect(() => {
        if (!l) return;
        const _ = new IntersectionObserver(H => {
            for (const I of H) I.target === u.current ? f(I.isIntersecting) : I.target === p.current ? M(I.isIntersecting) : I.target === m.current && b(I.isIntersecting)
        }, {
            root: h ? .current
        });
        return u.current && m.current && p.current && (_.observe(u.current), _.observe(m.current), _.observe(p.current)), () => {
            _.disconnect()
        }
    }, [w, l, h]);
    const k = !S && (x || g),
        V = Qc(d, _ => k ? -1 * _ : 0),
        C = Sa(0);
    i.useEffect(() => {
        if (!l) return;
        const _ = new ResizeObserver(H => {
            $s(H.length === 1, "entryList.length === 1");
            const I = H[0];
            $s(I.contentBoxSize.length === 1, "item.contentBoxSize.length === 1"), C.set(I.contentBoxSize[0].inlineSize)
        });
        return s.current && _.observe(s.current), () => {
            _.disconnect()
        }
    }, [l, C, s]);
    const j = Sa(0);
    i.useEffect(() => {
        if (!l) return;
        const _ = new ResizeObserver(H => {
            $s(H.length === 1, "entryList.length === 1");
            const I = H[0];
            $s(I.contentBoxSize.length === 1, "item.contentBoxSize.length === 1"), j.set(I.contentBoxSize[0].blockSize + 16), R(I.contentBoxSize[0].blockSize)
        });
        return c.current && _.observe(c.current), () => {
            _.disconnect()
        }
    }, [l, j, c]);
    const T = e.jsx(mt, {
            className: l ? "px-5" : "mt-4 self-start",
            onClick: o,
            "data-testid": "paragen-prefer-response-button",
            children: e.jsx(E, {
                id: "U2EAH6",
                defaultMessage: "I prefer this response"
            })
        }),
        P = r;
    return e.jsxs("div", {
        "data-paragen-root": !0,
        className: N("relative flex w-full min-w-[min(450px,80vw)] snap-center flex-col gap-1 text-left", l ? "min-h-60 px-10 py-4" : "rounded-2xl border border-token-main-surface-tertiary bg-white p-5 dark:bg-gray-700"),
        ref: s,
        children: [e.jsx("div", {
            className: N("absolute left-0 right-0 top-48 h-px", "invisible"),
            ref: u
        }), e.jsx("div", {
            className: N("absolute bottom-0 left-0 right-0 top-48", "invisible"),
            ref: m
        }), e.jsx("div", {
            className: N("absolute bottom-0 left-0 right-0 h-px", "invisible"),
            ref: p
        }), n, l ? e.jsx("div", {
            className: "flex-1"
        }) : null, l ? e.jsx("div", {
            className: "mt-4 min-h-10",
            children: P ? null : e.jsx(q.div, {
                style: {
                    translateX: V,
                    width: C,
                    bottom: j
                },
                animate: {
                    opacity: 100
                },
                initial: {
                    opacity: 0
                },
                transition: {
                    ease: "easeOut",
                    duration: .2,
                    delay: .5
                },
                className: N({
                    fixed: k,
                    "z-20 flex w-full justify-center": !0
                }),
                children: T
            })
        }) : a ? null : T]
    })
}

function tr() {
    return e.jsxs("div", {
        className: "flex w-full flex-col gap-4 pb-5 pt-3",
        children: [e.jsx(At, {
            className: "h-4 w-[75%]"
        }), e.jsx(At, {
            className: "h-4 w-[50%]"
        }), e.jsx(At, {
            className: "h-4 w-[80%]"
        }), e.jsx(At, {
            className: "h-4 w-[55%]"
        }), e.jsx(At, {
            className: "h-4 w-[66%]"
        }), e.jsx(At, {
            className: "h-4 w-[64%]"
        }), e.jsx(At, {
            className: "h-4 w-[48%]"
        })]
    })
}

function Uo() {
    const {
        layer: t
    } = ht("3119715334");
    return t.get("should-enable-hojicha", !1)
}
const sr = Ue.div `text-sm text-token-text-secondary font-semibold`,
    nr = Ue.div `flex gap-4 items-center mb-1`,
    At = Ue.div `animate-pulse rounded-[4px] bg-token-main-surface-tertiary`;

function or({
    clientThreadId: t,
    conversationTurnMountTime: s,
    turn: o,
    originalTurn: n
}) {
    const a = Ro();
    if (!a.showParagenMetadata || !a.showDebugConversationTurns && !a.forceParagen || o == null) return null;
    let r = o === n ? "ORIGINAL" : "NEW";
    const l = o.messages[o.messages.length - 1],
        d = l ? .message ? .metadata ? .__internal;
    if (d) {
        const {
            model_id: m,
            model_definition_slug: p,
            model_definition_virtual_model_id: g,
            alternative_model_selection_rule: f,
            augmented_paragen_prompt_group_id: x,
            augmented_paragen_prompt_id: b,
            augmented_paragen_prompt: S
        } = d;
        m && (r += `
Model ID: ${m}`), p && (r += `
Model Slug: ${p}`), g && (r += `
Virtual Model ID: ${g}`), f && (r += `
Alternative Model Rule: ${f}`), x && (r += `
Prompt Group ID: ${x}`), b && (r += `
Prompt ID: ${b}`), S && (r += `
Prompt: ${S}`)
    }
    r += `
Message ID: ${l.message.id}`;
    const c = K.getTree(rt(t)).getParentPromptNode(o.variantIds[0]),
        u = c.metadata ? .variantsInStreamInfo == null && c.message.metadata ? .paragen_variants_info != null;
    return r += `
User prompt message ID: ${c.message.id}`, r += `
Is Persisted Paragen? ${u}`, r += `
Completion Sample Finish Time: ${u?`${s} (persisted)`:Qt(o.messages)?.completionSampleFinishTime}`, e.jsx("div", {
        className: "whitespace-pre-wrap text-sm text-red-500",
        children: r
    })
}
async function ar({
    params: t
}) {
    await Xt.submitParagenSelectionV2(t)
}
const rr = et({
    responseNumber: {
        id: "ConversationTurnTwoUpFeedback.responseNumber",
        defaultMessage: "Response {responseIndex, number}"
    }
});

function cx({
    handleShowRetrievalResults: t,
    clientThreadId: s,
    turnIndex: o,
    responseComplete: n = !1
}) {
    const [a, r] = de(s, u => [K.getTurnContentReferences(u, o), br(u ? .conversationTurns[o] ? .messages ? ? [])]), l = i.useMemo(() => ({
        turnIndex: o,
        clientThreadId: s,
        responseComplete: n
    }), [s, n, o]), d = i.useRef(!1);
    i.useEffect(() => {
        d.current || (d.current = !0, F.logEvent(B.fileSourcesFooterShown, l))
    }, [l]);
    const h = i.useCallback(() => {
            F.logEvent(B.fileSourcesFooterClicked, l), t()
        }, [t, l]),
        c = i.useMemo(() => {
            const u = new Set,
                m = [];

            function p(f) {
                !f || u.has(f) || (u.add(f), m.push(f))
            }
            if (a.forEach(f => {
                    f.type === "file" ? p(f.cloud_doc_url ? ? f.extra ? .cloud_doc_url) : f.type === "file_navlist" && f.items.forEach(x => {
                        p(x.cloud_doc_url)
                    })
                }), n) {
                for (const f of r)
                    if (ph(f.message)) {
                        const x = gh(f.message.content.result),
                            b = f.message.metadata ? .cloud_doc_urls ? ? [],
                            S = x.chunks;
                        for (let M = 0; M < S.length; M++) {
                            const w = S[M];
                            if (!w.documentId) continue;
                            if (M < b.length) {
                                p(b[M]);
                                continue
                            }
                            const R = w.documentId.endsWith("--google") ? w.documentId.split("--")[1] : void 0,
                                k = w.metadata.cloud_doc_url ? ? (R ? `https://drive.google.com/file/d/${R}` : void 0);
                            p(k ? .toString())
                        }
                        break
                    }
            }
            const g = [];
            for (let f = 0; f < m.length; f++) {
                const x = m[f],
                    b = fh(x);
                if (b && g.push(b.Icon), g.length >= 3) break
            }
            return g
        }, [r, a, n]);
    return e.jsxs(e.Fragment, {
        children: [e.jsx(q.div, {
            className: "absolute h-[60px]",
            initial: {
                opacity: 0
            },
            animate: {
                opacity: 1
            },
            children: e.jsxs("button", {
                className: N("not-prose group/footnote mb-2 mt-3 flex w-fit items-center gap-1.5 rounded-xl border border-token-border-light bg-token-main-surface-primary py-2 hover:bg-token-main-surface-secondary", "pl-3 pr-2.5"),
                onClick: h,
                children: [e.jsx("div", {
                    className: "flex items-center gap-0.5 text-sm font-medium",
                    children: e.jsx(E, {
                        id: "/48IOP",
                        defaultMessage: "Sources"
                    })
                }), c.length > 0 && e.jsx("div", {
                    className: "flex flex-row-reverse gap-1",
                    children: c.reverse().map((u, m) => e.jsx(q.div, {
                        className: N("flex items-center overflow-hidden rounded-full border-token-main-surface-primary bg-token-main-surface-primary", "group-hover/footnote:border-token-main-surface-secondary", "relative"),
                        initial: {
                            opacity: 0
                        },
                        animate: {
                            opacity: 1
                        },
                        children: e.jsx(u, {
                            className: "icon-md"
                        })
                    }, m))
                })]
            })
        }), e.jsx("div", {
            className: "h-[60px]"
        })]
    })
}

function dx({
    clientThreadId: t,
    followups: s,
    analyticsMetadata: o
}) {
    const [n, a] = i.useState(null), r = Ao.useIsEnabled(t);
    return e.jsxs(e.Fragment, {
        children: [e.jsx(gx, {
            visible: n === "conversation"
        }), e.jsx(fx, {
            visible: n === "global"
        }), r && s.length > 0 && e.jsx(ux, {
            clientThreadId: t,
            followups: s,
            analyticsMetadata: o,
            setDisableMessage: a
        })]
    })
}

function ux({
    clientThreadId: t,
    followups: s,
    setDisableMessage: o,
    analyticsMetadata: n
}) {
    const a = Tn(),
        r = i.useRef(!1),
        [l, d] = i.useState(-1),
        {
            value: h
        } = he("2281969373");
    return i.useEffect(() => {
        r.current || (r.current = !0, s.forEach((c, u) => {
            F.logEventWithStatsig(B.messageFollowupAction, "chatgpt_message_followup_action", { ...Jt(n),
                action: "show",
                position: u + 1,
                followup_text: en(c)
            })
        }))
    }, [s, n]), e.jsxs("div", {
        className: "group",
        children: [e.jsxs("div", {
            className: "mb-1 flex items-center text-sm font-semibold",
            children: [e.jsx(E, {
                id: "3UFIQc",
                defaultMessage: "Follow up"
            }), !h && e.jsx(px, {
                clientThreadId: t,
                setDisableMessage: o,
                analyticsMetadata: n
            })]
        }), e.jsx(q.div, {
            initial: {
                opacity: 0
            },
            animate: {
                opacity: 1
            },
            exit: {
                opacity: 0
            },
            className: "flex w-full flex-col",
            children: s.slice(0, 4).map((c, u) => e.jsxs(q.div, {
                initial: {
                    opacity: 0,
                    translateY: 4
                },
                animate: {
                    opacity: 1,
                    translateY: 0
                },
                transition: {
                    delay: u * .03
                },
                exit: {
                    opacity: 0,
                    translateY: 4
                },
                onMouseEnter: () => {
                    d(u)
                },
                onMouseLeave: () => {
                    d(-1)
                },
                children: [u > 0 && e.jsx(mx, {
                    $isSelected: l === u || l === u - 1
                }), e.jsx(hx, {
                    followUp: c,
                    onSelectingSuggestedReply: a,
                    analyticsMetadata: n,
                    position: u
                })]
            }, u))
        })]
    })
}
const mx = Ue.div `
  h-[1px] opacity-45
  ${({$isSelected:t})=>t?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light"}
`;

function hx({
    followUp: t,
    onSelectingSuggestedReply: s,
    analyticsMetadata: o,
    position: n
}) {
    return e.jsxs(q.button, {
        whileHover: "hover",
        className: "flex w-full cursor-pointer items-start justify-start gap-2 rounded-lg bg-token-main-surface-primary px-2 py-3 text-start hover:bg-token-main-surface-secondary",
        onClick: a => {
            s(a, t, [], 0), F.logEventWithStatsig(B.messageFollowupAction, "chatgpt_message_followup_action", { ...Jt(o),
                action: "click",
                position: n + 1,
                followup_text: en(t)
            })
        },
        onMouseEnter: () => {
            F.logEventWithStatsig(B.messageFollowupAction, "chatgpt_message_followup_action", { ...Jt(o),
                action: "hover",
                position: n + 1,
                followup_text: en(t)
            })
        },
        children: [e.jsx(q.div, {
            className: "flex items-center justify-center pt-0.5 opacity-70",
            variants: {
                hover: {
                    x: 4
                }
            },
            initial: {
                x: 0
            },
            transition: {
                duration: .1
            },
            children: e.jsx(xh, {
                className: "h-[18px] w-[18px] text-token-text-secondary"
            })
        }), e.jsx("div", {
            className: "pr-2 text-left text-sm text-token-text-secondary",
            children: en(t)
        })]
    })
}

function px({
    clientThreadId: t,
    setDisableMessage: s,
    analyticsMetadata: o
}) {
    const n = Ao.useStore(),
        [a, r] = i.useState(!1);
    return e.jsxs(Cs, {
        size: "small",
        onOpenChange: l => r(l),
        contentClassName: "min-w-[200px]",
        triggerButton: e.jsx("button", {
            className: "ml-2 flex h-6 w-6 items-center justify-center rounded-md text-token-text-tertiary hover:bg-token-main-surface-tertiary focus:outline-none focus:ring-0",
            children: e.jsx(Qr, {
                className: N("h-4 w-4 opacity-0 group-hover:opacity-100", a && "opacity-100")
            })
        }),
        children: [e.jsx(ie.Item, {
            onClick: () => {
                n.setDisabledConversation(t, !0), s("conversation"), setTimeout(() => s(null), 3e3), F.logEventWithStatsig(B.messageFollowupSetting, "chatgpt_message_followup_setting", { ...Jt(o),
                    action: "disable_conversation"
                })
            },
            className: "text-token-text-primary",
            children: e.jsx(E, {
                id: "GZYofd",
                defaultMessage: "Hide for this chat"
            })
        }), e.jsx(ie.Item, {
            onClick: () => {
                n.setDisabledGlobally(!0), s("global"), setTimeout(() => s(null), 5e3), F.logEventWithStatsig(B.messageFollowupSetting, "chatgpt_message_followup_setting", { ...Jt(o),
                    action: "disable_globally"
                })
            },
            className: "text-token-text-primary",
            children: e.jsx(E, {
                id: "dtAOq4",
                defaultMessage: "Hide everywhere"
            })
        })]
    })
}
const Yi = {
    initial: {
        opacity: 1
    },
    animate: {
        opacity: 1
    },
    exit: {
        opacity: 0,
        transition: {
            duration: .2
        }
    }
};

function gx({
    visible: t
}) {
    return e.jsx(Ze, {
        children: t && e.jsx(q.div, { ...Yi,
            className: "flex justify-center py-6 text-sm text-token-text-tertiary",
            children: e.jsx(E, {
                id: "ckTD9g",
                defaultMessage: "Follow ups are turned off for this conversation"
            })
        })
    })
}

function fx({
    visible: t
}) {
    return e.jsx(Ze, {
        children: t && e.jsxs(q.div, {
            id: "disableForAllConvos",
            ...Yi,
            className: "flex flex-col items-center py-3 text-sm",
            children: [e.jsx("div", {
                children: e.jsx(E, {
                    id: "5GDIBQ",
                    defaultMessage: "Follow up have been turned off"
                })
            }), e.jsx("div", {
                className: "pt-1 text-token-text-tertiary",
                children: e.jsx(E, {
                    id: "LYaBNe",
                    defaultMessage: "You can re-enable them in settings"
                })
            })]
        })
    })
}
const ir = [1, 2, 3, 4, 10, 20, 30],
    xx = .5;

function vx({
    clientThreadId: t
}) {
    const s = hi(pi.isBusinessWorkspace),
        o = i.useRef(!1),
        n = ss(t),
        a = de(t, T => T ? .mode),
        {
            isUnauthenticated: r
        } = gt(),
        l = i.useMemo(() => {
            if (!n) return -1;
            const T = mi(n);
            return T() > xx ? -1 : ir[Math.floor(T() * ir.length)]
        }, [n]),
        d = Ec(t),
        h = d[d.length - 1],
        c = i.useMemo(() => nn.getRequestIdFromConversationTurn(h), [h]),
        u = Pt(c),
        [m, p] = i.useState(null),
        [g, f] = i.useState(!1),
        [x, b] = i.useState(!1),
        [S, M] = i.useState(!1),
        w = T => {
            const P = Qt(d) ? .messages[0] ? .message.id;
            p(T), V(P, T)
        },
        R = d.filter(T => T.role === Ne.Assistant).length,
        k = h ? .role === Ne.Assistant,
        V = i.useMemo(() => ai((T, P) => {
            n && T && Xt.submitConversationRating({
                conversation_id: n,
                message_id: T,
                rating: P,
                shown_at_assistant_turn: l
            }), F.logEvent(B.conversationRatingSubmitted, {
                rating: P,
                showAtAssistantTurn: l,
                conversationId: n
            }), f(!0), setTimeout(() => {
                b(!0)
            }, 1500)
        }, 2e3), [n, l]),
        C = R !== l || u || !k || !!s || a ? .kind !== Be.PrimaryAssistant || S || r;
    i.useEffect(() => {
        !C && !o.current && (F.logEvent(B.conversationRatingShown, {
            showAtAssistantTurn: l,
            conversationId: n
        }), o.current = !0)
    }, [C]);
    const j = vh();
    return S || !j.forceShowConvoRating && C ? null : e.jsxs("div", {
        className: "mx-auto",
        children: [e.jsx(Ze, {
            children: g && !x && e.jsx(q.div, {
                initial: {
                    opacity: 0
                },
                animate: {
                    opacity: 1
                },
                exit: {
                    opacity: 0
                },
                transition: {
                    duration: .2
                },
                children: e.jsx(lr, {
                    $padded: !0,
                    children: e.jsx("span", {
                        className: "text-sm text-token-text-tertiary",
                        children: e.jsx(E, {
                            id: "rating.thanks",
                            defaultMessage: "Thanks for your feedback!"
                        })
                    })
                })
            }, "submitted")
        }), !g && e.jsx(q.div, {
            initial: {
                opacity: 0
            },
            animate: {
                opacity: 1
            },
            transition: {
                duration: .1
            },
            children: e.jsxs(lr, {
                $padded: !1,
                children: [e.jsxs("div", {
                    className: "flex items-center justify-center gap-4 px-4 py-3 text-sm text-token-text-secondary",
                    children: [e.jsx(E, {
                        id: "rating.instructions",
                        defaultMessage: "Is this conversation helpful so far?"
                    }), e.jsxs("div", {
                        className: "flex items-center gap-5",
                        children: [e.jsx($n, {
                            $selected: m === "thumbsUp",
                            onClick: () => w("thumbsUp"),
                            children: e.jsx(yh, {
                                className: "icon-md"
                            })
                        }), e.jsx($n, {
                            $selected: m === "thumbsDown",
                            onClick: () => w("thumbsDown"),
                            children: e.jsx(Sh, {
                                className: "icon-md"
                            })
                        })]
                    })]
                }), e.jsx("div", {
                    className: "w-px flex-1 self-stretch bg-token-main-surface-tertiary"
                }), e.jsx($n, {
                    className: "p-3",
                    $selected: !1,
                    onClick: () => M(!0),
                    children: e.jsx(Rc, {
                        className: "icon-md text-token-text-secondary hover:text-token-text-primary"
                    })
                })]
            })
        }, "rating")]
    })
}
const $n = Ue.button `
  ${t=>t.$selected?"text-token-text-primary":"text-token-text-secondary"}
  hover:text-token-text-primary
`,
    lr = Ue.div `inline-flex rounded-xl border border-gray-100 dark:border-gray-700
${t=>t.$padded&&"py-3 px-4"}
`,
    yx = ze(() => Ge(() =>
        import ("./dsaom19zfjj0srcy.js"), __vite__mapDeps([53, 1, 3, 4, 2, 5, 54])));

function Sx({
    clientThreadId: t,
    canShowInlineMessageFeedback: s,
    messageForRating: o,
    allGroupedMessages: n,
    currentModelId: a
}) {
    let r = null;
    const l = de(t, m => {
            const p = K.getConversationTurns(m);
            let g = 0;
            for (let f = p.length - 1; f >= 0; f--) {
                const x = p[f];
                if (x.messages.some(b => b.message.metadata ? .is_indepth_feedback)) return !0;
                if (x.messages.some(b => b.message.author.role === Ne.Assistant) && g++, g >= 3) break
            }
            return !1
        }),
        d = ss(t),
        h = Po(m => m.voiceFeedbackThread),
        c = d === h,
        {
            voiceName: u
        } = bh();
    return l ? null : (c && d ? (Pc.feedbackShown.success({
        voice: u
    }), r = e.jsx("div", {
        className: "text-center",
        children: e.jsx(jh, {
            serverThreadId: d
        })
    })) : o.rating && s ? r = e.jsx(yx, {
        clientThreadId: t,
        conversationMessage: o,
        allGroupedMessages: n,
        currentModelId: a
    }) : r = e.jsx("div", {
        className: "text-center",
        children: e.jsx(vx, {
            clientThreadId: t
        })
    }), e.jsx("div", {
        className: "mt-3 w-full empty:hidden",
        children: r
    }))
}
const bx = ze(() => Ge(() =>
        import ("./csho1v5a5zmkk18o.js"), __vite__mapDeps([51, 3, 1, 4, 2, 5, 52])).then(t => t.MemoryActionResult)),
    jx = ze(() => Ge(() =>
        import ("./keftiaw7giaegob5.js"), __vite__mapDeps([55, 1, 2, 3, 4, 5, 56, 57])).then(t => t.AutomationSourceHeader)),
    cr = 80,
    Cx = 16,
    dr = {
        minHeight: `calc(100dvh - ${Lh}px - 120px)`
    };

function wx(t) {
    const {
        turnIndex: s,
        isFinalTurn: o,
        clientThreadId: n,
        onChangeRating: a,
        currentModelId: r,
        avatarClassName: l,
        showAvatar: d,
        scrollToMessageId: h,
        dateHeaderType: c
    } = t, u = bn();
    bs() ? .normalizedAccountUserId;
    const m = !!u && Ic(u),
        p = fo(),
        g = hi(pi.isBusinessWorkspace),
        f = Do(),
        {
            value: x
        } = he("1760640904"),
        {
            value: b
        } = he("1456513860"),
        S = d ? ? !b,
        w = null != null,
        {
            value: R
        } = he("1887864177"),
        k = fp(),
        V = St(n),
        C = Et(sn(n, s)),
        j = sn(n, s - 1),
        T = j != null && j.role === Ne.User ? j.messages[0].message.metadata ? .visually_hide_response_from_conversation ? ? !1 : !1,
        {
            messages: P,
            variantIds: _,
            variantsInStreamInfo: H
        } = C,
        I = un(P),
        Q = Ch(),
        y = Qt(P);
    let W = y;
    for (const G of I) {
        const Te = Ip(G);
        if (Te.some(xt => Q.has(xt.message.id))) {
            W = Te[Te.length - 1];
            break
        }
    }
    const ne = y !== W,
        D = P.slice(0, W ? P.indexOf(W) + 1 : 0),
        Y = i.useMemo(() => ({
            clientThreadId: n,
            turnIndex: s,
            messageId: y ? .message.id
        }), [n, s, y ? .message.id]),
        ae = !1,
        L = Sn(),
        [se, oe] = i.useState(!1),
        [ye, fe] = i.useState(!1),
        le = _.findIndex(G => D.some(Te => Te.nodeId === G)),
        Ee = i.useContext(gi) != null,
        Z = C.role === Ne.User,
        xe = It(),
        Se = jt(n),
        ue = Ft(C.gizmoId ? ? Se).data,
        Me = Fo(r),
        me = wh(r),
        be = i.useContext(po),
        Re = go(be),
        [_e, He, A, re, ee, we, Bt, ns] = de(n, G => {
            const Te = G ? .tree != null && _.some(vt => {
                    const Fs = G.tree.getLeafFromNode(vt);
                    return G.tree.getHasErrorFromNode(Fs.id)
                }),
                xt = K.getConversationTurns(G);
            return [G ? .async_status === vr.STREAMING, K.isMessageTurnEnded(G), Te, Hh(br(G ? .mode), ue ? .gizmo.id), G ? .continuingFromSharedConversationId != null, null, xt.findIndex(vt => vt.role === Ne.User) === s, xt.findIndex(vt => vt.role === Ne.Assistant) === s]
        });
    let Pe = "default";
    const Ct = D.some(G => G.message.content.content_type === Fc.MultimodalText),
        {
            layer: We
        } = ht("1547743984"),
        it = V && L && We.get("show_share_button_inline", !1),
        {
            isUnauthenticated: qe
        } = gt(),
        [Dt, z] = i.useState(!1),
        O = C.messages.map(G => G.message.id),
        te = i.useRef(null),
        je = (h ? .length ? ? 0) > 2 && h !== "finalAgentTurn" && o && f,
        Ie = () => {
            D.length === 1 && (F.logEvent(B.editPrompt, {
                id: D[0].message.id,
                threadId: St(n)
            }), De.logEvent("chatgpt_edit_prompt"), oe(!0))
        },
        Ve = i.useCallback(() => {
            oe(!1)
        }, []),
        Oe = G => {
            y && (a({
                nodeId: y.nodeId,
                messageId: y.message.id,
                rating: G
            }), F.logEvent(G === "thumbsDown" ? B.messageFeedbackThumbsDownClicked : B.messageFeedbackThumbsUpClicked, {
                id: y.message.id,
                threadId: St(n),
                model: r,
                rating: G
            }), fe(!0))
        },
        [$e] = i.useState(() => Date.now()),
        Ye = kh(n),
        wt = i.useMemo(() => nn.getRequestIdFromConversationTurn(C), [C]),
        pe = Pt(wt) && !He,
        kt = xo(),
        X = un(D),
        Ke = i.useRef(!1),
        Tt = Th(n, y);
    i.useEffect(() => {
        if (Ke.current || h === void 0 || !f || !te.current) {
            h === "finalAgentTurn" && o && vs(n, G => {
                G.scrollToMessageId = void 0
            });
            return
        }(O.includes(h) || h === "finalAgentTurn" && o) && (Ke.current = !0, requestAnimationFrame(() => {
            requestAnimationFrame(() => {
                if (te.current)
                    if (h === "finalAgentTurn" && o) te.current.scrollIntoView({
                        behavior: "instant",
                        block: "end"
                    }), vs(n, G => {
                        G.scrollToMessageId = void 0
                    });
                    else {
                        const G = te.current.offsetHeight;
                        let Te;
                        G > cr ? Te = cr - G : Te = 0, te.current.style.scrollMarginTop = `${Te+Cx}px`, te.current.scrollIntoView({
                            behavior: "smooth"
                        })
                    }
            })
        }))
    }, [h, te.current]);
    const {
        showDebugConversationTurns: Mn
    } = Ro(), _n = si(), Lt = !p && !ee && !xe && !Z, Ns = Mh(), Fe = W ? .message.author.role === Ne.Assistant ? W.message : null, Ht = W ? .message.metadata ? .system_hints ? .includes($.Research);
    _h({
        isCompletionRequestInProgress: pe,
        isUserTurn: Z,
        message: Fe
    });
    const {
        isOpen: Mt
    } = xp(), Nn = zr(), _t = Nh(re), nt = !Ns && !_t && Lt && o && H ? .num_variants_in_stream === 2 && !y ? .inlineComparisonRating && !A, os = Ah(C), ke = nt, as = nt && !os, rs = !ne && !Z && !p && !ee && !_t && !_e && !pe && !Mt && !w && !Ye, lt = o && !pe && !ee && !p && (R || k), Ot = rs && (!g || me || m) && !_t && !qe && !xe && !y ? .message.metadata ? .b1de6e2_s, is = !p && !((pe || _e) && o) && _.length > 1 && !se && !ke && !w, Ut = Z && D.length === 1 && Eh(D[0]) ? .shouldHideContent, As = Z && !_t && !p && !Ct && D.length === 1 && !Ut && !se && !qe && !w && !Ht, zt = i.useCallback(G => {
        vs(n, Te => {
            Sr.setCurrentBranch(Te, _[G])
        }), F.logEvent(B.changeNode, {
            intent: "toggle_between"
        })
    }, [n, _]), Es = Rh(C, D, Mn), {
        toggleThreadSidebar: ls
    } = Bc(), ot = i.useMemo(() => C.messages.length ? C.messages[C.messages.length - 1].nodeId : void 0, [C.messages]), Rs = i.useCallback(() => {
        ot && ls({
            type: "retrievalResults",
            clientThreadId: n,
            turnIndex: s,
            messageId: ot
        })
    }, [ot, ls, n, s]), {
        value: cs
    } = he("2912660649"), Ps = i.useMemo(() => cs && Ph(C, Me, !!Se), [cs, Me, Se, C]);
    if (!Es && !ke) return je ? e.jsx("div", {
        style: dr
    }) : null;
    if (T) return null;
    const An = W ? .message.metadata ? .followup_prompts ? W.message.metadata.followup_prompts.map(G => ({
            text: G,
            type: bt.Reply
        })) : [],
        En = D.some(({
            message: G
        }) => Dc.getAudioAssetPointers(G).length > 0),
        Rn = !pe && D.some(({
            message: G
        }) => G.author.role === Ne.Assistant && G.metadata ? .onboarding ? .main_usages),
        ft = D.find(({
            message: G
        }) => !!G.metadata ? .onboarding ? .examples) ? .message.metadata ? .onboarding ? .examples,
        Is = !Ut && (!Z || !se) && (!o || !pe),
        Pn = x && Is;
    return _n && !w && !o && C.messages.every(({
        message: G
    }) => !Lc(G)) ? null : e.jsxs(Ih.Provider, {
        value: ns,
        children: [e.jsx(Fh, {
            dateHeaderType: c,
            turn: C
        }), e.jsxs("article", {
            className: N("w-full text-token-text-primary focus-visible:outline-2 focus-visible:outline-offset-[-4px]", h === "finalAgentTurn" && f ? "opacity-0" : "", {
                hidden: Ee && Bt
            }),
            style: je ? dr : void 0,
            ref: te,
            dir: "auto",
            "data-testid": `conversation-turn-${s}`,
            "data-scroll-anchor": o,
            onMouseEnter: () => z(!0),
            onMouseLeave: () => z(!1),
            children: [e.jsx(Bh, {
                role: C.role
            }), e.jsx(es, {
                clientThreadId: n,
                isStaticSharedThread: p,
                verticalPadding: Pe,
                horizontalPadding: ke ? "none" : Re || S ? "standard" : "expanded",
                children: ke ? e.jsx(ix, {
                    isFeedbackEnabled: Ot,
                    variantIds: _,
                    conversationTurnMountTime: $e,
                    stubSideBySideFeedback: as,
                    ...t
                }) : e.jsx(ts, {
                    shouldRemoveGap: w,
                    children: e.jsxs(e.Fragment, {
                        children: [ae, !Z && !ae && S && e.jsx(Tx, {
                            children: e.jsx(io, {
                                messages: D,
                                isUserTurn: Z,
                                avatarClassName: l,
                                gizmo: ue
                            })
                        }), e.jsx("div", {
                            className: eo({
                                isUserTurn: Z,
                                shouldDisplaySideBySideFeedback: ke
                            }),
                            children: e.jsx("div", {
                                className: "flex-col gap-1 md:gap-3",
                                children: e.jsxs(e.Fragment, {
                                    children: [null, !Z && !p && e.jsx(bx, {
                                        messages: D,
                                        clientThreadId: n,
                                        gizmoId: ue ? .gizmo.id
                                    }), Nn && !Z && e.jsx(jx, {
                                        clientThreadId: n,
                                        messages: D
                                    }), e.jsx(so, {
                                        allMessages: P,
                                        groupedMessagesToRender: X,
                                        allGroupedMessages: I,
                                        ...t,
                                        isEditing: se,
                                        isUserTurn: Z,
                                        isCompletionRequestInProgress: pe,
                                        isFeedbackEnabled: Ot,
                                        isFinalTurn: o,
                                        hasActiveRequest: kt,
                                        showEditButton: As,
                                        showCopyButton: Pn,
                                        handleEnterEdit: Ie,
                                        handleExitEdit: Ve
                                    }), Me && !cs && e.jsx("div", {
                                        className: "mb-4",
                                        children: e.jsx(Dh, {
                                            messages: D
                                        })
                                    }), Ps && e.jsx(cx, {
                                        handleShowRetrievalResults: Rs,
                                        clientThreadId: n,
                                        turnIndex: s,
                                        responseComplete: !(pe || _e)
                                    }), Rn && e.jsx(Dp, {
                                        clientThreadId: n
                                    }), ft && ft.length > 0 && !pe && e.jsx(Lp, {
                                        clientThreadId: n,
                                        examples: ft
                                    }), (rs || is) && e.jsxs(e.Fragment, {
                                        children: [e.jsx(kp, {
                                            turn: C,
                                            turnIndex: s,
                                            lastMessage: y,
                                            clientThreadId: n,
                                            isUserTurn: Z,
                                            isHovered: Dt,
                                            onRate: Oe,
                                            alwaysShow: o,
                                            showInline: o || is,
                                            showCanvasButton: Tt,
                                            showDiscussButton: !1,
                                            showCopyButton: Is,
                                            showPagination: is,
                                            onChangeIndex: zt,
                                            activeVariantIndex: le,
                                            numVariants: _.length,
                                            showRatingButtons: Ot && !pe,
                                            showPlayButton: !Z && (!o || !pe) && (y ? .disclaimers ? ? []).length === 0 && !!y ? .nodeId,
                                            showShareButton: !!it,
                                            showRegenerateButton: !En,
                                            conversationMode: re,
                                            messages: D
                                        }), o && !pe && y && e.jsx(Sx, {
                                            canShowInlineMessageFeedback: ye,
                                            clientThreadId: n,
                                            messageForRating: y,
                                            allGroupedMessages: I,
                                            currentModelId: r
                                        })]
                                    }), lt && e.jsx(dx, {
                                        followups: An,
                                        clientThreadId: n,
                                        analyticsMetadata: Y
                                    })]
                                })
                            })
                        })]
                    })
                })
            })]
        })]
    })
}
const kx = vo.memo(wx),
    Tx = Ue.div `flex-shrink-0 flex flex-col relative items-end`;

function Mx({
    clientThreadId: t,
    prefetchNavlink: s,
    setPrefetchNavlink: o
}) {
    const n = i.use(s),
        {
            value: a
        } = he("1032814809");
    i.useEffect(() => {
        n == null && o(void 0)
    }, [n, o]);
    const r = i.useMemo(() => n == null ? null : { ...n.navlink,
        domains: n.navlink.domains.map(l => ({ ...l,
            subtitle: l.subtitle ? ? l.domain
        }))
    }, [n]);
    return n == null ? null : e.jsxs("div", {
        children: [e.jsx(es, {
            clientThreadId: t,
            horizontalPadding: "expanded",
            children: e.jsx(ts, {
                children: e.jsx("div", {
                    className: eo({
                        isUserTurn: !0,
                        shouldDisplaySideBySideFeedback: !1
                    }),
                    children: e.jsx("div", {
                        className: Tp(!0),
                        children: e.jsx(Mp, {
                            containsImagesOrAttachments: !1,
                            isUserTurn: !0,
                            showEditButton: !1,
                            showCopyButton: !1,
                            onEnterEdit: () => {},
                            handleCopyToClipboard: () => {},
                            children: e.jsx(Oh, {
                                text: n.query
                            })
                        })
                    })
                })
            })
        }), e.jsx("div", {
            className: "-mb-9",
            children: e.jsx(es, {
                clientThreadId: t,
                horizontalPadding: "expanded",
                children: e.jsx(ts, {
                    children: e.jsxs("div", {
                        className: eo({
                            isUserTurn: !1,
                            shouldDisplaySideBySideFeedback: !1
                        }),
                        children: [e.jsx(Fp, {
                            navigation: Et(r),
                            onShowSearchResults: () => {},
                            trackContentReferenceEvent: () => {}
                        }), a ? e.jsxs("div", {
                            className: "relative -top-2 flex justify-end gap-2 font-mono text-xs text-token-text-secondary",
                            children: [e.jsxs("div", {
                                elementtiming: "navlink",
                                children: ["server: ", n.timing, "ms"]
                            }), e.jsx(_x, {})]
                        }) : null]
                    })
                })
            })
        })]
    })
}

function _x() {
    const [t, s] = i.useState(null);
    return i.useEffect(() => {
        const o = new PerformanceObserver(n => {
            n.getEntries().forEach(a => {
                if (a.identifier === "navlink") {
                    const r = a.renderTime;
                    s(l => l ? ? r)
                }
            })
        });
        return o.observe({
            type: "element",
            buffered: !0
        }), () => o.disconnect()
    }, []), t == null ? null : e.jsxs("span", {
        children: ["render: ", t, "ms"]
    })
}

function Nx({
    onChangeRating: t,
    onRequestCompletion: s,
    clientThreadId: o,
    scrollContainerRef: n,
    prefetchNavlink: a,
    setPrefetchNavlink: r
}) {
    const [l, d, h, c, u] = de(o, L => [L ? .mode, K.getConversationTurns(L).length, K.getThreadData(L).isArchived, L ? .conversationOrigin === Hc.APPLE, L ? .scrollToMessageId]), m = Le(), p = ho(), g = Do(), f = Uh(), [x] = zh(), b = Gh(), [S] = Wh(), M = Bo(o), w = m.store.useContentAreaDimensions(Zt.Header, L => L ? .height ? L.height : void 0), R = m.store.useIsHeaderContentAreaPopulated(), k = qh(M.id), V = l ? .kind === Be.GizmoMagicCreate ? "bg-token-main-surface-primary text-token-text-primary" : k, C = Vh(), [j, T] = i.useState(0), [P, _] = i.useState(!1);
    i.useEffect(() => {
        p && (j === 0 ? T(d) : !P && d > j && (_(!0), De.logEvent("chatgpt_continue_conversation_first_message_sent"), F.logEvent(B.continueConversationFirstMessageSent)))
    }, [d, j, P, p]), i.useEffect(() => {
        p && (De.logEvent("chatgpt_continue_conversation_page_loaded"), F.logEvent(B.continueConversationPageLoaded), De.logEvent("chatgpt_conversation_share_page_loaded"), F.logEvent(B.sharedConversationPageLoaded))
    }, [p]);
    const H = i.useCallback(() => {
            f({
                behavior: "smooth"
            })
        }, [f]),
        [I, Q] = i.useState(!1),
        y = g && I || !g && !x,
        W = $h(o),
        ne = C && !h,
        D = i.useRef(null),
        Y = Yh(o),
        ae = (L, se, oe, ye) => [...new Array(se - L).keys()].map(fe => {
            const le = fe + L;
            return e.jsx(kx, {
                isFinalTurn: oe(le),
                turnIndex: le,
                clientThreadId: o,
                onChangeRating: t,
                onRequestCompletion: s,
                currentModelId: M.id,
                avatarClassName: V,
                scrollToBottom: H,
                scrollToMessageId: ye,
                dateHeaderType: Y(le),
                showAvatar: void 0
            }, le)
        });
    return e.jsxs("div", {
        onCopy: W,
        className: N("flex flex-col text-sm", ne && "pb-[120px]", w || ne ? null : "md:pb-9"),
        style: {
            paddingBottom: ne ? void 0 : w
        },
        children: [a ? e.jsx(Oc, {
            name: "prefetch-navlink",
            onError: L => {
                tn.addError("Error with prefetch navlink", {
                    error: L
                }), r(void 0)
            },
            children: e.jsx(i.Suspense, {
                fallback: null,
                children: e.jsx(Mx, {
                    clientThreadId: o,
                    prefetchNavlink: a,
                    setPrefetchNavlink: r
                })
            })
        }) : null, p && e.jsxs(e.Fragment, {
            children: [e.jsx(ts, {
                children: e.jsx("p", {
                    className: "text-xs text-gray-500",
                    children: e.jsx(E, {
                        id: "threadLayout.sharedConversationCopyDisclaimer",
                        defaultMessage: "This is a copy of a conversation between ChatGPT & Anonymous."
                    })
                })
            }), d - j === 0 && e.jsx("div", {
                className: "text-center text-xs font-semibold text-token-text-primary",
                children: e.jsx("button", {
                    onClick: () => {
                        an.openModal(Kh.ReportConversation), De.logEvent("chatgpt_conversation_share_report_content_clicked", null, {
                            location: "Static Shared Thread Page"
                        }), F.logEvent(B.sharedConversationReportContentClicked, {
                            location: "Dynamic Shared Thread Page"
                        })
                    },
                    children: e.jsx(E, {
                        id: "thread.reportSharedConversation",
                        defaultMessage: "Report content"
                    })
                })
            }), ae(0, j, L => L === j - 1, u), e.jsx(ts, {
                children: e.jsxs("p", {
                    className: "flex items-center text-xs text-gray-500",
                    children: [e.jsx(Qh, {
                        className: "icon-xs mr-2"
                    }), e.jsx(E, {
                        id: "threadLayout.sharedConversationPrivateDisclaimer",
                        defaultMessage: "Messages beyond this point are only visible to you"
                    })]
                })
            }), ae(j, d, L => L === d - 1, u)]
        }), !p && ae(0, d, L => L === d - 1, u), g && n ? .current && e.jsx(Uc, {
            setIsScrolledToEdge: Q,
            options: {
                root: n.current,
                threshold: 0,
                rootMargin: "0%"
            }
        }, "threadBottomEdgeScrollObserver"), e.jsx("div", {
            ref: D
        }), c && x && !S && e.jsx(ur, {
            className: N("translate-y-[10px] md:translate-y-[30px]"),
            onClick: () => {
                De.logEvent("chatgpt_thread_scroll_to_top"), b({
                    behavior: "smooth"
                })
            },
            children: e.jsx(Jh, {
                className: "icon-md text-token-text-primary"
            })
        }), e.jsx(Ze, {
            children: y && e.jsx(q.div, {
                initial: {
                    opacity: 0
                },
                animate: {
                    opacity: 1
                },
                exit: {
                    opacity: 0
                },
                transition: {
                    duration: .15,
                    ease: "easeInOut"
                },
                children: e.jsx(ur, {
                    className: N(w ? null : "bottom-5", ne ? R ? "translate-y-[-50px]" : "translate-y-[-10px]" : ""),
                    style: {
                        bottom: C ? "calc(var(--composer-bar_footer-current-height) + var(--composer-bar_current-height))" : w
                    },
                    onClick: () => {
                        De.logEvent("chatgpt_thread_scroll_to_bottom"), g ? D.current ? .scrollIntoView({
                            behavior: "smooth",
                            block: "end"
                        }) : f({
                            behavior: "smooth"
                        })
                    },
                    children: e.jsx(Xh, {
                        className: "icon-md text-token-text-primary"
                    })
                })
            })
        })]
    })
}
const ur = Ue.button `cursor-pointer absolute z-10 rounded-full bg-clip-padding border text-token-text-secondary border-token-border-light right-1/2 translate-x-1/2 bg-token-main-surface-primary w-8 h-8 flex items-center justify-center`,
    Ax = 60,
    Ex = ({
        children: t,
        scrollViewClassName: s,
        scrollAnchorTopOffset: o = 0
    }) => {
        const n = i.useRef(null);
        return e.jsx("div", {
            className: "h-full",
            ref: n,
            children: e.jsx(jr, {
                children: e.jsx(Pp, {
                    className: "h-full",
                    followButtonClassName: "hidden",
                    initialScrollBehavior: "auto",
                    scrollViewClassName: s,
                    scroller: () => Rx(n, o) ? 0 : 1 / 0,
                    children: t
                })
            })
        })
    },
    Rx = (t, s) => {
        const o = Px(t.current);
        if (o == null) return !1;
        const n = o > s,
            a = o < s - Ax;
        return !n && !a
    };

function Px(t) {
    if (!t) return null;
    const s = t.querySelector('[data-scroll-anchor="true"]');
    if (!s) return null;
    const o = s.getBoundingClientRect().top,
        n = t.getBoundingClientRect().top;
    return o - n
}
const Ix = ze(() => Ge(() =>
        import ("./o0hg3f6p430sj9e8.js"), __vite__mapDeps([58, 3, 1, 4, 2, 5, 37, 59, 60, 61, 62, 63, 64])).then(t => t.OpenDebugSidebarButton)),
    Fx = ze(() => Ge(() =>
        import ("./k51twjs4ydazxehs.js"), __vite__mapDeps([65, 1, 2, 3, 4, 5]))),
    Bx = ze(() => Ge(() =>
        import ("./etush0ni5l4oh0km.js"), __vite__mapDeps([66, 1, 3, 4, 2, 5])).then(t => t.default));

function Dx({
    clientThreadId: t
}) {
    const s = wr(),
        o = ss(t),
        n = de(t, K.getGizmoId),
        a = async () => {
            o && (await Xt.patchConversation(o, {
                is_archived: !1
            }), s.invalidateQueries({
                queryKey: ["conversation", t]
            }), vs(o, r => {
                r.initialThreadData.isArchived = !1
            }), gp(s, n))
        };
    return e.jsxs("div", {
        className: "my-6 flex flex-col items-center justify-center gap-4",
        children: [e.jsx("div", {
            className: "px-3 text-center text-sm text-token-text-secondary",
            children: e.jsx(E, {
                id: "thread.archivedConversationDescription",
                defaultMessage: "This conversation is archived. To continue, please unarchive it first."
            })
        }), e.jsx("div", {
            children: e.jsx(mt, {
                disabled: !o,
                onClick: a,
                icon: mp,
                children: e.jsx(E, {
                    id: "thread.unarchiveButton",
                    defaultMessage: "Unarchive"
                })
            })
        })]
    })
}
const Lx = function({
        clientThreadId: t,
        getGizmosCompletionParams: s,
        hideHeader: o,
        hideFooter: n,
        hideToolsOverlay: a,
        messagesVerticalAlign: r = "top",
        renderEmptyState: l
    }) {
        const d = xr(),
            {
                data: h
            } = gn(),
            c = ws(t),
            u = yr(),
            [m, p, g, f, x, b, S] = de(t, ee => [ee ? .isLoading, K.getCurrentLeafId(ee), K.hasUserMessage(ee), ee ? .conversationTurns.length ? ? 0, K.getThreadData(ee).isArchived, ee ? .modelId, ee ? K.getGizmoId(ee) : u]),
            {
                prefetchSearchPromises: M
            } = Tr(),
            [w, R] = i.useState(M ? .navlink);
        zc(t), i.useEffect(() => {
            m || (Vt(t) ? tn.addTiming("chatgpt.web.chatPage.renderNewConversation") : tn.addTiming("chatgpt.web.chatPage.renderExistingConversation"))
        }, [t, m]);
        const {
            setTargetedContent: k
        } = ni(), V = d ? .includes(Gc), C = Do(), j = Zh(), T = null, P = f >= 2, _ = Vt(t) && !P && Zs(c), H = Vt(t) && !g && (Zs(c) || c ? .kind === Be.GizmoTest) && M == null, Q = ep(h).id, y = b ? ? Q, W = !!b, ne = Fo(y), D = Io(h ? .models, y), Y = tp(t, c), ae = ti();
        sp(f, t), i.useEffect(() => {
            ae || k(void 0)
        }, [t, k, ae, p]);
        const L = Jc(t),
            se = i.useCallback(ee => {
                L(s ? s(ee) : ee)
            }, [s, L]),
            {
                caModal: oe,
                onChangeRating: ye
            } = np({
                clientThreadId: t,
                currentModelId: y
            }),
            fe = op({
                clientThreadId: t,
                handleRequestCompletion: se,
                prefetchSearchThreadIdPromise: M ? .threadId
            }) && w == null,
            le = i.useRef(null),
            Ee = ee => {
                if (C) {
                    const we = e.jsx("div", {
                        className: "relative h-full",
                        children: e.jsx("div", {
                            className: "flex h-full flex-col overflow-y-auto [scrollbar-gutter:stable]",
                            ref: le,
                            children: ee
                        })
                    });
                    return w != null ? we : e.jsx(jr, {
                        children: e.jsxs(i.Suspense, {
                            fallback: null,
                            children: [e.jsx(hp, {}), we]
                        })
                    })
                }
                return e.jsx(Ex, {
                    scrollAnchorTopOffset: o ? 0 : pp,
                    children: r === "bottom" ? e.jsxs("div", {
                        className: "flex h-full flex-col",
                        children: [e.jsx("div", {
                            className: "flex-1"
                        }), ee]
                    }) : ee
                })
            };
        i.useEffect(() => {
            document.title = Y ? ? "ChatGPT"
        }, [Y, T]);
        const Z = It(),
            xe = Ms(),
            Se = i.useContext(po),
            ue = go(Se),
            Me = ue,
            me = H && !l && !S && !ne && (!Z || xe),
            be = ho(),
            Re = i.useRef(null),
            _e = i.useRef(null),
            He = i.useMemo(() => ({
                threadContentScrollContainerElementRef: Re,
                footerRootContainerElementRef: _e
            }), []),
            A = !1,
            {
                value: re
            } = he("3861593998");
        return e.jsx(gi.Provider, {
            value: w,
            children: e.jsxs(Cp, {
                clientThreadId: t,
                children: [V && e.jsx(Fx, {}), e.jsx(ap, {
                    children: Y != null && e.jsx("title", {
                        children: Y
                    })
                }), e.jsx(Wc.Provider, {
                    value: se,
                    children: e.jsxs(rp, {
                        children: [e.jsxs(Wp, {
                            noKeyboard: !0,
                            clientThreadId: t,
                            currentModelConfig: D,
                            className: N("composer-parent flex h-full flex-col focus-visible:outline-0", A),
                            children: [e.jsxs(ip, {
                                value: He,
                                children: [!o && e.jsx(nx, {
                                    clientThreadId: t,
                                    isEmptyState: H
                                }), e.jsx("div", {
                                    ref: Re,
                                    className: "flex-1 grow overflow-hidden @container/thread",
                                    children: !m && !fe ? H ? l ? ? e.jsx(Vf, {
                                        clientThreadId: t,
                                        currentModelId: y,
                                        isModelLoaded: W,
                                        onRequestCompletion: se,
                                        showChatgptHomepage: me,
                                        shouldUseUnifiedComposer: re
                                    }) : P || w != null ? Ee(e.jsx(Nx, {
                                        onChangeRating: ye,
                                        onRequestCompletion: se,
                                        clientThreadId: t,
                                        scrollContainerRef: le,
                                        prefetchNavlink: w,
                                        setPrefetchNavlink: R
                                    }, t)) : null : null
                                })]
                            }), e.jsx("div", {
                                className: N("isolate w-full has-[[data-has-thread-error]]:pt-2 has-[[data-has-thread-error]]:[box-shadow:var(--sharp-edge-bottom-shadow)] dark:border-white/20 md:border-transparent md:pt-0 md:dark:border-transparent", re && _ && "md:grow", re && "flex flex-col justify-between"),
                                ref: _e,
                                children: x ? e.jsx(Dx, {
                                    clientThreadId: t
                                }) : e.jsxs(e.Fragment, {
                                    children: [(!me || re) && e.jsx(kr, {
                                        clientThreadId: t,
                                        children: e.jsx(Mf, {
                                            clientThreadId: t,
                                            isNewThread: _,
                                            currentModelId: y,
                                            onRequestCompletion: se,
                                            shouldUseUnifiedComposer: re
                                        })
                                    }), !n && !Me && !A && (Zs(c) ? e.jsx("div", {
                                        className: "relative flex min-h-8 w-full items-center justify-center p-2 text-center text-xs text-token-text-secondary md:px-[60px]",
                                        children: e.jsx(lp, {
                                            clientThreadId: t
                                        })
                                    }) : e.jsx("div", {
                                        className: "h-4"
                                    }))]
                                })
                            })]
                        }), !a && !ue && e.jsxs("div", {
                            className: "group absolute bottom-2 end-2 z-20 flex flex-col gap-1 md:flex lg:bottom-3 lg:end-3",
                            children: [j ? e.jsxs(e.Fragment, {
                                children: [e.jsx(Ix, {}), !1]
                            }) : null, e.jsx(Bx, {})]
                        }), oe, e.jsx(cp, {
                            clientThreadId: t,
                            isStaticSharedThread: !1,
                            isDynamicSharedThread: be
                        }), e.jsx(dp, {}), e.jsx(up, {
                            conversationId: t
                        })]
                    })
                })]
            })
        })
    },
    ev = vo.memo(Lx);
export {
    kx as C, qp as D, Vf as E, Wp as F, ev as M, zi as P, Ka as T, Ex as W, tx as a, Gf as b, nx as c, Gp as g, ji as h, Vi as u
};
//# sourceMappingURL=lizbu6fwxn81l4m4.js.map